(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4239],{660:e=>{e.exports={modalOverlay:"BuddyGroupDetailModal_modalOverlay____bbB",modalContainer:"BuddyGroupDetailModal_modalContainer__HmvSb",scrollContainer:"BuddyGroupDetailModal_scrollContainer__xJg0G",closeButton:"BuddyGroupDetailModal_closeButton__DQG9O",closeIcon:"BuddyGroupDetailModal_closeIcon__15dlz",title:"BuddyGroupDetailModal_title__IEdXR",buddyGroupLoadingContainer:"BuddyGroupDetailModal_buddyGroupLoadingContainer__845It",spinner:"BuddyGroupDetailModal_spinner__Bs1Da",spin:"BuddyGroupDetailModal_spin__5yy16",loadingText:"BuddyGroupDetailModal_loadingText__xUruO",errorContainer:"BuddyGroupDetailModal_errorContainer__oZwj1",errorText:"BuddyGroupDetailModal_errorText__LtslI",retryButton:"BuddyGroupDetailModal_retryButton__j4UOx",retryButtonText:"BuddyGroupDetailModal_retryButtonText__Njh3G",detailsContainer:"BuddyGroupDetailModal_detailsContainer__tiiYw",mapContainer:"BuddyGroupDetailModal_mapContainer__JEsaU",map:"BuddyGroupDetailModal_map__yGhxs",mapOverlay:"BuddyGroupDetailModal_mapOverlay__oMARM",mapOverlayText:"BuddyGroupDetailModal_mapOverlayText__EcqMX",headerContainer:"BuddyGroupDetailModal_headerContainer__vxec2",groupImage:"BuddyGroupDetailModal_groupImage___acDI",groupTextContainer:"BuddyGroupDetailModal_groupTextContainer__AqHiv",groupTitle:"BuddyGroupDetailModal_groupTitle__6Wa1f",groupDescription:"BuddyGroupDetailModal_groupDescription__bXxfw",sectionTitle:"BuddyGroupDetailModal_sectionTitle__YQhh2",memberList:"BuddyGroupDetailModal_memberList__Nk43q",memberCard:"BuddyGroupDetailModal_memberCard__i5W_l",memberNickname:"BuddyGroupDetailModal_memberNickname__8Hj5h",goToBuddyPageButton:"BuddyGroupDetailModal_goToBuddyPageButton__KVjav",goToBuddyPageButtonGradient:"BuddyGroupDetailModal_goToBuddyPageButtonGradient__x5cVD",goToBuddyPageTouchable:"BuddyGroupDetailModal_goToBuddyPageTouchable__n9I4C",goToBuddyPageButtonText:"BuddyGroupDetailModal_goToBuddyPageButtonText__IWG2l"}},696:e=>{e.exports={backdrop:"InviteOverlay_backdrop__y90Kw",wrapper:"InviteOverlay_wrapper__b6DHZ",blurLayer:"InviteOverlay_blurLayer__jdiHc",card:"InviteOverlay_card__mfsdM",title:"InviteOverlay_title__wvpMO",list:"InviteOverlay_list__lZ8Vs",empty:"InviteOverlay_empty__71RRe",item:"InviteOverlay_item__K528_",avatar:"InviteOverlay_avatar__qt3ej",name:"InviteOverlay_name__OM9Y2",inviteBtn:"InviteOverlay_inviteBtn__DuI0d",closeBtn:"InviteOverlay_closeBtn__4utFG",devBadge:"InviteOverlay_devBadge__RFjxk"}},10165:e=>{e.exports={wrapper:"MoveQuiz_wrapper__xmCDH",attemptRow:"MoveQuiz_attemptRow__GYL1p",attemptDot:"MoveQuiz_attemptDot__BmieJ",activeDot:"MoveQuiz_activeDot__dnfCz",timer:"MoveQuiz_timer__RpRwi",line:"MoveQuiz_line__FUdLi",suggestionLine:"MoveQuiz_suggestionLine__6cbsK",gap:"MoveQuiz_gap__QReUh",gapSmall:"MoveQuiz_gapSmall__omLKG",gapActive:"MoveQuiz_gapActive__FeBoi",word:"MoveQuiz_word__FXY3S",wordSentence:"MoveQuiz_wordSentence__6Nt08",wordSuggestion:"MoveQuiz_wordSuggestion__9rF1c",dragging:"MoveQuiz_dragging__8z4nT",hintMark:"MoveQuiz_hintMark__NzMqC",btnRow:"MoveQuiz_btnRow__imMzt",hintBtn:"MoveQuiz_hintBtn__vfIrV",checkBtn:"MoveQuiz_checkBtn__R0Ted",reveal:"MoveQuiz_reveal___LT9y",correct:"MoveQuiz_correct__cCr4Y"}},10741:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eN});var s=a(95155),n=a(12115),i=a(66766),l=a(55028),r=a(35695),o=a(23464),c=a(14298),d=a(51368),u=a(29300),_=a.n(u),m=a(98232),h=a.n(m),g=a(61065),p=a(91218),v=a(20023),x=a(51012),y=a.n(x),A=a(50802);let f=e=>{let{onSendMessage:t,showPhotoIcon:a=!0,value:l,onChangeText:r,isAIChat:o=!1,isVoiceChatMode:c=!1,onToggleVoiceChatMode:d=()=>{}}=e,{t:u}=(0,p.Bd)(),[m,h]=(0,n.useState)(null),[g,v]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),[b,j]=(0,n.useState)(!1),C=(0,n.useRef)(null),N=(0,n.useRef)(null),w=!!localStorage.getItem("token");(0,n.useEffect)(()=>{let e=N.current;if(!e)return;e.style.height="auto";let t=Math.min(e.scrollHeight,240);e.style.height="".concat(t,"px")},[l]);let I=async()=>{if(x)return;if(!w){j(!0);return}let e=l.trim();if(e||m){f(!0);try{await t({text:e,imageUri:m||void 0}),r(""),h(null),v(!1),N.current&&(N.current.style.height="40px")}catch(e){console.error(e)}finally{f(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[b&&(0,s.jsx)(A.A,{visible:!0,onLogin:()=>{j(!1),window.location.href="/sign-in"},onBrowse:()=>j(!1)}),g&&m&&(0,s.jsx)("div",{className:y().previewOverlay,onClick:()=>v(!1),children:(0,s.jsxs)("div",{className:y().previewCard,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)(i.default,{src:m,alt:"preview",fill:!0,style:{objectFit:"cover",borderRadius:10}}),(0,s.jsx)("button",{className:y().previewClose,onClick:()=>{h(null),v(!1)},children:"✕"})]})}),(0,s.jsxs)("div",{className:y().frame,children:[a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{ref:C,type:"file",accept:"image/*",className:y().hiddenFile,onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(h(URL.createObjectURL(a)),v(!0))}}),(0,s.jsx)("button",{className:y().iconBtn,disabled:x,onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},children:(0,s.jsx)(i.default,{src:"/assets/chatInputImage.png",alt:"img",width:24,height:24})})]}):(0,s.jsx)("div",{className:y().iconPlaceholder}),(0,s.jsx)("textarea",{ref:N,className:y().input,value:l,onChange:e=>r(e.target.value),placeholder:u(w?"messageInput.placeholder":"messageInput.login_required"),onKeyDown:e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),I())},disabled:x}),o&&""===l.trim()?(0,s.jsx)("button",{className:y().iconBtn,onClick:d,disabled:x,children:(0,s.jsx)(i.default,{src:c?"/assets/chatInputPlayOn.png":"/assets/chatInputPlay.png",alt:"voice",width:24,height:24})}):(0,s.jsx)("button",{className:_()(y().iconBtn,{[y().sending]:x}),onClick:I,disabled:x,children:(0,s.jsx)(i.default,{src:"/assets/chatInputSend.png",alt:"send",width:24,height:24})})]})]})};var b=a(32649),j=a(660),C=a.n(j);let N=e=>{let{visible:t,onClose:a,buddyGroupId:i}=e,{SERVER_URL:l}=(0,g.U)(),{t:c}=(0,p.Bd)(),d=(0,r.useRouter)(),[u,_]=(0,n.useState)(!1),[m,h]=(0,n.useState)(null),[v,x]=(0,n.useState)(null),y=e=>e?e.startsWith("http")?e:"/assets/".concat(e):null;return((0,n.useEffect)(()=>{(async()=>{if(i&&t){_(!0),x(null);try{let e=(await o.A.get("".concat(l,"/buddy-groups/get/").concat(i))).data;if(!e)throw Error(c("modal.dataNotFoundError"));h({buddyGroupId:e.buddyGroupId,buddyGroupName:e.buddyGroupName,buddyPhoto:y(e.buddyPhoto),buddyPhotoMedium:y(e.buddyPhotoMedium),description:e.description,activityCountry:e.activityCountry,activityCity:e.activityCity,latitude:e.latitude,longitude:e.longitude,members:e.members.map(e=>({...e,profileImage:y(e.profileImage)}))})}catch(e){console.error(c("modal.unknownError"),e),x(e.message||c("modal.errorFetchingInfo"))}finally{_(!1)}}})()},[i,t,l,c]),t)?(0,s.jsx)("div",{className:C().modalOverlay,onClick:a,children:(0,s.jsx)("div",{className:C().modalContainer,onClick:e=>e.stopPropagation(),children:u?(0,s.jsxs)("div",{className:C().buddyGroupLoadingContainer,children:[(0,s.jsx)("div",{className:C().spinner}),(0,s.jsx)("p",{className:C().loadingText,children:c("modal.loadingBuddyInfo")})]}):v?(0,s.jsxs)("div",{className:C().errorContainer,children:[(0,s.jsx)("p",{className:C().errorText,children:v}),(0,s.jsx)("button",{className:C().retryButton,onClick:async()=>{h(null),_(!0);try{let e=(await o.A.get("".concat(l,"/buddy-groups/get/").concat(i))).data;h({buddyGroupId:e.buddyGroupId,buddyGroupName:e.buddyGroupName,buddyPhoto:y(e.buddyPhoto),buddyPhotoMedium:y(e.buddyPhotoMedium),description:e.description,activityCountry:e.activityCountry,activityCity:e.activityCity,latitude:e.latitude,longitude:e.longitude,members:e.members.map(e=>({...e,profileImage:y(e.profileImage)}))}),x(null)}catch(e){console.error(c("modal.unknownError"),e),x(e.message||c("modal.errorFetchingInfo"))}finally{_(!1)}},children:c("modal.retry")})]}):(0,s.jsxs)("div",{className:C().detailsContainer,children:[(0,s.jsxs)("div",{className:C().mapContainer,children:[(0,s.jsx)("div",{className:C().map,children:m&&m.latitude&&m.longitude&&(0,s.jsx)("img",{src:"/assets/map_buddy.png",alt:"map marker",className:C().customMarkerImage})}),(0,s.jsx)("div",{className:C().mapOverlay,children:(0,s.jsx)("p",{className:C().mapOverlayText,children:"".concat((null==m?void 0:m.activityCity)||c("modal.unknownCity"),", ").concat((null==m?void 0:m.activityCountry)||c("modal.unknownCountry"))})})]}),(0,s.jsxs)("div",{className:C().headerContainer,children:[(0,s.jsx)("img",{src:(null==m?void 0:m.buddyPhotoMedium)?m.buddyPhotoMedium:(null==m?void 0:m.buddyPhoto)?m.buddyPhoto:"/assets/groupChat.png",alt:"group",className:C().groupImage}),(0,s.jsxs)("div",{className:C().groupTextContainer,children:[(0,s.jsx)("p",{className:C().groupTitle,children:null==m?void 0:m.buddyGroupName}),(0,s.jsx)("p",{className:C().groupDescription,children:(null==m?void 0:m.description)||c("modal.defaultDescription")})]})]}),(0,s.jsx)("p",{className:C().sectionTitle,children:c("modal.members")}),(0,s.jsx)("div",{className:C().memberList,children:null==m?void 0:m.members.map(e=>(0,s.jsxs)("div",{className:C().memberCard,children:[(0,s.jsx)(b.A,{userId:e.userId,nickname:e.nickname,profileImage:e.profileImage||void 0,countryName:void 0,size:60}),(0,s.jsx)("p",{className:C().memberNickname,children:e.nickname})]},e.userId))}),(0,s.jsx)("div",{className:C().goToBuddyPageButton,children:(0,s.jsx)("div",{className:C().goToBuddyPageButtonGradient,children:(0,s.jsx)("button",{className:C().goToBuddyPageTouchable,onClick:()=>{m?(a(),d.push("/buddy?buddyGroupId=".concat(m.buddyGroupId))):alert("".concat(c("modal.errorAlert"),": ").concat(c("modal.buddyInfoUnavailable")))},children:(0,s.jsx)("p",{className:C().goToBuddyPageButtonText,children:c("modal.navigateToBuddyPage")})})})})]})})}):null};var w=a(696),I=a.n(w);let S=e=>{let{visible:t,friends:a,chatUserIds:n,onInvite:l,onClose:r,underDevelopment:o}=e,{t:c}=(0,p.Bd)();if(!t)return null;let d=a.filter(e=>!n.includes(e.userId));return(0,s.jsx)("div",{className:I().backdrop,onClick:r,children:(0,s.jsxs)("div",{className:I().wrapper,onClick:e=>e.stopPropagation(),children:[o&&(0,s.jsx)("div",{className:I().blurLayer}),(0,s.jsxs)("div",{className:I().card,children:[(0,s.jsx)("h3",{className:I().title,children:c("invite_friends")}),(0,s.jsxs)("div",{className:I().list,children:[0===d.length&&(0,s.jsx)("p",{className:I().empty,children:c("no_friends_left")}),d.map(e=>(0,s.jsxs)("div",{className:I().item,children:[(0,s.jsx)(i.default,{src:e.profileThumbnail||e.profileImage||"/assets/Anonymous.png",alt:e.nickname,width:40,height:40,className:I().avatar}),(0,s.jsx)("span",{className:I().name,children:e.nickname}),(0,s.jsx)("button",{className:I().inviteBtn,onClick:()=>l(e.userId),children:c("invite")})]},e.userId))]}),(0,s.jsx)("button",{className:I().closeBtn,onClick:r,children:c("close")})]}),o&&(0,s.jsx)("div",{className:I().devBadge,children:c("under_development")})]})})};var B=a(10351),M=a(32404),k=a.n(M);let D=e=>{let{choices:t,onSelect:a,onDisable:i,onClose:l}=e,{t:r}=(0,p.Bd)(),[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(!1),m=e=>{o||(c(e.text),u(!0),a(e),setTimeout(()=>{l()},3600))};return(0,n.useEffect)(()=>{if(!d)return;let e=setTimeout(()=>u(!1),240);return()=>clearTimeout(e)},[d]),(0,s.jsxs)("div",{className:k().container,children:[(0,s.jsxs)("div",{className:k().headerRow,children:[(0,s.jsx)("span",{className:k().headerText,children:r("mcq_prompt","Pick the grammatically correct sentence")}),(0,s.jsx)("button",{className:k().disableBtn,onClick:i,children:r("disable_quiz","Turn off")})]}),t.map((e,t)=>{let a=o===e.text,i=a&&e.isCorrect,l=a&&!e.isCorrect;return(0,s.jsxs)(n.Fragment,{children:[l&&e.explanation&&(0,s.jsx)("p",{className:k().explanation,children:e.explanation}),(0,s.jsxs)("button",{className:_()(k().option,a&&(i?k().correct:k().wrong),a&&d&&k().bounce),disabled:!!o,onClick:()=>m(e),children:[(0,s.jsx)("span",{className:_()(k().optionText,a&&k().optionTextSelected),children:e.text}),a&&(0,s.jsx)("span",{className:k().resultIcon,children:i?(0,s.jsx)(B.YrT,{size:18,color:"#31A24C"}):(0,s.jsx)(B.yGN,{size:18,color:"#D8315B"})})]})]},"opt-".concat(t))})]})};var R=a(47937),O=a(62108),G=a(88440),T=a.n(G);let E=e=>e.replace(/[_-]+/g," ").replace(/\w+/g,e=>e[0].toUpperCase()+e.slice(1)).replace(/\s+/g,""),P=e=>{let{count:t,accent:a="#6366F1",icon:i="bookmark",size:l=28}=e,[r,o]=(0,n.useState)(!1),c=(0,n.useRef)(t);(0,n.useEffect)(()=>{if(t>c.current){o(!0);let e=setTimeout(()=>o(!1),600);return()=>clearTimeout(e)}c.current=t},[t]);let d=R[E(i)]||O.A;return(0,s.jsxs)("span",{className:"".concat(T().container," ").concat(r?T().pulse:""),style:{height:l,paddingLeft:.5*l,paddingRight:.5*l,borderRadius:l/2,color:a,boxShadow:"0 2px 4px ".concat(a,"33")},children:[(0,s.jsx)(d,{size:.55*l,color:a,style:{marginRight:6,flexShrink:0}}),(0,s.jsx)("span",{className:T().count,style:{fontSize:.5*l+2,color:a},children:t})]})};var U=a(47650),z=a(13905),Q=a.n(z);let F=e=>{var t;let{visible:a,steps:i,storageKey:l,onClose:r,onStepChange:o}=e,{t:c}=(0,p.Bd)(),d="hidden"===localStorage.getItem(l);if(!a||d||!i.length)return null;let[u,m]=(0,n.useState)(0);(0,n.useEffect)(()=>{null==o||o(u)},[u,o]);let h=(0,n.useCallback)(()=>{localStorage.setItem(l,"hidden"),r()},[r,l]),g=i[u],{innerWidth:v,innerHeight:x}=null!==(t=globalThis.window)&&void 0!==t?t:{innerWidth:0,innerHeight:0},y=g.target.y+g.target.radius+106,A=g.target.y-g.target.radius-150,f=y+150+106>x?Math.max(A,106):y,b="undefined"!=typeof document?document.getElementById("__next"):void 0;return b?(0,U.createPortal)((0,s.jsxs)("div",{className:Q().overlay,children:[(0,s.jsxs)("svg",{className:Q().svgLayer,width:v,height:x,"aria-hidden":!0,focusable:"false",children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("mask",{id:"guide-mask",children:[(0,s.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"white"}),(0,s.jsx)("circle",{cx:g.target.x,cy:o?106+g.target.radius:g.target.y,r:g.target.radius,fill:"black"})]})}),(0,s.jsx)("rect",{className:Q().backdrop,x:"0",y:"0",width:"100%",height:"100%",mask:"url(#guide-mask)"})]}),(0,s.jsxs)("div",{className:Q().callout,style:{top:f},children:[(0,s.jsx)("h3",{className:Q().title,children:c("".concat(g.key,".title"))}),(0,s.jsx)("p",{className:Q().desc,children:c("".concat(g.key,".desc"))}),(0,s.jsxs)("div",{className:Q().navRow,children:[(0,s.jsx)("button",{className:_()(Q().navBtn,0===u&&Q().disabled),disabled:0===u,onClick:()=>m(e=>Math.max(0,e-1)),children:c("guide.prev")}),(0,s.jsx)("button",{className:Q().navBtn,onClick:()=>u>=i.length-1?r():m(e=>e+1),children:c(u===i.length-1?"guide.finish":"guide.next")})]}),(0,s.jsx)("button",{className:Q().skip,onClick:h,children:c("guide.dontShowAgain")})]})]}),b):null};var L=a(30349),W=a.n(L);let Y=e=>{let{visible:t,imageUri:a,scenarioText:i,persona:l,onClose:r,onLeave:o,onShare:c,chatId:d}=e,{t:u}=(0,p.Bd)();if(!t)return null;let[m,h]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),[x,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{y("true"===localStorage.getItem("shared_chat_".concat(d)))},[d]);let A=async()=>{if(!m){h(!0);try{await o()}finally{h(!1)}}},f=async()=>{if(!g&&!x){v(!0);try{await c(),localStorage.setItem("shared_chat_".concat(d),"true"),y(!0)}catch(e){console.error(e)}finally{v(!1)}}},b="undefined"!=typeof document?document.getElementById("__next"):void 0;return b?(0,U.createPortal)((0,s.jsx)("div",{className:W().overlay,onClick:r,children:(0,s.jsxs)("div",{className:W().card,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:W().image,style:{backgroundImage:"url(".concat(a,")")},children:[(0,s.jsx)("div",{className:W().gradient}),(0,s.jsxs)("div",{className:W().textWrap,children:[(0,s.jsx)("h3",{className:W().title,children:u("scenario")}),(0,s.jsx)("p",{className:W().scenario,children:i}),l&&(0,s.jsxs)("div",{className:W().personaBox,children:[l.personality&&(0,s.jsx)("p",{className:W().personaTrait,children:l.personality}),l.speakingStyle&&(0,s.jsx)("p",{className:W().personaTrait,children:l.speakingStyle}),l.catchPhrase&&(0,s.jsx)("p",{className:W().personaCatch,children:l.catchPhrase})]})]})]}),(0,s.jsxs)("div",{className:W().btnRow,children:[(0,s.jsx)("button",{className:_()(W().btnLeave,{[W().disabled]:m}),onClick:A,disabled:m,children:u("leave_custom_session")}),x?(0,s.jsx)("button",{className:_()(W().btn,W().disabled),disabled:!0,children:u("shared_label")}):(0,s.jsx)("button",{className:_()(W().btn,{[W().disabled]:g}),onClick:f,disabled:g,children:u("share")})]})]})}),b):null};var X=a(50507),J=a.n(X);let H=e=>e.trim().split(/\s+/),V=(e,t,a)=>{let s=H(e),n=a?H(a):[],i=(e,t)=>{let a=RegExp("\\b".concat(J()(t),"\\b"),"i").exec(e);if(!a||void 0===a.index)return -1;let s=e.slice(0,a.index).trim();return s?s.split(/\s+/).length:0};return t.map(t=>{if(void 0!==t.index&&t.index>=0)return t;if(t.error.trim()){let a=H(t.error),n=s.findIndex((e,n)=>s.slice(n,n+a.length).join(" ")===t.error);if(n>=0)return{...t,index:n};let l=i(e,t.error);return{...t,index:l}}let a=H(t.suggestion);if(n.length){let e=0,i=0;for(;e<s.length&&i<n.length;){if(s[e]===n[i]){e++,i++;continue}if(n.slice(i,i+a.length).join(" ")===t.suggestion.trim())return{...t,index:e};i++}}return{...t,index:s.length}})},K=(e,t)=>{let a=H(e);return[...t].sort((e,t)=>{var a,s;return(null!==(a=e.index)&&void 0!==a?a:0)-(null!==(s=t.index)&&void 0!==s?s:0)}).forEach(e=>{let{error:t,suggestion:s,index:n=0}=e,i=H(s);if(t.trim()){let e=H(t).length;a.splice(n,e,...i)}else a.splice(n,0,...i)}),a};var q=a(10165),Z=a.n(q);let $=RegExp("\\p{Emoji_Presentation}","gu"),ee=e=>e.replace($,"").trim()||null,et=e=>e.split(" ").map(ee).filter(e=>!!e),ea=e=>"".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0")),es=e=>{let{sentence:t,issues:a,started:i,learnLanguage:l,onSubmit:r}=e,{t:o}=(0,p.Bd)(),c=et(t),[d,u]=(0,n.useState)(c),[m,h]=(0,n.useState)([]),[g,v]=(0,n.useState)(null),[x,y]=(0,n.useState)(3),[A,f]=(0,n.useState)(0),[b,j]=(0,n.useState)(new Set),[C,N]=(0,n.useState)(0),[w,I]=(0,n.useState)(null),[S,B]=(0,n.useState)(!1),M=(0,n.useRef)(null);(0,n.useEffect)(()=>{i&&!M.current&&(M.current=Date.now());let e=window.setInterval(()=>{M.current&&N(Math.floor((Date.now()-M.current)/1e3))},1e3);return()=>window.clearInterval(e)},[i]),(0,n.useEffect)(()=>{h(a.flatMap(e=>{let t=et(e.error);return et(e.suggestion).filter(e=>!t.includes(e))}))},[a]);let k=(e,t,a)=>JSON.stringify({src:e,idx:t,word:a}),D=(e,t,a)=>s=>{s.dataTransfer.setData("text/plain",k(e,t,a)),s.dataTransfer.effectAllowed="move",v("".concat(e,"-").concat(t,"-").concat(a))},R=()=>v(null),O=(e,t)=>a=>{a.preventDefault();let s=a.dataTransfer.getData("text/plain");if(!s)return;let{src:n,idx:i,word:l}=JSON.parse(s);if(n===e&&i===t)return;let r=[...d],o=[...m];"sentence"===n?r.splice(i,1):o.splice(i,1),"sentence"===e?r.splice(t,0,l):o.splice(t,0,l),u(r),h(o),v(null)},G=e=>e.preventDefault(),T=K(t,V(t,a)),E=(0,n.useCallback)(()=>{let e=new Set;return T.forEach((t,a)=>{d[a]!==t&&e.add(a)}),e},[d,T]),P=e=>{let{w:t,src:a,idx:n}=e;return(0,s.jsxs)("span",{draggable:!0,onDragStart:D(a,n,t),onDragEnd:R,className:_()(Z().word,{[Z().wordSentence]:"sentence"===a,[Z().wordSuggestion]:"suggested"===a,[Z().dragging]:g==="".concat(a,"-").concat(n,"-").concat(t)}),children:[t,b.has(n)&&"sentence"===a&&(0,s.jsx)("span",{className:Z().hintMark,children:"?"})]})};return(0,s.jsxs)("div",{className:Z().wrapper,children:[(0,s.jsxs)("div",{className:Z().attemptRow,children:[[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("span",{className:_()(Z().attemptDot,{[Z().activeDot]:t<x})},t)),(0,s.jsx)("span",{className:Z().timer,children:ea(C)})]}),(0,s.jsxs)("div",{className:Z().line,onDragOver:G,children:[d.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("span",{className:_()(Z().gap,{[Z().gapActive]:g&&g.startsWith("sentence")&&b.has(t)}),onDragOver:G,onDrop:O("sentence",t)}),(0,s.jsx)(P,{w:d[t],src:"sentence",idx:t})]},"gap-s-".concat(t))),(0,s.jsx)("span",{className:Z().gap,onDragOver:G,onDrop:O("sentence",d.length)})]}),(0,s.jsxs)("div",{className:Z().suggestionLine,onDragOver:G,children:[m.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("span",{className:Z().gapSmall,onDragOver:G,onDrop:O("suggested",t)}),(0,s.jsx)(P,{w:e,src:"suggested",idx:t})]},"gap-t-".concat(t))),(0,s.jsx)("span",{className:Z().gapSmall,onDragOver:G,onDrop:O("suggested",m.length)})]}),(0,s.jsxs)("div",{className:Z().btnRow,children:[(0,s.jsx)("button",{className:Z().hintBtn,onClick:()=>{f(e=>e+1),j(E())},children:o("hint_button")}),(0,s.jsx)("button",{className:Z().checkBtn,onClick:()=>{if(x<=0)return;let e=d.join(" "),t=e===T.join(" ");B(t),t?r(e):(alert(o("try_again")),x-1==0&&I(T.join(" "))),y(e=>e-1)},children:o("check_answer_button")})]}),w&&(0,s.jsx)("p",{className:Z().reveal,children:o("reveal_answer",{answer:w})}),S&&(0,s.jsx)("p",{className:Z().correct,children:o("correct_answer")})]})};var en=a(19089),ei=a.n(en);let el=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),er=(e,t)=>{let a=e;for(let{error:e,suggestion:s}of t){let t=RegExp(el(e),"g");a=a.replace(t,s)}return a.replace(/\s+/g," ").trim().split(" ")},eo=(e,t)=>{let a=e.trim().split(" "),s=[];t.forEach(e=>{let{suggestion:t}=e;return s.push(...t.trim().split(" "))});let n=[],i=0;for(;i<a.length;){let e=t.find(e=>{let{error:t}=e,s=t.split(" ");return a.slice(i,i+s.length).join(" ").toLowerCase()===t.toLowerCase()});if(e){let t=e.suggestion.trim().split(" ").length;for(let e=0;e<t;e++)n.push("");i+=e.error.trim().split(" ").length}else n.push(a[i]),i+=1}let l=n.map((e,t)=>""===e?t:-1).filter(e=>e>=0);return{initialWords:n,blankIndices:l,suggestionWords:s}},ec=e=>"".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0")),ed=e=>{let{sentence:t,issues:a,learnLanguage:i,started:l,onSubmit:r}=e,{t:o}=(0,p.Bd)(),{initialWords:c,blankIndices:d,suggestionWords:u}=(0,n.useMemo)(()=>eo(t,a),[t,a]),[m,h]=(0,n.useState)(c),[g,v]=(0,n.useState)(()=>[...u].sort(()=>Math.random()-.5)),[x,y]=(0,n.useState)(3),[A,f]=(0,n.useState)(0),[b,j]=(0,n.useState)(new Set),[C,N]=(0,n.useState)(null),[w,I]=(0,n.useState)(null),S=(0,n.useRef)(null),[B,M]=(0,n.useState)(0);(0,n.useEffect)(()=>{l&&!S.current&&(S.current=Date.now());let e=window.setInterval(()=>{S.current&&M(Math.floor((Date.now()-S.current)/1e3))},1e3);return()=>window.clearInterval(e)},[l]);let k=(e,t)=>JSON.stringify({w:e,idx:t}),D=(e,t)=>a=>{a.dataTransfer.setData("text/plain",k(e,t)),a.dataTransfer.effectAllowed="move"},R=e=>e.preventDefault(),O=e=>t=>{t.preventDefault();let a=t.dataTransfer.getData("text/plain");if(!a)return;let{w:s,idx:n}=JSON.parse(a);m[e]||(h(t=>{let a=[...t];return a[e]=s,a}),v(e=>e.filter((e,t)=>t!==n)),N(null))},G=(e,t)=>{let a=d.find(e=>""===m[e]);void 0!==a&&(h(t=>{let s=[...t];return s[a]=e,s}),v(e=>e.filter((e,a)=>a!==t)))},T=e=>{if(!d.includes(e))return;let t=m[e];t&&(h(t=>{let a=[...t];return a[e]="",a}),v(e=>[...e,t]))},E=(0,n.useMemo)(()=>er(t,a),[t,a]);return(0,s.jsxs)("div",{className:ei().card,children:[(0,s.jsxs)("div",{className:ei().attemptRow,children:[[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("span",{className:_()(ei().dot,{[ei().activeDot]:t<x})},t)),(0,s.jsx)("span",{className:ei().timer,children:ec(B)})]}),(0,s.jsx)("div",{className:ei().sentence,children:m.map((e,t)=>d.includes(t)?(0,s.jsx)("div",{className:_()(ei().blank,{[ei().blankActive]:C===t,[ei().blankWrong]:b.has(t)}),onClick:()=>T(t),onDragOver:R,onDragEnter:()=>N(t),onDragLeave:()=>N(null),onDrop:O(t),children:e&&(0,s.jsx)("span",{className:ei().filled,children:e})},"blank-".concat(t)):(0,s.jsx)("span",{className:ei().fixed,children:e},"fixed-".concat(t)))}),(0,s.jsx)("div",{className:ei().suggestions,children:g.map((e,t)=>(0,s.jsx)("span",{draggable:!0,onDragStart:D(e,t),onClick:()=>G(e,t),className:ei().chip,children:e},"sug-".concat(t)))}),(0,s.jsxs)("div",{className:ei().btnRow,children:[(0,s.jsx)("button",{className:ei().hintBtn,onClick:()=>{f(e=>e+1);let e=new Set;d.forEach(t=>{m[t]&&m[t]!==E[t]&&e.add(t)}),j(e)},children:o("hint_button")}),(0,s.jsx)("button",{className:ei().checkBtn,onClick:()=>{let e=m.length===E.length&&m.every((e,t)=>e===E[t]);y(e=>e-1),e?(alert(o("well_done")),r(m.join(" "))):(alert(o("try_again")),x-1==0&&I(E.join(" ")))},children:o("check_answer_button")})]}),w&&(0,s.jsx)("p",{className:ei().reveal,children:o("reveal_answer",{answer:w})})]})};var eu=a(89928),e_=a.n(eu);let em=(e,t)=>{if(!e)return"";let a=(Date.now()-new Date(e).getTime())/1e3;return a<60?t("time.sec_ago",{count:Math.floor(a)}):a<3600?t("time.min_ago",{count:Math.floor(a/60)}):a<86400?t("time.hr_ago",{count:Math.floor(a/3600)}):t("time.day_ago",{count:Math.floor(a/86400)})},eh=()=>{let{SERVER_URL:e}=(0,g.U)(),{t}=(0,p.Bd)(),a=(0,r.useRouter)(),[l,c]=(0,n.useState)(!1),[u,_]=(0,n.useState)(!0),[m,h]=(0,n.useState)(!1),[v,x]=(0,n.useState)([]),y="true"===localStorage.getItem("isLoggedIn"),A=()=>{let e=localStorage.getItem("deviceId"),t=null!=e?e:(0,d.A)();return e||localStorage.setItem("deviceId",t),t};(0,n.useEffect)(()=>{let t=async()=>{let{data:t}=await o.A.get("".concat(e,"/chats/get-with-ai"),{withCredentials:!0});return t.chatSummaries.filter(e=>"personal"===e.type)},a=async()=>{let t=A(),{data:a}=await o.A.get("".concat(e,"/anon-ai-chat/sessions"),{headers:{"X-Device-Id":t},withCredentials:!0});return(a.sessions||[]).map(e=>({_id:e.sessionId,userIds:[e.otherUserId||"anon-ai"],userDetails:[{userId:e.otherUserId||"anon-ai",nickname:e.assistantName||"AI",profileImage:"/assets/AIProfile.png"}],lastMessage:e.lastMessage,lastMessageTime:e.lastMessageTime,type:"personal",title:e.assistantName||"AI"}))};(async()=>{try{let e=y?await t():await a();x(e)}catch(e){console.error(e),h(!0)}finally{_(!1)}})()},[e,y]);let f=e=>{var t;let s=null===(t=e.userDetails[0])||void 0===t?void 0:t.userId;a.push("/chatting-room?chatId=".concat(e._id,"&otherUserId=").concat(s))};return(0,s.jsxs)("div",{className:e_().container,children:[(0,s.jsxs)("aside",{className:"".concat(e_().sidebar," ").concat(l?e_().open:""),children:[(0,s.jsx)("button",{className:e_().toggleBtn,onClick:()=>c(!l),children:"☰"}),(0,s.jsx)("nav",{className:e_().navMenu,children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{className:e_().active,children:t("chat.personal")}),(0,s.jsx)("li",{onClick:()=>a.push("/buddy-groups"),children:t("buddy_groups")}),(0,s.jsx)("li",{onClick:()=>a.push("/region-chat"),children:t("regional_chat")}),(0,s.jsx)("li",{onClick:()=>a.push("/search"),children:t("search.search")})]})})]}),(0,s.jsxs)("main",{className:e_().main,children:[(0,s.jsx)("h1",{className:e_().title,children:t("chat.personal")}),u&&(0,s.jsx)("p",{className:e_().info,children:t("loading")}),m&&(0,s.jsx)("p",{className:e_().info,children:t("error_loading_chat")}),!u&&!m&&0===v.length&&(0,s.jsx)("p",{className:e_().info,children:t("no_personal_chats")}),(0,s.jsx)("ul",{className:e_().chatList,children:v.map(e=>{var a;let n=e.userDetails[0],l=n.profileThumbnail||n.profileImage||"/assets/Annonymous.png";return(0,s.jsxs)("li",{className:e_().chatItem,onClick:()=>f(e),children:[(0,s.jsx)(i.default,{src:l,alt:n.nickname,width:48,height:48,className:e_().avatar}),(0,s.jsxs)("div",{className:e_().chatInfo,children:[(0,s.jsx)("span",{className:e_().nickname,children:n.nickname}),(0,s.jsx)("span",{className:e_().lastMsg,children:(null===(a=e.lastMessage)||void 0===a?void 0:a.startsWith("https://"))?t("click_view_photo"):e.lastMessage||t("first_chat_prompt")})]}),(0,s.jsx)("span",{className:e_().time,children:em(e.lastMessageTime,t)})]},e._id)})})]})]})},eg={src:"/_next/static/media/AIProfile.c4f4afc0.png"},ep={src:"/_next/static/media/BackIcon.ef3eb046.png",height:141,width:140,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAD1BMVEVMaXEKEEQID0QAEkgKEEWBphx6AAAABXRSTlMAQmAOfQuWfSgAAAAJcEhZcwAALEsAACxLAaU9lqkAAAAYSURBVHicY2DAChihNBOMwQJjMDNh1QEAAgMADyKqR2sAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ev={src:"/_next/static/media/full-post-menu-icon.22c0d103.png",height:141,width:140,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAD1BMVEULDkRMaXELEUQKDkMJD0NSuPAYAAAABXRSTlNTAA5gH1+z+PIAAAAJcEhZcwAALEsAACxLAaU9lqkAAAAmSURBVHicY2CEAgYEg4mBgYGBBcpghjEgIszMzGARRiYmJiYkXQAK7QBUeGvtIQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},ex={src:"/_next/static/media/plus-icon.767c437b.png",height:72,width:72,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAElBMVEX////Y2NhMaXHm5ubZ2dnY2NjMqs+zAAAABnRSTlMFXACFgcHqjTavAAAACXBIWXMAACxLAAAsSwGlPZapAAAAJklEQVR4nGNgggIGJgYmRkYwxcDEzAzhs7CysoDE4Ay4FFwxVDsAEkgAgWTnlwUAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},ey={src:"/_next/static/media/delete-icon-big.4f64120b.png",height:140,width:140,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAADFBMVEVMaXEJEEQLD0QJD0RX11dXAAAABHRSTlMAGkOJ7RJnfgAAAAlwSFlzAAAsSwAALEsBpT2WqQAAABtJREFUeJxjYMACmBgZmcAMRmZmRlQGXAoNAAAEOAAdDm5INgAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},eA=[{id:"cafe"},{id:"hotel"},{id:"directions"},{id:"grocery"},{id:"clothes"},{id:"interview"},{id:"meeting"},{id:"call"},{id:"hospital"},{id:"emergency"},{id:"dating"},{id:"party"}],ef=()=>(0,d.A)(),eb=()=>{let e=localStorage.getItem("deviceId");return e||(e=ef(),localStorage.setItem("deviceId",e)),e},ej=(e,t)=>{let a=e.split(/\s+/);return t.map(t=>{if("number"==typeof t.index&&t.index>=0)return t;let s=a.findIndex((a,s)=>e.indexOf(t.error)>=0&&a===t.error.split(" ")[0]);return{...t,index:s}})};function eC(){var e,t,a;let l=(0,r.useRouter)(),d=(0,r.useSearchParams)(),{SERVER_URL:u}=(0,g.U)(),{t:m}=(0,p.Bd)(),x=null!==(e=d.get("otherUserId"))&&void 0!==e?e:void 0,y=null!==(t=d.get("buddyGroupId"))&&void 0!==t?t:void 0,A=null!==(a=d.get("chatId"))&&void 0!==a?a:void 0,b=!x||"brody-ai"===x||(null==x?void 0:x.startsWith("custom-ai")),j="true"===localStorage.getItem("isLoggedIn"),[C,w]=(0,n.useState)(A&&/^[0-9a-f\-]{36}$/i.test(A)?A:null),[I,B]=(0,n.useState)([]),[M,k]=(0,n.useState)("friend"),[R,O]=(0,n.useState)(""),[G,T]=(0,n.useState)(!0),[E,U]=(0,n.useState)(!1),[z,Q]=(0,n.useState)(null),[L,W]=(0,n.useState)(null),[X,J]=(0,n.useState)(null),H=(0,n.useRef)(null),[V,K]=(0,n.useState)("medium"),[q,Z]=(0,n.useState)("none"),[$,ee]=(0,n.useState)(!1),[et,ea]=(0,n.useState)(!1),[en,ei]=(0,n.useState)("cafe"),[el,er]=(0,n.useState)("en"),[eo,ec]=(0,n.useState)(!0),[eu,e_]=(0,n.useState)({}),[em,eC]=(0,n.useState)({}),[eN,ew]=(0,n.useState)(0),[eI,eS]=(0,n.useState)(0),[eB,eM]=(0,n.useState)(!1),[ek,eD]=(0,n.useState)(!1),[eR,eO]=(0,n.useState)(!1),[eG,eT]=(0,n.useState)(!1),[eE,eP]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{try{b?(await eU(),await ez(!0)):y?await eF():x&&await eQ()}finally{T(!1)}})()},[x,y]),(0,n.useEffect)(()=>{if(b||!C)return;let e=(0,c.Ay)(u,{transports:["polling","websocket"]});return e.emit("joinRoom",y||C),e.on("newMessage",e=>{B(t=>t.some(t=>t._id===e._id)?t:[e,...t])}),e.on("newBuddyMessage",e=>{e._id=String(e._id),B(t=>t.some(t=>t._id===e._id)?t:[e,...t])}),()=>{e.disconnect()}},[u,b,C,y]);let eU=async()=>{if(!C){if(j){let{data:e}=await o.A.post("".concat(u,"/ai-chat/session"),{otherUserId:x||"brody-ai"},{withCredentials:!0});w(e.sessionId),O(e.assistantName||"Brody"),k(e.assistantName||"Brody")}else{let{data:e}=await o.A.post("".concat(u,"/anon-ai-chat/session"),{otherUserId:x||"anon-ai"},{headers:{"X-Device-Id":eb()}});w(e.sessionId),O(e.assistantName||"AI"),k(e.assistantName||"AI")}}},ez=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!C)return;let t="".concat(u,"/ai-chat/session/").concat(C,"/messages?limit=").concat(20);!e&&H.current&&(t+="&cursor=".concat(encodeURIComponent(H.current)));let{data:a}=await o.A.get(t,j?{withCredentials:!0}:{headers:{"X-Device-Id":eb()}});H.current=a.nextCursor||null;let s=(a.messages||[]).map(e=>({_id:e._id,senderId:"assistant"===e.role?"brody-ai":"me",message:e.content,timestamp:e.timestamp,profileImage:"assistant"===e.role?eg.src:void 0}));B(t=>e?s.reverse():[...t,...s.filter(e=>!t.some(t=>t._id===e._id))])},eQ=async()=>{let e=await o.A.post("".concat(u,"/chats/createOrRetrieveChat"),{otherUserId:x},{withCredentials:!0}),t=e.data.chat;w(t._id),O(t.title||"chat"),B((t.messages||[]).slice().reverse());let a=t.userDetails.find(t=>t.userId!==e.data.loggedInUserId);a&&k(a.nickname)},eF=async()=>{let{data:e}=await o.A.get("".concat(u,"/buddy-chat/").concat(y),{withCredentials:!0}).catch(()=>({data:{messages:[]}}));B((e.messages||[]).slice().reverse()),O(e.buddyGroupName||m("group"))},eL=async e=>{let{text:t,imageUri:a}=e;if((null==t?void 0:t.trim())||a){if(b)return eW(t||"",a);eY(t,a)}},eW=async(e,t)=>{if(!C)return await eU();let a=ef(),s={_id:a,senderId:"me",message:e,timestamp:new Date().toISOString(),isUploading:!0};B(e=>[s,...e]);let n={content:e,difficulty:V,topic:q,voiceChatMode:$,rolePlayScenario:et?en:void 0,enableMCQ:!0,languageCode:el};try{let e=j?await o.A.post("".concat(u,"/ai-chat/session/").concat(C,"/message"),n,{withCredentials:!0}):await o.A.post("".concat(u,"/anon-ai-chat/session/").concat(C,"/message"),n,{headers:{"X-Device-Id":eb()}});B(e=>e.map(e=>e._id===a?{...e,isUploading:!1}:e));let t={_id:"ai-".concat(Date.now()),senderId:"brody-ai",message:e.data.assistantReply||"",timestamp:new Date().toISOString(),profileImage:eg.src};B(e=>[t,...e]),Array.isArray(e.data.choices)&&4===e.data.choices.length&&Q(e.data.choices)}catch(e){B(e=>e.filter(e=>e._id!==a))}},eY=async(e,t)=>{if(!C&&!y)return;let a=ef(),s={_id:a,senderId:"me",message:e||"",timestamp:new Date().toISOString(),imageUrl:t,isUploading:!0};B(e=>[s,...e]);let n=new FormData;if(n.append("senderId","me"),n.append("timestamp",new Date().toISOString()),e&&n.append("message",e),t){let e=t.split("/").pop()||"photo.jpg";n.append("file",new File([],e,{type:"image/jpeg"}))}let i=y?"".concat(u,"/buddy-chat/").concat(y):"".concat(u,"/chats/").concat(C,"/message");o.A.post(i,n,{withCredentials:!0}).then(e=>{let t={...e.data.message,isUploading:!1};B(e=>e.map(e=>e._id===a?t:e))}).catch(()=>B(e=>e.filter(e=>e._id!==a)))},eX=(e,t,a)=>{J({sentence:t,issues:a}),W(e)};return G?(0,s.jsx)("div",{className:h().loading,children:m("loading")}):(0,s.jsxs)("div",{className:h().container,children:[(0,s.jsx)("aside",{className:_()(h().sidebar,{[h().open]:E}),children:(0,s.jsx)(eh,{})}),(0,s.jsxs)("header",{className:h().header,children:[(0,s.jsx)("button",{className:h().iconBtn,onClick:()=>l.back(),children:(0,s.jsx)(i.default,{src:ep,alt:"Back",width:28,height:28})}),(0,s.jsxs)("button",{className:h().titleArea,onClick:()=>U(e=>!e),children:[(0,s.jsx)("span",{className:h().title,children:R||M}),(0,s.jsx)(i.default,{src:ex,alt:"▼",width:12,height:12})]}),(0,s.jsx)("button",{className:h().iconBtn,onClick:()=>eM(!0),children:(0,s.jsx)(i.default,{src:ev,alt:"Menu",width:28,height:28})})]}),(0,s.jsx)("main",{id:"chat-pane",className:h().chatPane,children:I.map(e=>(0,s.jsx)(v.A,{content:e.message,timestamp:e.timestamp,userId:e.senderId,isMine:"me"===e.senderId,profileImage:e.profileImage,imageUrl:e.imageUrl,isImageUploading:!!e.imageUrl&&e.isUploading,isTextUploading:!e.imageUrl&&e.isUploading,_id:e._id,messageType:b?"ai":y?"buddy":"normal",chatContextId:y||C||void 0,onDelete:e=>B(t=>t.filter(t=>t._id!==e)),issues:eu[e._id]||[],onOpenQuiz:eX},e._id))}),(0,s.jsx)("footer",{className:h().inputPane,children:(0,s.jsx)(f,{value:eE,onChangeText:eP,onSendMessage:e=>{let{text:t,imageUri:a}=e;eL({text:t,imageUri:a}),eP("")},isAIChat:b,isVoiceChatMode:$,onToggleVoiceChatMode:()=>ee(e=>!e)})}),eB&&(0,s.jsx)("div",{className:h().overlay,onClick:()=>eM(!1),children:(0,s.jsxs)("div",{className:h().menuCard,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("button",{className:h().closeBtn,onClick:()=>eM(!1),children:(0,s.jsx)(i.default,{src:ey,alt:"x",width:24,height:24})}),b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h4",{children:m("ai_options")}),(0,s.jsxs)("section",{className:h().row,children:[(0,s.jsxs)("span",{children:[m("difficulty"),":"]}),["easy","medium","hard"].map(e=>(0,s.jsx)("button",{className:_()(h().chip,{[h().chipOn]:V===e}),onClick:()=>K(e),children:m("difficulty_".concat(e))},e))]}),(0,s.jsxs)("section",{className:h().row,children:[(0,s.jsxs)("span",{children:[m("topic"),":"]}),["none","science","art","law","medicine"].map(e=>(0,s.jsx)("button",{className:_()(h().chip,{[h().chipOn]:q===e}),onClick:()=>Z(e),children:m("topic_".concat(e))},e))]}),(0,s.jsxs)("section",{className:h().row,children:[(0,s.jsx)("button",{className:_()(h().toggle,{[h().toggleOn]:$}),onClick:()=>ee(e=>!e),children:$?m("disable_voice_chat"):m("enable_voice_chat")}),(0,s.jsx)("button",{className:_()(h().toggle,{[h().toggleOn]:et}),onClick:()=>ea(e=>!e),children:et?m("disable_roleplay"):m("enable_roleplay")})]}),et&&(0,s.jsx)("section",{className:h().scenarioScroll,children:eA.map(e=>(0,s.jsx)("button",{className:_()(h().scenarioChip,{[h().scenarioOn]:en===e.id}),onClick:()=>ei(e.id),children:m("scenario_".concat(e.id))},e.id))}),(0,s.jsxs)("div",{className:h().row,children:[(0,s.jsx)(P,{count:eN,icon:"edit-3",accent:"#F2542D"}),(0,s.jsx)("div",{style:{width:12}}),(0,s.jsx)(P,{count:eI,icon:"type",accent:"#D8315B"})]})]}):(0,s.jsxs)(s.Fragment,{children:[y&&(0,s.jsx)("button",{className:h().menuBtn,onClick:()=>eD(!0),children:m("buddy_groups")}),(0,s.jsx)("button",{className:h().menuBtn,onClick:()=>eO(!0),children:m("invite")})]})]})}),(0,s.jsx)(S,{visible:eR,onClose:()=>eO(!1),friends:[],chatUserIds:[],onInvite:()=>{},underDevelopment:!1}),y&&(0,s.jsx)(N,{visible:ek,buddyGroupId:y,onClose:()=>eD(!1)}),z&&(0,s.jsx)(D,{choices:z,onSelect:e=>{let t;let a=z.find(e=>e.isCorrect);e.isCorrect||(t={error:e.text,suggestion:a.text,explanation:e.explanation||"",index:-1},t=ej(e.text,[t])[0]),eL({text:e.text}),t&&e_(e=>({...e,TEMP:[t]})),Q(null)},onClose:()=>Q(null),onDisable:()=>Q(null)}),(0,s.jsx)(Y,{visible:eG,onClose:()=>eT(!1),imageUri:"",scenarioText:"",chatId:C||"",onLeave:async()=>{},onShare:async()=>{}}),L&&X&&(0,s.jsx)("div",{className:h().overlay,onClick:()=>W(null),children:(0,s.jsxs)("div",{className:h().quizCard,onClick:e=>e.stopPropagation(),children:["move"===L&&(0,s.jsx)(es,{sentence:X.sentence,issues:X.issues,started:!0,learnLanguage:el,onSubmit:()=>W(null)}),"fill"===L&&(0,s.jsx)(ed,{sentence:X.sentence,issues:X.issues,started:!0,learnLanguage:el,onSubmit:()=>W(null)})]})}),(0,s.jsx)(F,{visible:!1,steps:[],storageKey:"chatRoomGuide",onClose:()=>{}})]})}let eN=(0,l.default)(()=>Promise.resolve(eC),{ssr:!1})},13905:e=>{e.exports={overlay:"GuideOverlay_overlay__EBrXf",svgLayer:"GuideOverlay_svgLayer__is8Yq",backdrop:"GuideOverlay_backdrop__Ew_ae",callout:"GuideOverlay_callout__JfhvZ",title:"GuideOverlay_title__hqH_0",desc:"GuideOverlay_desc__I1BwJ",navRow:"GuideOverlay_navRow__QhU8i",navBtn:"GuideOverlay_navBtn__3Rmxv",disabled:"GuideOverlay_disabled__DZ_eS",skip:"GuideOverlay_skip__ohrNv"}},19089:e=>{e.exports={card:"FillQuiz_card__At68N",attemptRow:"FillQuiz_attemptRow__rSg5E",dot:"FillQuiz_dot__MNbGh",activeDot:"FillQuiz_activeDot__kwHXr",timer:"FillQuiz_timer__mYrxg",sentence:"FillQuiz_sentence__dHu_3",fixed:"FillQuiz_fixed__Sgtg0",blank:"FillQuiz_blank__2eBca",blankActive:"FillQuiz_blankActive__zVNrg",blankWrong:"FillQuiz_blankWrong__ASd7s",filled:"FillQuiz_filled__lj4my",suggestions:"FillQuiz_suggestions__lHfZG",chip:"FillQuiz_chip__fsS7S",btnRow:"FillQuiz_btnRow__uuYvb",hintBtn:"FillQuiz_hintBtn__Ek9n7",checkBtn:"FillQuiz_checkBtn__6wFh7",reveal:"FillQuiz_reveal__GNdBQ"}},30349:e=>{e.exports={overlay:"CustomScenarioModal_overlay__rrefH",card:"CustomScenarioModal_card__e50vG",image:"CustomScenarioModal_image__lzK7_",gradient:"CustomScenarioModal_gradient__VVGd6",textWrap:"CustomScenarioModal_textWrap__HzYa1",title:"CustomScenarioModal_title__x3h42",scenario:"CustomScenarioModal_scenario__FZ9Pj",personaBox:"CustomScenarioModal_personaBox__gSpu_",personaTrait:"CustomScenarioModal_personaTrait___0KC_",personaCatch:"CustomScenarioModal_personaCatch__a6QiY",btnRow:"CustomScenarioModal_btnRow__zGL3b",btn:"CustomScenarioModal_btn__BYp_m",btnLeave:"CustomScenarioModal_btnLeave__LXSgP",disabled:"CustomScenarioModal_disabled__8dWs2"}},32404:e=>{e.exports={container:"MultipleChoiceOptions_container__iiGl6",headerRow:"MultipleChoiceOptions_headerRow__esD8k",headerText:"MultipleChoiceOptions_headerText__TGRmh",disableBtn:"MultipleChoiceOptions_disableBtn__QhypX",explanation:"MultipleChoiceOptions_explanation__Ed6vc",option:"MultipleChoiceOptions_option__4dhVN",correct:"MultipleChoiceOptions_correct__0XfJR",wrong:"MultipleChoiceOptions_wrong__zN0s_",optionText:"MultipleChoiceOptions_optionText__mOMWl",optionTextSelected:"MultipleChoiceOptions_optionTextSelected__RQYx1",resultIcon:"MultipleChoiceOptions_resultIcon__GRiou",bounce:"MultipleChoiceOptions_bounce__xRBFO",bounceScale:"MultipleChoiceOptions_bounceScale__dsfsR"}},51012:e=>{e.exports={iconBtn:"MessageInputFormAI_iconBtn__tnBdg",iconPlaceholder:"MessageInputFormAI_iconPlaceholder__A2KWS",hiddenFile:"MessageInputFormAI_hiddenFile__Pyn_L",frame:"MessageInputFormAI_frame__QjYK9",input:"MessageInputFormAI_input__14hle",sending:"MessageInputFormAI_sending__FM4X3",pulse:"MessageInputFormAI_pulse__2ZsKk",previewOverlay:"MessageInputFormAI_previewOverlay__JRD91",previewCard:"MessageInputFormAI_previewCard__g84iy",previewClose:"MessageInputFormAI_previewClose__90ROs"}},51526:(e,t,a)=>{Promise.resolve().then(a.bind(a,10741))},88440:e=>{e.exports={container:"GramIsleBadge_container__J7odn",pulse:"GramIsleBadge_pulse__yDXtr","pulse-bounce":"GramIsleBadge_pulse-bounce__c8Ha5",count:"GramIsleBadge_count__fRZsZ"}},89928:e=>{e.exports={container:"PersonalChats_container__hgXER",sidebar:"PersonalChats_sidebar__UdJ2W",open:"PersonalChats_open__NoRAH",toggleBtn:"PersonalChats_toggleBtn__WZn4f",navMenu:"PersonalChats_navMenu__Ude7Y",active:"PersonalChats_active__rA5S7",main:"PersonalChats_main__YEl4a",title:"PersonalChats_title__3CL0B",info:"PersonalChats_info__7R7_4",chatList:"PersonalChats_chatList__5WbSP",chatItem:"PersonalChats_chatItem__VWSmP",avatar:"PersonalChats_avatar__sw9Eh",chatInfo:"PersonalChats_chatInfo__9MOjC",nickname:"PersonalChats_nickname__FDwLP",lastMsg:"PersonalChats_lastMsg__KC4p2",time:"PersonalChats_time__QTges"}},98232:e=>{e.exports={container:"ChattingRoom_container__1eLoU",sidebar:"ChattingRoom_sidebar___WI_w",open:"ChattingRoom_open__Vd1yf",header:"ChattingRoom_header__1rFRa",iconBtn:"ChattingRoom_iconBtn__BQmAv",titleArea:"ChattingRoom_titleArea__2_lIT",title:"ChattingRoom_title__BkCNN",chatPane:"ChattingRoom_chatPane__SpScl",inputPane:"ChattingRoom_inputPane__Om26Z",overlay:"ChattingRoom_overlay__xByvR",menuCard:"ChattingRoom_menuCard___Yq_K",closeBtn:"ChattingRoom_closeBtn__oi0gj",menuBtn:"ChattingRoom_menuBtn__CTNU2",row:"ChattingRoom_row__XHr_y",chip:"ChattingRoom_chip__G3v0q",chipOn:"ChattingRoom_chipOn__pg3US",toggle:"ChattingRoom_toggle___zaX8",toggleOn:"ChattingRoom_toggleOn__ou85J",scenarioScroll:"ChattingRoom_scenarioScroll__gEPLt",scenarioChip:"ChattingRoom_scenarioChip__zlGLu",scenarioOn:"ChattingRoom_scenarioOn__Rvmy_",quizCard:"ChattingRoom_quizCard__HiiMM",loading:"ChattingRoom_loading__lysoW"}}},e=>{var t=t=>e(e.s=t);e.O(0,[6407,5832,9066,844,8568,3464,1218,6766,3840,8030,8082,23,8441,1684,7358],()=>t(51526)),_N_E=e.O()}]);