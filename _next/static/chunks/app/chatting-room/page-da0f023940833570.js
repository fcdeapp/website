(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4239],{660:e=>{e.exports={modalOverlay:"BuddyGroupDetailModal_modalOverlay____bbB",modalContainer:"BuddyGroupDetailModal_modalContainer__HmvSb",scrollContainer:"BuddyGroupDetailModal_scrollContainer__xJg0G",closeButton:"BuddyGroupDetailModal_closeButton__DQG9O",closeIcon:"BuddyGroupDetailModal_closeIcon__15dlz",title:"BuddyGroupDetailModal_title__IEdXR",buddyGroupLoadingContainer:"BuddyGroupDetailModal_buddyGroupLoadingContainer__845It",spinner:"BuddyGroupDetailModal_spinner__Bs1Da",spin:"BuddyGroupDetailModal_spin__5yy16",loadingText:"BuddyGroupDetailModal_loadingText__xUruO",errorContainer:"BuddyGroupDetailModal_errorContainer__oZwj1",errorText:"BuddyGroupDetailModal_errorText__LtslI",retryButton:"BuddyGroupDetailModal_retryButton__j4UOx",retryButtonText:"BuddyGroupDetailModal_retryButtonText__Njh3G",detailsContainer:"BuddyGroupDetailModal_detailsContainer__tiiYw",mapContainer:"BuddyGroupDetailModal_mapContainer__JEsaU",map:"BuddyGroupDetailModal_map__yGhxs",mapOverlay:"BuddyGroupDetailModal_mapOverlay__oMARM",mapOverlayText:"BuddyGroupDetailModal_mapOverlayText__EcqMX",headerContainer:"BuddyGroupDetailModal_headerContainer__vxec2",groupImage:"BuddyGroupDetailModal_groupImage___acDI",groupTextContainer:"BuddyGroupDetailModal_groupTextContainer__AqHiv",groupTitle:"BuddyGroupDetailModal_groupTitle__6Wa1f",groupDescription:"BuddyGroupDetailModal_groupDescription__bXxfw",sectionTitle:"BuddyGroupDetailModal_sectionTitle__YQhh2",memberList:"BuddyGroupDetailModal_memberList__Nk43q",memberCard:"BuddyGroupDetailModal_memberCard__i5W_l",memberNickname:"BuddyGroupDetailModal_memberNickname__8Hj5h",goToBuddyPageButton:"BuddyGroupDetailModal_goToBuddyPageButton__KVjav",goToBuddyPageButtonGradient:"BuddyGroupDetailModal_goToBuddyPageButtonGradient__x5cVD",goToBuddyPageTouchable:"BuddyGroupDetailModal_goToBuddyPageTouchable__n9I4C",goToBuddyPageButtonText:"BuddyGroupDetailModal_goToBuddyPageButtonText__IWG2l"}},696:e=>{e.exports={backdrop:"InviteOverlay_backdrop__y90Kw",wrapper:"InviteOverlay_wrapper__b6DHZ",blurLayer:"InviteOverlay_blurLayer__jdiHc",card:"InviteOverlay_card__mfsdM",title:"InviteOverlay_title__wvpMO",list:"InviteOverlay_list__lZ8Vs",empty:"InviteOverlay_empty__71RRe",item:"InviteOverlay_item__K528_",avatar:"InviteOverlay_avatar__qt3ej",name:"InviteOverlay_name__OM9Y2",inviteBtn:"InviteOverlay_inviteBtn__DuI0d",closeBtn:"InviteOverlay_closeBtn__4utFG",devBadge:"InviteOverlay_devBadge__RFjxk"}},10165:e=>{e.exports={wrapper:"MoveQuiz_wrapper__xmCDH",attemptRow:"MoveQuiz_attemptRow__GYL1p",attemptDot:"MoveQuiz_attemptDot__BmieJ",activeDot:"MoveQuiz_activeDot__dnfCz",timer:"MoveQuiz_timer__RpRwi",line:"MoveQuiz_line__FUdLi",suggestionLine:"MoveQuiz_suggestionLine__6cbsK",gap:"MoveQuiz_gap__QReUh",gapSmall:"MoveQuiz_gapSmall__omLKG",gapActive:"MoveQuiz_gapActive__FeBoi",word:"MoveQuiz_word__FXY3S",wordSentence:"MoveQuiz_wordSentence__6Nt08",wordSuggestion:"MoveQuiz_wordSuggestion__9rF1c",dragging:"MoveQuiz_dragging__8z4nT",hintMark:"MoveQuiz_hintMark__NzMqC",btnRow:"MoveQuiz_btnRow__imMzt",hintBtn:"MoveQuiz_hintBtn__vfIrV",checkBtn:"MoveQuiz_checkBtn__R0Ted",reveal:"MoveQuiz_reveal___LT9y",correct:"MoveQuiz_correct__cCr4Y"}},13905:e=>{e.exports={overlay:"GuideOverlay_overlay__EBrXf",svgLayer:"GuideOverlay_svgLayer__is8Yq",backdrop:"GuideOverlay_backdrop__Ew_ae",callout:"GuideOverlay_callout__JfhvZ",title:"GuideOverlay_title__hqH_0",desc:"GuideOverlay_desc__I1BwJ",navRow:"GuideOverlay_navRow__QhU8i",navBtn:"GuideOverlay_navBtn__3Rmxv",disabled:"GuideOverlay_disabled__DZ_eS",skip:"GuideOverlay_skip__ohrNv"}},19089:e=>{e.exports={card:"FillQuiz_card__At68N",attemptRow:"FillQuiz_attemptRow__rSg5E",dot:"FillQuiz_dot__MNbGh",activeDot:"FillQuiz_activeDot__kwHXr",timer:"FillQuiz_timer__mYrxg",sentence:"FillQuiz_sentence__dHu_3",fixed:"FillQuiz_fixed__Sgtg0",blank:"FillQuiz_blank__2eBca",blankActive:"FillQuiz_blankActive__zVNrg",blankWrong:"FillQuiz_blankWrong__ASd7s",filled:"FillQuiz_filled__lj4my",suggestions:"FillQuiz_suggestions__lHfZG",chip:"FillQuiz_chip__fsS7S",btnRow:"FillQuiz_btnRow__uuYvb",hintBtn:"FillQuiz_hintBtn__Ek9n7",checkBtn:"FillQuiz_checkBtn__6wFh7",reveal:"FillQuiz_reveal__GNdBQ"}},29017:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(95155);a(12115);var n=a(35695),i=a(91218),r=a(89760),l=a(7926),o=a(50246),c=a.n(o);let d=e=>{var t;let{buddyGroupId:a,buddyPhoto:o,buddyPhotoMedium:d,buddyPhotoThumbnail:u,activityCountry:h,size:m}=e,{SERVER_URL:g}=(0,r.U)(),{t:p}=(0,i.Bd)(),_=(0,n.useRouter)(),y=null===(t=l.X.find(e=>e.name===h))||void 0===t?void 0:t.flag;return(0,s.jsxs)("div",{onClick:()=>{_.push("/buddyInfo?buddyGroupId=".concat(a))},className:c().container,style:{width:m,height:m},children:[(0,s.jsx)("img",{src:u||d||o||"/assets/buddyDefault.png",alt:"Profile",className:c().profileImage,style:{width:m,height:m,borderRadius:m/2}}),y&&(0,s.jsx)("div",{className:c().flagWrapper,style:{width:m/3+4,height:m/3+4,borderRadius:m/6+2},children:(0,s.jsx)("img",{src:y,alt:"Flag",className:c().flagImage,style:{width:m/3,height:m/3,borderRadius:m/6}})})]})}},30349:e=>{e.exports={overlay:"CustomScenarioModal_overlay__rrefH",card:"CustomScenarioModal_card__e50vG",image:"CustomScenarioModal_image__lzK7_",gradient:"CustomScenarioModal_gradient__VVGd6",textWrap:"CustomScenarioModal_textWrap__HzYa1",title:"CustomScenarioModal_title__x3h42",scenario:"CustomScenarioModal_scenario__FZ9Pj",personaBox:"CustomScenarioModal_personaBox__gSpu_",personaTrait:"CustomScenarioModal_personaTrait___0KC_",personaCatch:"CustomScenarioModal_personaCatch__a6QiY",btnRow:"CustomScenarioModal_btnRow__zGL3b",btn:"CustomScenarioModal_btn__BYp_m",btnLeave:"CustomScenarioModal_btnLeave__LXSgP",disabled:"CustomScenarioModal_disabled__8dWs2"}},32404:e=>{e.exports={container:"MultipleChoiceOptions_container__iiGl6",headerRow:"MultipleChoiceOptions_headerRow__esD8k",headerText:"MultipleChoiceOptions_headerText__TGRmh",disableBtn:"MultipleChoiceOptions_disableBtn__QhypX",explanation:"MultipleChoiceOptions_explanation__Ed6vc",option:"MultipleChoiceOptions_option__4dhVN",correct:"MultipleChoiceOptions_correct__0XfJR",wrong:"MultipleChoiceOptions_wrong__zN0s_",optionText:"MultipleChoiceOptions_optionText__mOMWl",optionTextSelected:"MultipleChoiceOptions_optionTextSelected__RQYx1",resultIcon:"MultipleChoiceOptions_resultIcon__GRiou",bounce:"MultipleChoiceOptions_bounce__xRBFO",bounceScale:"MultipleChoiceOptions_bounceScale__dsfsR"}},48335:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s={en:"/assets/flags/uk-flag.png",es:"/assets/flags/spain-flag.png",zh:"/assets/flags/china-flag.png",hi:"/assets/flags/india-flag.png",fr:"/assets/flags/france-flag.png",ko:"/assets/flags/south-korea-flag.png",ja:"/assets/flags/japan-flag.png",de:"/assets/flags/germany-flag.png",ar:"/assets/flags/saudi-arabia-flag.png",pt:"/assets/flags/portugal-flag.png",ru:"/assets/flags/russia-flag.png",it:"/assets/flags/italy-flag.png",tr:"/assets/flags/turkey-flag.png",nl:"/assets/flags/netherlands-flag.png",pl:"/assets/flags/poland-flag.png",th:"/assets/flags/thailand-flag.png",vi:"/assets/flags/vietnam-flag.png",ms:"/assets/flags/malaysia-flag.png",sv:"/assets/flags/sweden-flag.png",no:"/assets/flags/norway-flag.png",fi:"/assets/flags/finland-flag.png",el:"/assets/flags/greece-flag.png",hu:"/assets/flags/hungary-flag.png",cs:"/assets/flags/czech-republic-flag.png",ro:"/assets/flags/romania-flag.png",da:"/assets/flags/denmark-flag.png",he:"/assets/flags/israel-flag.png",id:"/assets/flags/indonesia-flag.png",uk:"/assets/flags/ukraine-flag.png",fa:"/assets/flags/iran-flag.png",bn:"/assets/flags/bangladesh-flag.png"}},48652:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eS});var s=a(95155),n=a(12115),i=a(47650),r=a(29300),l=a.n(r),o=a(98232),c=a.n(o),d=a(35695),u=a(23464),h=a(14298),m=a(89760),g=a(91218),p=a(31699),_=a(48335);function y(){let e=(0,n.useRef)(null),[t,a]=(0,n.useState)(null),s=(0,n.useRef)(null),i=e=>{null!=s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{s.current=null,e()})},r=()=>{let t=e.current;if(!t)return;let s=t.getBoundingClientRect(),n=s.width,i=s.height,r=s.left+n/2+window.scrollX;a({x:r,y:s.top+i/2+window.scrollY,radius:Math.max(n,i)/2+8})};return(0,n.useLayoutEffect)(()=>(i(r),()=>{null!=s.current&&cancelAnimationFrame(s.current)}),[]),(0,n.useEffect)(()=>{let t=e.current;if(!t)return;let a=()=>i(r),s=new ResizeObserver(()=>i(r));return s.observe(t),window.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",a),i(r),()=>{s.disconnect(),window.removeEventListener("scroll",a),window.removeEventListener("resize",a)}},[e.current]),[e,t]}var v=a(50507),f=a.n(v);let x=e=>e.trim().split(/\s+/),b=(e,t,a)=>{let s=x(e),n=a?x(a):[],i=(e,t)=>{let a=RegExp("\\b".concat(f()(t),"\\b"),"i").exec(e);if(!a||void 0===a.index)return -1;let s=e.slice(0,a.index).trim();return s?s.split(/\s+/).length:0};return t.map(t=>{if(void 0!==t.index&&t.index>=0)return t;if(t.error.trim()){let a=x(t.error),n=s.findIndex((e,n)=>s.slice(n,n+a.length).join(" ")===t.error);if(n>=0)return{...t,index:n};let r=i(e,t.error);return{...t,index:r}}let a=x(t.suggestion);if(n.length){let e=0,i=0;for(;e<s.length&&i<n.length;){if(s[e]===n[i]){e++,i++;continue}if(n.slice(i,i+a.length).join(" ")===t.suggestion.trim())return{...t,index:e};i++}}return{...t,index:s.length}})},C=(e,t)=>{let a=x(e);return[...t].sort((e,t)=>{var a,s;return(null!==(a=e.index)&&void 0!==a?a:0)-(null!==(s=t.index)&&void 0!==s?s:0)}).forEach(e=>{let{error:t,suggestion:s,index:n=0}=e,i=x(s);if(t.trim()){let e=x(t).length;a.splice(n,e,...i)}else a.splice(n,0,...i)}),a};var j=a(66474),w=a(60493),N=a(51012),I=a.n(N),S=a(50802);let k=e=>{let{onSendMessage:t,showPhotoIcon:a=!0,value:i,onChangeText:r,isAIChat:o=!1,isVoiceChatMode:c=!1,onToggleVoiceChatMode:d=()=>{}}=e,{t:u}=(0,g.Bd)(),[h,m]=(0,n.useState)(null),[p,_]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),[f,x]=(0,n.useState)(!1),b=(0,n.useRef)(null),C=(0,n.useRef)(null),j=!!localStorage.getItem("token");(0,n.useEffect)(()=>{let e=C.current;if(!e)return;e.style.height="auto";let t=Math.min(e.scrollHeight,240);e.style.height="".concat(t,"px")},[i]);let w=async()=>{if(y)return;if(!j){x(!0);return}let e=i.trim();if(e||h){v(!0);try{await t({text:e,imageUri:h||void 0}),r(""),m(null),_(!1),C.current&&(C.current.style.height="40px")}catch(e){console.error(e)}finally{v(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[f&&(0,s.jsx)(S.A,{visible:!0,onLogin:()=>{x(!1),window.location.href="/sign-in"},onBrowse:()=>x(!1)}),p&&h&&(0,s.jsx)("div",{className:I().previewOverlay,onClick:()=>_(!1),children:(0,s.jsxs)("div",{className:I().previewCard,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("img",{src:h,alt:"preview",style:{objectFit:"cover",borderRadius:10}}),(0,s.jsx)("button",{className:I().previewClose,onClick:()=>{m(null),_(!1)},children:"✕"})]})}),(0,s.jsxs)("div",{className:I().frame,children:[a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{ref:b,type:"file",accept:"image/*",className:I().hiddenFile,onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&(m(URL.createObjectURL(a)),_(!0))}}),(0,s.jsx)("button",{className:I().iconBtn,disabled:y,onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},children:(0,s.jsx)("img",{src:"/assets/chatInputImage.png",alt:"img",width:24,height:24})})]}):(0,s.jsx)("div",{className:I().iconPlaceholder}),(0,s.jsx)("textarea",{ref:C,className:I().input,value:i,onChange:e=>r(e.target.value),placeholder:u(j?"messageInput.placeholder":"messageInput.login_required"),onKeyDown:e=>{"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),w())},disabled:y}),o&&""===i.trim()?(0,s.jsx)("button",{className:I().iconBtn,onClick:d,disabled:y,children:(0,s.jsx)("img",{src:c?"/assets/chatInputPlayOn.png":"/assets/chatInputPlay.png",alt:"voice",width:24,height:24})}):(0,s.jsx)("button",{className:l()(I().iconBtn,{[I().sending]:y}),onClick:w,disabled:y,children:(0,s.jsx)("img",{src:"/assets/chatInputSend.png",alt:"send",width:24,height:24})})]})]})};var B=a(32649),A=a(660),M=a.n(A);let R=e=>{let{visible:t,onClose:a,buddyGroupId:i}=e,{SERVER_URL:r}=(0,m.U)(),{t:l}=(0,g.Bd)(),o=(0,d.useRouter)(),[c,h]=(0,n.useState)(!1),[p,_]=(0,n.useState)(null),[y,v]=(0,n.useState)(null),f=e=>e?e.startsWith("http")?e:"/assets/".concat(e):null;return((0,n.useEffect)(()=>{(async()=>{if(i&&t){h(!0),v(null);try{let e=(await u.A.get("".concat(r,"/buddy-groups/get/").concat(i))).data;if(!e)throw Error(l("modal.dataNotFoundError"));_({buddyGroupId:e.buddyGroupId,buddyGroupName:e.buddyGroupName,buddyPhoto:f(e.buddyPhoto),buddyPhotoMedium:f(e.buddyPhotoMedium),description:e.description,activityCountry:e.activityCountry,activityCity:e.activityCity,latitude:e.latitude,longitude:e.longitude,members:e.members.map(e=>({...e,profileImage:f(e.profileImage)}))})}catch(e){console.error(l("modal.unknownError"),e),v(e.message||l("modal.errorFetchingInfo"))}finally{h(!1)}}})()},[i,t,r,l]),t)?(0,s.jsx)("div",{className:M().modalOverlay,onClick:a,children:(0,s.jsx)("div",{className:M().modalContainer,onClick:e=>e.stopPropagation(),children:c?(0,s.jsxs)("div",{className:M().buddyGroupLoadingContainer,children:[(0,s.jsx)("div",{className:M().spinner}),(0,s.jsx)("p",{className:M().loadingText,children:l("modal.loadingBuddyInfo")})]}):y?(0,s.jsxs)("div",{className:M().errorContainer,children:[(0,s.jsx)("p",{className:M().errorText,children:y}),(0,s.jsx)("button",{className:M().retryButton,onClick:async()=>{_(null),h(!0);try{let e=(await u.A.get("".concat(r,"/buddy-groups/get/").concat(i))).data;_({buddyGroupId:e.buddyGroupId,buddyGroupName:e.buddyGroupName,buddyPhoto:f(e.buddyPhoto),buddyPhotoMedium:f(e.buddyPhotoMedium),description:e.description,activityCountry:e.activityCountry,activityCity:e.activityCity,latitude:e.latitude,longitude:e.longitude,members:e.members.map(e=>({...e,profileImage:f(e.profileImage)}))}),v(null)}catch(e){console.error(l("modal.unknownError"),e),v(e.message||l("modal.errorFetchingInfo"))}finally{h(!1)}},children:l("modal.retry")})]}):(0,s.jsxs)("div",{className:M().detailsContainer,children:[(0,s.jsxs)("div",{className:M().mapContainer,children:[(0,s.jsx)("div",{className:M().map,children:p&&p.latitude&&p.longitude&&(0,s.jsx)("img",{src:"/assets/map_buddy.png",alt:"map marker",className:M().customMarkerImage})}),(0,s.jsx)("div",{className:M().mapOverlay,children:(0,s.jsx)("p",{className:M().mapOverlayText,children:"".concat((null==p?void 0:p.activityCity)||l("modal.unknownCity"),", ").concat((null==p?void 0:p.activityCountry)||l("modal.unknownCountry"))})})]}),(0,s.jsxs)("div",{className:M().headerContainer,children:[(0,s.jsx)("img",{src:(null==p?void 0:p.buddyPhotoMedium)?p.buddyPhotoMedium:(null==p?void 0:p.buddyPhoto)?p.buddyPhoto:"/assets/groupChat.png",alt:"group",className:M().groupImage}),(0,s.jsxs)("div",{className:M().groupTextContainer,children:[(0,s.jsx)("p",{className:M().groupTitle,children:null==p?void 0:p.buddyGroupName}),(0,s.jsx)("p",{className:M().groupDescription,children:(null==p?void 0:p.description)||l("modal.defaultDescription")})]})]}),(0,s.jsx)("p",{className:M().sectionTitle,children:l("modal.members")}),(0,s.jsx)("div",{className:M().memberList,children:null==p?void 0:p.members.map(e=>(0,s.jsxs)("div",{className:M().memberCard,children:[(0,s.jsx)(B.A,{userId:e.userId,nickname:e.nickname,profileImage:e.profileImage||void 0,countryName:void 0,size:60}),(0,s.jsx)("p",{className:M().memberNickname,children:e.nickname})]},e.userId))}),(0,s.jsx)("div",{className:M().goToBuddyPageButton,children:(0,s.jsx)("div",{className:M().goToBuddyPageButtonGradient,children:(0,s.jsx)("button",{className:M().goToBuddyPageTouchable,onClick:()=>{p?(a(),o.push("/buddy?buddyGroupId=".concat(p.buddyGroupId))):alert("".concat(l("modal.errorAlert"),": ").concat(l("modal.buddyInfoUnavailable")))},children:(0,s.jsx)("p",{className:M().goToBuddyPageButtonText,children:l("modal.navigateToBuddyPage")})})})})]})})}):null};var D=a(66766),G=a(696),T=a.n(G);let O=e=>{let{visible:t,friends:a,chatUserIds:n,onInvite:i,onClose:r,underDevelopment:l}=e,{t:o}=(0,g.Bd)();if(!t)return null;let c=a.filter(e=>!n.includes(e.userId));return(0,s.jsx)("div",{className:T().backdrop,onClick:r,children:(0,s.jsxs)("div",{className:T().wrapper,onClick:e=>e.stopPropagation(),children:[l&&(0,s.jsx)("div",{className:T().blurLayer}),(0,s.jsxs)("div",{className:T().card,children:[(0,s.jsx)("h3",{className:T().title,children:o("invite_friends")}),(0,s.jsxs)("div",{className:T().list,children:[0===c.length&&(0,s.jsx)("p",{className:T().empty,children:o("no_friends_left")}),c.map(e=>(0,s.jsxs)("div",{className:T().item,children:[(0,s.jsx)(D.default,{src:e.profileThumbnail||e.profileImage||"/assets/Anonymous.png",alt:e.nickname,width:40,height:40,className:T().avatar}),(0,s.jsx)("span",{className:T().name,children:e.nickname}),(0,s.jsx)("button",{className:T().inviteBtn,onClick:()=>i(e.userId),children:o("invite")})]},e.userId))]}),(0,s.jsx)("button",{className:T().closeBtn,onClick:r,children:o("close")})]}),l&&(0,s.jsx)("div",{className:T().devBadge,children:o("under_development")})]})})};var z=a(10351),P=a(32404),E=a.n(P);let L=e=>{let{choices:t,onSelect:a,onDisable:i,onClose:r}=e,{t:o}=(0,g.Bd)(),[c,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(!1),m=e=>{c||(d(e.text),h(!0),a(e),setTimeout(()=>{r()},3600))};return(0,n.useEffect)(()=>{if(!u)return;let e=setTimeout(()=>h(!1),240);return()=>clearTimeout(e)},[u]),(0,s.jsxs)("div",{className:E().container,children:[(0,s.jsxs)("div",{className:E().headerRow,children:[(0,s.jsx)("span",{className:E().headerText,children:o("mcq_prompt","Pick the grammatically correct sentence")}),(0,s.jsx)("button",{className:E().disableBtn,onClick:i,children:o("disable_quiz","Turn off")})]}),t.map((e,t)=>{let a=c===e.text,i=a&&e.isCorrect,r=a&&!e.isCorrect;return(0,s.jsxs)(n.Fragment,{children:[r&&e.explanation&&(0,s.jsx)("p",{className:E().explanation,children:e.explanation}),(0,s.jsxs)("button",{className:l()(E().option,a&&(i?E().correct:E().wrong),a&&u&&E().bounce),disabled:!!c,onClick:()=>m(e),children:[(0,s.jsx)("span",{className:l()(E().optionText,a&&E().optionTextSelected),children:e.text}),a&&(0,s.jsx)("span",{className:E().resultIcon,children:i?(0,s.jsx)(z.YrT,{size:18,color:"#31A24C"}):(0,s.jsx)(z.yGN,{size:18,color:"#D8315B"})})]})]},"opt-".concat(t))})]})};var F=a(47937),U=a(62108),W=a(88440),Q=a.n(W);let q=e=>e.replace(/[_-]+/g," ").replace(/\w+/g,e=>e[0].toUpperCase()+e.slice(1)).replace(/\s+/g,""),H=e=>{let{count:t,accent:a="#6366F1",icon:i="bookmark",size:r=28}=e,[l,o]=(0,n.useState)(!1),c=(0,n.useRef)(t);(0,n.useEffect)(()=>{if(t>c.current){o(!0);let e=setTimeout(()=>o(!1),600);return()=>clearTimeout(e)}c.current=t},[t]);let d=F[q(i)]||U.A;return(0,s.jsxs)("span",{className:"".concat(Q().container," ").concat(l?Q().pulse:""),style:{height:r,paddingLeft:.5*r,paddingRight:.5*r,borderRadius:r/2,color:a,boxShadow:"0 2px 4px ".concat(a,"33")},children:[(0,s.jsx)(d,{size:.55*r,color:a,style:{marginRight:6,flexShrink:0}}),(0,s.jsx)("span",{className:Q().count,style:{fontSize:.5*r+2,color:a},children:t})]})};var J=a(13905),Y=a.n(J);let X=e=>{let{visible:t,steps:a,storageKey:r,onClose:o,onStepChange:c}=e,{t:d}=(0,g.Bd)(),[u,h]=(0,n.useState)(0),m="hidden"===localStorage.getItem(r),p=t&&!m&&a.length>0;if((0,n.useEffect)(()=>{u>a.length-1&&h(0)},[a.length,u]),(0,n.useEffect)(()=>{p&&(null==c||c(u))},[u,c,p]),!p)return null;let _=a[u],{innerWidth:y,innerHeight:v}=window,f=_.target.y+_.target.radius+106,x=_.target.y-_.target.radius-150,b=f+150+106>v?Math.max(x,106):f,C="undefined"!=typeof document?document.getElementById("__next"):null;if(!C)return null;let j=(0,n.useCallback)(()=>{localStorage.setItem(r,"hidden"),o()},[o,r]);return(0,i.createPortal)((0,s.jsxs)("div",{className:Y().overlay,children:[(0,s.jsxs)("svg",{className:Y().svgLayer,width:y,height:v,"aria-hidden":!0,focusable:"false",children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("mask",{id:"guide-mask",children:[(0,s.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"white"}),(0,s.jsx)("circle",{cx:_.target.x,cy:c?106+_.target.radius:_.target.y,r:_.target.radius,fill:"black"})]})}),(0,s.jsx)("rect",{className:Y().backdrop,x:"0",y:"0",width:"100%",height:"100%",mask:"url(#guide-mask)"})]}),(0,s.jsxs)("div",{className:Y().callout,style:{top:b},children:[(0,s.jsx)("h3",{className:Y().title,children:d("".concat(_.key,".title"))}),(0,s.jsx)("p",{className:Y().desc,children:d("".concat(_.key,".desc"))}),(0,s.jsxs)("div",{className:Y().navRow,children:[(0,s.jsx)("button",{className:l()(Y().navBtn,0===u&&Y().disabled),disabled:0===u,onClick:()=>h(e=>Math.max(0,e-1)),children:d("guide.prev")}),(0,s.jsx)("button",{className:Y().navBtn,onClick:()=>u>=a.length-1?o():h(e=>e+1),children:d(u===a.length-1?"guide.finish":"guide.next")})]}),(0,s.jsx)("button",{className:Y().skip,onClick:j,children:d("guide.dontShowAgain")})]})]}),C)};var K=a(30349),Z=a.n(K);let V=e=>{let{visible:t,imageUri:a,scenarioText:r,persona:o,onClose:c,onLeave:d,onShare:u,chatId:h}=e,{t:m}=(0,g.Bd)(),[p,_]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!1),[f,x]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{x("true"===localStorage.getItem("shared_chat_".concat(h)))},[h]),!t)return null;let b=async()=>{if(!p){_(!0);try{await d()}finally{_(!1)}}},C=async()=>{if(!y&&!f){v(!0);try{await u(),localStorage.setItem("shared_chat_".concat(h),"true"),x(!0)}catch(e){console.error(e)}finally{v(!1)}}},j="undefined"!=typeof document?document.getElementById("__next"):void 0;return j?(0,i.createPortal)((0,s.jsx)("div",{className:Z().overlay,onClick:c,children:(0,s.jsxs)("div",{className:Z().card,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:Z().image,style:{backgroundImage:"url(".concat(a,")")},children:[(0,s.jsx)("div",{className:Z().gradient}),(0,s.jsxs)("div",{className:Z().textWrap,children:[(0,s.jsx)("h3",{className:Z().title,children:m("scenario")}),(0,s.jsx)("p",{className:Z().scenario,children:r}),o&&(0,s.jsxs)("div",{className:Z().personaBox,children:[o.personality&&(0,s.jsx)("p",{className:Z().personaTrait,children:o.personality}),o.speakingStyle&&(0,s.jsx)("p",{className:Z().personaTrait,children:o.speakingStyle}),o.catchPhrase&&(0,s.jsx)("p",{className:Z().personaCatch,children:o.catchPhrase})]})]})]}),(0,s.jsxs)("div",{className:Z().btnRow,children:[(0,s.jsx)("button",{className:l()(Z().btnLeave,{[Z().disabled]:p}),onClick:b,disabled:p,children:m("leave_custom_session")}),f?(0,s.jsx)("button",{className:l()(Z().btn,Z().disabled),disabled:!0,children:m("shared_label")}):(0,s.jsx)("button",{className:l()(Z().btn,{[Z().disabled]:y}),onClick:C,disabled:y,children:m("share")})]})]})}),j):null};var $=a(10165),ee=a.n($);let et=RegExp("\\p{Emoji_Presentation}","gu"),ea=e=>e.replace(et,"").trim()||null,es=e=>e.split(" ").map(ea).filter(e=>!!e),en=e=>"".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0")),ei=e=>{let{sentence:t,issues:a,started:i,learnLanguage:r,onSubmit:o}=e,{t:c}=(0,g.Bd)(),d=es(t),[u,h]=(0,n.useState)(d),[m,p]=(0,n.useState)([]),[_,y]=(0,n.useState)(null),[v,f]=(0,n.useState)(3),[x,j]=(0,n.useState)(0),[w,N]=(0,n.useState)(new Set),[I,S]=(0,n.useState)(0),[k,B]=(0,n.useState)(null),[A,M]=(0,n.useState)(!1),R=(0,n.useRef)(null);(0,n.useEffect)(()=>{i&&!R.current&&(R.current=Date.now());let e=window.setInterval(()=>{R.current&&S(Math.floor((Date.now()-R.current)/1e3))},1e3);return()=>window.clearInterval(e)},[i]),(0,n.useEffect)(()=>{p(a.flatMap(e=>{let t=es(e.error);return es(e.suggestion).filter(e=>!t.includes(e))}))},[a]);let D=(e,t,a)=>JSON.stringify({src:e,idx:t,word:a}),G=(e,t,a)=>s=>{s.dataTransfer.setData("text/plain",D(e,t,a)),s.dataTransfer.effectAllowed="move",y("".concat(e,"-").concat(t,"-").concat(a))},T=()=>y(null),O=(e,t)=>a=>{a.preventDefault();let s=a.dataTransfer.getData("text/plain");if(!s)return;let{src:n,idx:i,word:r}=JSON.parse(s);if(n===e&&i===t)return;let l=[...u],o=[...m];"sentence"===n?l.splice(i,1):o.splice(i,1),"sentence"===e?l.splice(t,0,r):o.splice(t,0,r),h(l),p(o),y(null)},z=e=>e.preventDefault(),P=C(t,b(t,a)),E=(0,n.useCallback)(()=>{let e=new Set;return P.forEach((t,a)=>{u[a]!==t&&e.add(a)}),e},[u,P]),L=e=>{let{w:t,src:a,idx:n}=e;return(0,s.jsxs)("span",{draggable:!0,onDragStart:G(a,n,t),onDragEnd:T,className:l()(ee().word,{[ee().wordSentence]:"sentence"===a,[ee().wordSuggestion]:"suggested"===a,[ee().dragging]:_==="".concat(a,"-").concat(n,"-").concat(t)}),children:[t,w.has(n)&&"sentence"===a&&(0,s.jsx)("span",{className:ee().hintMark,children:"?"})]})};return(0,s.jsxs)("div",{className:ee().wrapper,children:[(0,s.jsxs)("div",{className:ee().attemptRow,children:[[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("span",{className:l()(ee().attemptDot,{[ee().activeDot]:t<v})},t)),(0,s.jsx)("span",{className:ee().timer,children:en(I)})]}),(0,s.jsxs)("div",{className:ee().line,onDragOver:z,children:[u.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("span",{className:l()(ee().gap,{[ee().gapActive]:_&&_.startsWith("sentence")&&w.has(t)}),onDragOver:z,onDrop:O("sentence",t)}),(0,s.jsx)(L,{w:u[t],src:"sentence",idx:t})]},"gap-s-".concat(t))),(0,s.jsx)("span",{className:ee().gap,onDragOver:z,onDrop:O("sentence",u.length)})]}),(0,s.jsxs)("div",{className:ee().suggestionLine,onDragOver:z,children:[m.map((e,t)=>(0,s.jsxs)(n.Fragment,{children:[(0,s.jsx)("span",{className:ee().gapSmall,onDragOver:z,onDrop:O("suggested",t)}),(0,s.jsx)(L,{w:e,src:"suggested",idx:t})]},"gap-t-".concat(t))),(0,s.jsx)("span",{className:ee().gapSmall,onDragOver:z,onDrop:O("suggested",m.length)})]}),(0,s.jsxs)("div",{className:ee().btnRow,children:[(0,s.jsx)("button",{className:ee().hintBtn,onClick:()=>{j(e=>e+1),N(E())},children:c("hint_button")}),(0,s.jsx)("button",{className:ee().checkBtn,onClick:()=>{if(v<=0)return;let e=u.join(" "),t=e===P.join(" ");M(t),t?o(e):(alert(c("try_again")),v-1==0&&B(P.join(" "))),f(e=>e-1)},children:c("check_answer_button")})]}),k&&(0,s.jsx)("p",{className:ee().reveal,children:c("reveal_answer",{answer:k})}),A&&(0,s.jsx)("p",{className:ee().correct,children:c("correct_answer")})]})};var er=a(19089),el=a.n(er);let eo=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ec=(e,t)=>{let a=e;for(let{error:e,suggestion:s}of t){let t=RegExp(eo(e),"g");a=a.replace(t,s)}return a.replace(/\s+/g," ").trim().split(" ")},ed=(e,t)=>{let a=e.trim().split(" "),s=[];t.forEach(e=>{let{suggestion:t}=e;return s.push(...t.trim().split(" "))});let n=[],i=0;for(;i<a.length;){let e=t.find(e=>{let{error:t}=e,s=t.split(" ");return a.slice(i,i+s.length).join(" ").toLowerCase()===t.toLowerCase()});if(e){let t=e.suggestion.trim().split(" ").length;for(let e=0;e<t;e++)n.push("");i+=e.error.trim().split(" ").length}else n.push(a[i]),i+=1}let r=n.map((e,t)=>""===e?t:-1).filter(e=>e>=0);return{initialWords:n,blankIndices:r,suggestionWords:s}},eu=e=>"".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0")),eh=e=>{let{sentence:t,issues:a,learnLanguage:i,started:r,onSubmit:o}=e,{t:c}=(0,g.Bd)(),{initialWords:d,blankIndices:u,suggestionWords:h}=(0,n.useMemo)(()=>ed(t,a),[t,a]),[m,p]=(0,n.useState)(d),[_,y]=(0,n.useState)(()=>[...h].sort(()=>Math.random()-.5)),[v,f]=(0,n.useState)(3),[x,b]=(0,n.useState)(0),[C,j]=(0,n.useState)(new Set),[w,N]=(0,n.useState)(null),[I,S]=(0,n.useState)(null),k=(0,n.useRef)(null),[B,A]=(0,n.useState)(0);(0,n.useEffect)(()=>{r&&!k.current&&(k.current=Date.now());let e=window.setInterval(()=>{k.current&&A(Math.floor((Date.now()-k.current)/1e3))},1e3);return()=>window.clearInterval(e)},[r]);let M=(e,t)=>JSON.stringify({w:e,idx:t}),R=(e,t)=>a=>{a.dataTransfer.setData("text/plain",M(e,t)),a.dataTransfer.effectAllowed="move"},D=e=>e.preventDefault(),G=e=>t=>{t.preventDefault();let a=t.dataTransfer.getData("text/plain");if(!a)return;let{w:s,idx:n}=JSON.parse(a);m[e]||(p(t=>{let a=[...t];return a[e]=s,a}),y(e=>e.filter((e,t)=>t!==n)),N(null))},T=(e,t)=>{let a=u.find(e=>""===m[e]);void 0!==a&&(p(t=>{let s=[...t];return s[a]=e,s}),y(e=>e.filter((e,a)=>a!==t)))},O=e=>{if(!u.includes(e))return;let t=m[e];t&&(p(t=>{let a=[...t];return a[e]="",a}),y(e=>[...e,t]))},z=(0,n.useMemo)(()=>ec(t,a),[t,a]);return(0,s.jsxs)("div",{className:el().card,children:[(0,s.jsxs)("div",{className:el().attemptRow,children:[[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("span",{className:l()(el().dot,{[el().activeDot]:t<v})},t)),(0,s.jsx)("span",{className:el().timer,children:eu(B)})]}),(0,s.jsx)("div",{className:el().sentence,children:m.map((e,t)=>u.includes(t)?(0,s.jsx)("div",{className:l()(el().blank,{[el().blankActive]:w===t,[el().blankWrong]:C.has(t)}),onClick:()=>O(t),onDragOver:D,onDragEnter:()=>N(t),onDragLeave:()=>N(null),onDrop:G(t),children:e&&(0,s.jsx)("span",{className:el().filled,children:e})},"blank-".concat(t)):(0,s.jsx)("span",{className:el().fixed,children:e},"fixed-".concat(t)))}),(0,s.jsx)("div",{className:el().suggestions,children:_.map((e,t)=>(0,s.jsx)("span",{draggable:!0,onDragStart:R(e,t),onClick:()=>T(e,t),className:el().chip,children:e},"sug-".concat(t)))}),(0,s.jsxs)("div",{className:el().btnRow,children:[(0,s.jsx)("button",{className:el().hintBtn,onClick:()=>{b(e=>e+1);let e=new Set;u.forEach(t=>{m[t]&&m[t]!==z[t]&&e.add(t)}),j(e)},children:c("hint_button")}),(0,s.jsx)("button",{className:el().checkBtn,onClick:()=>{let e=m.length===z.length&&m.every((e,t)=>e===z[t]);f(e=>e-1),e?(alert(c("well_done")),o(m.join(" "))):(alert(c("try_again")),v-1==0&&S(z.join(" ")))},children:c("check_answer_button")})]}),I&&(0,s.jsx)("p",{className:el().reveal,children:c("reveal_answer",{answer:I})})]})};var em=a(29017),eg=a(66843),ep=a.n(eg),e_=a(90070),ey=a(7768);let ev=[{key:"personal",i18n:"personal"},{key:"buddy",i18n:"buddy"},{key:"region",i18n:"region"},{key:"search",i18n:"search.search"}],ef={get:e=>{try{return window.localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){}}};function ex(e){let{open:t,onClose:a,onSelectChat:i}=e,{SERVER_URL:r}=(0,m.U)(),{t:o}=(0,g.Bd)(),c=(0,d.useRouter)(),[h,p]=(0,n.useState)("personal"),[_,v]=(0,n.useState)(!0),[f,x]=(0,n.useState)(!1),[b,C]=(0,n.useState)(""),[j,w]=(0,n.useState)([]),[N,I]=(0,n.useState)([]),[S,k]=(0,n.useState)(!0),[A,M]=y(),[R,D]=y(),[G,T]=y(),[O,z]=y(),[P,E]=y(),[L,F]=(0,n.useState)(!1),U="overlay_chatlist_web_v1",[W,Q]=(0,n.useState)(""),q=(0,n.useRef)(null),H=(0,n.useMemo)(()=>[{tgt:M,key:"chatGuide.step1"},{tgt:D,key:"chatGuide.step2"},{tgt:T,key:"chatGuide.step3"},{tgt:z,key:"chatGuide.step4"},{tgt:E,key:"chatGuide.step5"}].filter(e=>{let{tgt:t}=e;return!!t}).map(e=>{let{tgt:t,key:a}=e;return{key:a,target:t}}),[M,D,T,z,E]);(0,n.useEffect)(()=>{let e=ef.get("token");x(!!e),(async()=>{if(!e){v(!1);return}try{var t;let a=await u.A.get("".concat(r,"/users/me"),{headers:{Authorization:"Bearer ".concat(e)}});C((null===(t=a.data)||void 0===t?void 0:t.userId)||"")}catch(e){console.error(e)}finally{v(!1)}})()},[r]),(0,n.useEffect)(()=>{null===ef.get(U)&&F(!0)},[]);let J=async()=>{let e=ef.get("token");if(!e)return[];let{data:t}=await u.A.get("".concat(r,"/chats/get-with-ai"),{headers:{Authorization:"Bearer ".concat(e)}}),{chatSummaries:a,aiSummary:s}=t,n=a.map(e=>({...e,userDetails:e.userDetails.map(e=>({...e,profileImage:e.profileImage||null,profileThumbnail:e.profileThumbnail||null}))}));return s&&n.unshift({_id:"brody-ai",userIds:["brody-ai"],userDetails:[{userId:"brody-ai",nickname:"Brody (AI Chat)",profileImage:"/assets/AIProfile.png"}],lastMessage:s.lastMessage,lastMessageTime:s.lastMessageTime,type:"personal",title:"Brody (AI)"}),n},Y=async()=>{let e=ef.get("token");if(!e)return[];let{data:t}=await u.A.get("".concat(r,"/ai-chat/sessions"),{headers:{Authorization:"Bearer ".concat(e)}});return(t.sessions||[]).filter(e=>"string"==typeof e.otherUserId&&e.otherUserId.startsWith("custom-ai-")).map(e=>({_id:e.sessionId,userIds:[e.otherUserId],userDetails:[{userId:e.otherUserId,nickname:e.assistantName||"AI Chat",profileImage:"/assets/AIProfile.png"}],lastMessage:e.lastMessage,lastMessageTime:e.lastMessageTime,type:"personal",title:e.assistantName||"AI Chat"}))},K=async()=>{var e;let t=ef.get("token");return t?((null===(e=(await u.A.get("".concat(r,"/buddy-groups/user-groups"),{headers:{Authorization:"Bearer ".concat(t)}})).data)||void 0===e?void 0:e.buddyGroups)||[]).map(e=>({...e,buddyPhoto:e.buddyPhoto,buddyPhotoMedium:e.buddyPhotoMedium,buddyPhotoThumbnail:e.buddyPhotoThumbnail})):[]};(0,n.useEffect)(()=>{f&&(async()=>{try{v(!0);let[e,t,a]=await Promise.all([J(),Y(),K()]),s=new Set(t.map(e=>e._id)),n=[...t,...e.filter(e=>!s.has(e._id))];w(n),I(a)}catch(e){console.error(e)}finally{v(!1),k(!1)}})()},[f]);let Z=async()=>{if(!ef.get("token")){Q(o("login_required"));return}let e=ef.get("cachedDistrict");e&&Q(e);let t=navigator.geolocation;if(!t){Q(o("location_not_available"));return}let a=window.setTimeout(()=>{q.current=null,console.warn("Geolocation timeout")},2e4);q.current=a,t.getCurrentPosition(async e=>{q.current&&(clearTimeout(q.current),q.current=null);let{latitude:t,longitude:a}=e.coords;try{let e=await (0,ey.LF)(t,a,r);(null==e?void 0:e.city)?(Q(e.city),ef.set("cachedDistrict",e.city),ef.set("cachedLocation",JSON.stringify({latitude:t,longitude:a}))):Q("Unknown City")}catch(e){console.error(e),Q("Unknown City")}},e=>{q.current&&(clearTimeout(q.current),q.current=null),console.error(e),Q(o("location_permission_denied"))},{enableHighAccuracy:!0})};(0,n.useEffect)(()=>{"region"!==h||W||Z()},[h]);let V=(0,n.useMemo)(()=>j.some(e=>e.userIds.includes("brody-ai")),[j]),$=e=>{if("group"===e.type){let t="(".concat(e.userDetails.length,")");return e.title?"".concat(e.title," ").concat(t):"group ".concat(t)}let t=e.userDetails.find(e=>e.userId!==b);return t?t.nickname:o("unknown")},ee=(e,t)=>{if("group"===e.type)return"/assets/groupChat.png";let a=e.userDetails.find(e=>e.userId!==t);return(null==a?void 0:a.profileImage)||"/assets/Annonymous.png"};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:l()(ep().backdrop,{[ep().backdropOpen]:t}),onClick:a}),(0,s.jsxs)("aside",{className:l()(ep().panel,{[ep().panelOpen]:t}),"aria-hidden":!t,children:[(0,s.jsxs)("div",{className:ep().header,children:[(0,s.jsx)("button",{className:ep().iconBtn,onClick:a,"aria-label":"Close",children:(0,s.jsx)("img",{src:"/assets/BackIcon.png",alt:"close",width:24,height:24})}),(0,s.jsx)("div",{className:ep().headerTitle,children:o("chatting_list")}),(0,s.jsx)("button",{className:ep().iconBtn,onClick:()=>{if(!f)return null==a?void 0:a();c.push("/friend-list")},"aria-label":"New chat",children:(0,s.jsx)("img",{src:"/assets/newChat.png",alt:"new",width:24,height:24})})]}),(0,s.jsxs)("div",{ref:A,className:ep().tabs,children:[(0,s.jsx)("div",{className:ep().slider,style:{"--tab-index":ev.findIndex(e=>e.key===h)}}),ev.map(e=>(0,s.jsx)("button",{className:l()(ep().tabBtn,{[ep().tabBtnActive]:h===e.key}),onClick:()=>{if("search"===e.key){c.push("/search");return}p(e.key)},children:o(e.i18n)},e.key))]}),(0,s.jsxs)("div",{className:ep().content,children:["personal"===h&&(0,s.jsxs)("div",{className:ep().list,children:[!V&&(0,s.jsxs)("div",{ref:R,className:ep().item,children:[(0,s.jsx)("img",{className:ep().avatar,src:"/assets/AIProfile.png",alt:"AI",width:48,height:48}),(0,s.jsxs)("div",{className:ep().itemMain,onClick:()=>i({type:"ai",otherUserId:"brody-ai"}),children:[(0,s.jsx)("div",{className:ep().nickname,children:"Brody (AI)"}),(0,s.jsx)("div",{className:ep().message,children:o("start_ai_chat")})]}),(0,s.jsx)("div",{className:ep().time,children:(0,e_.S)(new Date().toISOString(),o)})]}),(0,s.jsx)("div",{ref:G,children:_?(0,s.jsx)("div",{className:ep().spinner}):0===j.length?(0,s.jsxs)("div",{className:ep().empty,children:[(0,s.jsx)("img",{src:"/assets/no_globe.png",alt:"",width:120,height:120}),(0,s.jsx)("div",{className:ep().emptyText,children:o("no_personal_chats")}),(0,s.jsxs)("button",{className:ep().ctaBtn,onClick:()=>c.push("/search"),children:[(0,s.jsx)("img",{src:"/assets/plus-icon.png",alt:"",width:16,height:16}),(0,s.jsx)("span",{children:o("search_friends")})]})]}):j.map(e=>{let t=e.userIds.includes("brody-ai")||e.userIds.some(e=>e.startsWith("custom-ai-")),a=e.userIds.find(e=>e!==b)||e.userIds[0]||"unknown";return(0,s.jsxs)("div",{className:ep().item,onClick:()=>{if(e.userIds.includes("brody-ai")){i({type:"ai",otherUserId:"brody-ai"});return}if(e.userIds.some(e=>e.startsWith("custom-ai-"))){i({type:"custom-ai",otherUserId:a,chatId:e._id});return}i({type:"personal",chatId:e._id,otherUserId:a})},children:[t?(0,s.jsx)("img",{className:ep().avatar,src:"/assets/AIProfile.png",alt:"AI",width:48,height:48}):(0,s.jsx)(B.A,{userId:a,profileImage:ee(e,b),size:48}),(0,s.jsxs)("div",{className:ep().itemMain,children:[(0,s.jsx)("div",{className:ep().nickname,children:$(e)}),(0,s.jsx)("div",{className:ep().message,children:e.lastMessage?e.lastMessage.includes("https://")?o("click_view_photo"):e.lastMessage:o("first_chat_prompt")})]}),(0,s.jsx)("div",{className:ep().time,children:(0,e_.S)(e.lastMessageTime,o)})]},e._id)})})]}),"buddy"===h&&(0,s.jsx)("div",{ref:O,className:ep().list,children:S?(0,s.jsx)("div",{className:ep().spinner}):0===N.length?(0,s.jsxs)("div",{className:ep().empty,children:[(0,s.jsx)("img",{src:"/assets/no_globe.png",alt:"",width:120,height:120}),(0,s.jsx)("div",{className:ep().emptyText,children:o("no_buddy_groups")}),(0,s.jsx)(eb,{})]}):N.map(e=>(0,s.jsxs)("div",{className:ep().item,onClick:()=>i({type:"group",buddyGroupId:e.buddyGroupId}),children:[(0,s.jsx)(em.A,{buddyGroupId:e.buddyGroupId,buddyPhoto:e.buddyPhoto||"",buddyPhotoMedium:e.buddyPhotoMedium||"",buddyPhotoThumbnail:e.buddyPhotoThumbnail||"",activityCountry:e.activityCountry||"",size:48}),(0,s.jsxs)("div",{className:ep().itemMain,children:[(0,s.jsx)("div",{className:ep().nickname,children:e.buddyGroupName}),(0,s.jsx)("div",{className:ep().message,children:e.lastMessage?e.lastMessage.includes("https://")?o("view_photo"):e.lastMessage:o("no_new_conversations")})]}),(0,s.jsx)("div",{className:ep().time,children:e.lastMessageTime?(0,e_.S)(e.lastMessageTime,o):""})]},e.buddyGroupId))}),"region"===h&&(0,s.jsx)("div",{ref:P,className:ep().regionSection,children:(0,s.jsxs)("div",{className:ep().regionHero,children:[(0,s.jsx)("img",{src:"/assets/foxBackground.png",alt:""}),(0,s.jsx)("div",{className:ep().regionOverlay}),(0,s.jsxs)("div",{className:ep().regionContent,children:[(0,s.jsx)("div",{className:ep().regionTitle,children:W?"".concat(W," ").concat(o("chat_room")):o("regional_chat")}),(0,s.jsx)("div",{className:ep().regionDesc,children:o("join_regional_chat_desc")}),(0,s.jsx)("button",{className:ep().ctaPrimary,disabled:!W||"Unknown City"===W||W===o("location_permission_denied"),onClick:()=>i({type:"region",district:W||"Unknown City"}),children:o("enter")})]})]})})]}),(0,s.jsx)(X,{visible:L&&H.length>0,steps:H,storageKey:U,onClose:()=>F(!1)})]})]})}function eb(){let{t:e}=(0,g.Bd)(),t=(0,d.useRouter)();return(0,s.jsxs)("button",{className:ep().ctaBtn,onClick:()=>{t.push("/posting")},children:[(0,s.jsx)("img",{src:"/assets/plus-icon.png",alt:"",width:16,height:16}),(0,s.jsx)("span",{children:e("create_buddy_group")})]})}let eC=["en","es","fr","zh","ja","ko","ar","de","hi","it","pt","ru"],ej=[{id:"cafe"},{id:"hotel"},{id:"directions"},{id:"grocery"},{id:"clothes"},{id:"interview"},{id:"meeting"},{id:"call"},{id:"hospital"},{id:"emergency"},{id:"dating"},{id:"party"}],ew={en:["Hi there! Who are you and what's happening right now?","Hello! Where am I, and who are you?","Hey! Who are you? What's the situation?"],es:["\xa1Hola! \xbfQui\xe9n eres y qu\xe9 est\xe1 pasando ahora?","\xa1Buenas! \xbfD\xf3nde estoy y qui\xe9n eres t\xfa?","\xa1Hey! \xbfQui\xe9n eres y cu\xe1l es la situaci\xf3n?"],fr:["Salut ! Qui es-tu et que se passe-t-il ?","Bonjour ! O\xf9 suis-je et qui es-tu ?","Coucou ! Qui es-tu ? Quelle est la situation ?"],zh:["你好！你是谁？现在是什么情况？","嗨！我在哪里？你是谁？","嘿！你是谁？发生了什么事？"],ja:["こんにちは！あなたは誰？今はどんな状況？","やあ！ここはどこで、あなたは誰？","ねえ！あなたは誰？今どういう状況？"],ko:["안녕! 넌 누구야? 지금 어떤 상황이야?","안녕하세요! 여기가 어디고 당신은 누구죠?","반가워! 지금 상황이 어떻게 돼?"],ar:["مرحباً! من أنت وما الذي يحدث الآن؟","أهلًا! أين أنا ومن تكون؟","يا هلا! من أنت؟ وما الوضع؟"],de:["Hi! Wer bist du und was passiert gerade?","Hallo! Wo bin ich und wer bist du?","Hey! Wer bist du? Was ist hier los?"],hi:["नमस्ते! आप कौन हैं और अभी क्या हो रहा है?","हैलो! मैं कहाँ हूँ और आप कौन हैं?","अरे! आप कौन हैं? स्थिति क्या है?"],it:["Ciao! Chi sei e cosa sta succedendo adesso?","Salve! Dove sono e chi sei tu?","Ehi! Chi sei? Qual \xe8 la situazione?"],pt:["Oi! Quem \xe9 voc\xea e o que est\xe1 acontecendo agora?","Ol\xe1! Onde estou e quem \xe9 voc\xea?","Ei! Quem \xe9 voc\xea? Qual \xe9 a situa\xe7\xe3o?"],ru:["Привет! Кто ты и что сейчас происходит?","Здравствуйте! Где я и кто вы?","Эй! Кто ты? Какая сейчас ситуация?"]},eN=e=>t=>e("ai-rt.banner.".concat(t));function eI(){var e;let{SERVER_URL:t,FEATURE_UNDER_DEV:a}=(0,m.U)(),{t:r}=(0,g.Bd)(),o=(0,d.useRouter)(),v=(0,d.useSearchParams)(),[f,x]=(0,n.useState)(!1),N=v.get("otherUserId")||void 0,I=v.get("buddyGroupId")||void 0,S=v.get("chatId")||void 0,B=v.get("district")||void 0,[A,M]=(0,n.useState)(""),[D,G]=(0,n.useState)(null!=S?S:null),[T,z]=(0,n.useState)(null),[P,E]=(0,n.useState)("friend"),[F,U]=(0,n.useState)(""),[W,Q]=(0,n.useState)([]),[q,J]=(0,n.useState)(!1),[Y,K]=(0,n.useState)(!0),[Z,$]=(0,n.useState)(null),[ee,et]=(0,n.useState)(!1),[ea,es]=(0,n.useState)(!1),[en,er]=(0,n.useState)(!1),[el,eo]=(0,n.useState)(!1),[ec,ed]=(0,n.useState)(null),[eu,eg]=(0,n.useState)(!1),[ep,e_]=(0,n.useState)(!1),[ey,ev]=(0,n.useState)(!1),[ef,eb]=(0,n.useState)({}),[eI,eS]=(0,n.useState)({}),[ek,eB]=(0,n.useState)(0),[eA,eM]=(0,n.useState)(0),[eR,eD]=(0,n.useState)("B1"),[eG,eT]=(0,n.useState)("none"),[eO,ez]=(0,n.useState)(!1),[eP,eE]=(0,n.useState)(!1),[eL,eF]=(0,n.useState)(!1),[eU,eW]=(0,n.useState)("cafe"),[eQ,eq]=(0,n.useState)(null),[eH,eJ]=(0,n.useState)(!0),[eY,eX]=(0,n.useState)(null),[eK,eZ]=(0,n.useState)("en"),[eV,e$]=(0,n.useState)(!1),[e0,e1]=(0,n.useState)(["en"]),[e2,e4]=(0,n.useState)(!1),[e6,e3]=(0,n.useState)(!0),[e8,e5]=(0,n.useState)(!1),[e9,e7]=(0,n.useState)(0),[te,tt]=(0,n.useState)(""),ta=!N||"brody-ai"===N||N.startsWith("custom-ai"),ts=!!(null==N?void 0:N.startsWith("custom-ai")),tn=eP&&eL,ti=!!B&&!I&&!N,[tr,tl]=(0,n.useState)(null),[to,tc]=(0,n.useState)(null),[td,tu]=(0,n.useState)(null),[th,tm]=(0,n.useState)(null),[tg,tp]=(0,n.useState)(!1),[t_,ty]=y(),[tv,tf]=y(),[tx,tb]=y(),[tC,tj]=y(),[tw,tN]=y(),[tI,tS]=y(),[tk,tB]=y(),[tA,tM]=(0,n.useState)(!1),tR="chatRoomGuide",[tD,tG]=(0,n.useState)(null),[tT,tO]=(0,n.useState)(null),tz=(0,n.useRef)(null),tP=(0,n.useRef)(null),tE=(0,n.useRef)(null),tL=(0,n.useRef)(""),[tF,tU]=(0,n.useState)(""),[tW,tQ]=(0,n.useState)([]),[tq,tH]=(0,n.useState)(!1),[tJ,tY]=(0,n.useState)(!1),tX=(0,n.useRef)(!1),[tK,tZ]=(0,n.useState)(!1),[tV,t$]=(0,n.useState)(!1),t0=document.body,t1=(0,n.useRef)(null),t2=e=>{Math.abs(e.deltaY)>Math.abs(e.deltaX)&&(e.currentTarget.scrollLeft+=e.deltaY,e.preventDefault())},t4=ea||en||el||!!tD||!!eQ||tg||tA;(0,n.useEffect)(()=>{if("undefined"!=typeof document&&t4){let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}}},[t4]);let t6=e=>{try{return window.localStorage.getItem(e)}catch(e){return null}},t3=(e,t)=>{try{window.localStorage.setItem(e,t)}catch(e){}},t8=(0,n.useCallback)(async()=>{try{let a=t6("token");if(!a)return{token:null,userId:null};let s=t6("userId");if(!s){var e;let n=await u.A.get("".concat(t,"/users/me"),{headers:{Authorization:"Bearer ".concat(a)}});(s=null===(e=n.data)||void 0===e?void 0:e.userId)&&t3("userId",s)}return s&&M(s),{token:a,userId:s}}catch(e){return console.error("fetchUserData error",e),{token:null,userId:null}}},[t]),t5=(0,n.useCallback)(async()=>{let e=t6("token");return e||(e_(!0),null)},[]);(0,n.useEffect)(()=>{let e=new Date().toISOString().slice(0,10),t=t6("smartCountDate"),a=Number(t6("smartCount")||"0");t!==e&&(a=0,t3("smartCountDate",e),t3("smartCount","0")),e7(a),tt(e)},[]);let t9=async()=>{if(!e8&&e9>=30){e5(!1),alert("".concat(r("smart_limit_reached_title"),"\n").concat(r("smart_limit_reached_message")));return}let e=!e8;if(e5(e),e){let e=e9+1;e7(e),t3("smartCount",String(e))}},t7=e=>eC.includes(e);(0,n.useEffect)(()=>{(async()=>{let e=t6("autoCheckLanguage");e&&t7(e)&&(eZ(e),p.xC(e)),tZ(!0)})()},[]),(0,n.useEffect)(()=>{eK&&(p.xC(eK),t3("autoCheckLanguage",eK))},[eK]),(0,n.useEffect)(()=>{let e=t6("language"),t=t6("learningLanguage"),a=[];if(e&&a.push(e),t)try{let e=JSON.parse(t);Array.isArray(e)&&a.push(...e)}catch(e){}let s=Array.from(new Set(a)).filter(t7),n=Array.from(new Set([...eC.filter(e=>s.includes(e)),...s.filter(e=>!eC.includes(e))]));e1(n.length?n:["en"])},[]),(0,n.useEffect)(()=>{t8()},[t8]),(0,n.useEffect)(()=>{ta&&(async()=>{let e;let{token:a}=await t8();if(!a||D)return;let{data:s}=await u.A.get("".concat(t,"/ai-chat/sessions"),{headers:{Authorization:"Bearer ".concat(a)}}),n=s.sessions||[];(e=N&&"brody-ai"!==N?n.find(e=>e.otherUserId===N):n.find(e=>!e.otherUserId||"brody-ai"===e.otherUserId))||(e={sessionId:(await u.A.post("".concat(t,"/ai-chat/session"),{otherUserId:N||"brody-ai"},{headers:{Authorization:"Bearer ".concat(a)}})).data.sessionId,assistantName:"Brody"}),G(e.sessionId),U(e.assistantName||"Brody (AI)"),E(e.assistantName||"Brody")})()},[t,ta,D,N,t8]),(0,n.useEffect)(()=>{(null==N?void 0:N.startsWith("custom-ai"))&&D&&(async()=>{let{token:e}=await t8();if(e)try{let{rolePlayScenario:a,assistantName:s,situationImage:n,persona:i}=(await u.A.get("".concat(t,"/ai-chat/session/").concat(D,"/metadata"),{headers:{Authorization:"Bearer ".concat(e)}})).data.metadata||{};a&&tl(a),s&&tc(s),n&&tu(n),i&&tm(i)}catch(e){console.error("metadata error",e)}})()},[t,D,N,t8]),(0,n.useEffect)(()=>{(async()=>{var e,a,s,n,i,l;let o=await t5();if(o&&!ta)try{if(I){let e=(await u.A.get("".concat(t,"/buddy-groups/get/").concat(I),{headers:{Authorization:"Bearer ".concat(o)}})).data,a=(await u.A.get("".concat(t,"/buddy-chat/").concat(I),{headers:{Authorization:"Bearer ".concat(o)}})).data,s=(a.messages||[]).map(e=>({...e,profileImage:e.profileImage||null}));Q(s),G(a.chatId),z(a.chat),et(!1);let n=a.buddyGroupName||"";n&&n!==e.buddyGroupName&&await u.A.post("".concat(t,"/buddy-chat/").concat(I,"/update-name"),{buddyGroupName:e.buddyGroupName},{headers:{Authorization:"Bearer ".concat(o)}}),U(e.buddyGroupName||r("group")),E(e.buddyGroupName||r("group_chat"))}else if(N){let n=(await u.A.post("".concat(t,"/chats/createOrRetrieveChat"),{otherUserId:N},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}})).data;z(n.chat),U((null===(e=n.chat)||void 0===e?void 0:e.title)||r("group")),(null===(a=n.chat)||void 0===a?void 0:a.messages)&&(null===(s=n.chat)||void 0===s?void 0:s._id)&&(Q(n.chat.messages||[]),G(n.chat._id)),E(n.otherUserNickname||N)}}catch(e){if((null==e?void 0:null===(n=e.response)||void 0===n?void 0:n.status)===404&&I){Q([]),G(null),z(null),et(!0);try{let e=await t5();if(!e)return;let a=await u.A.get("".concat(t,"/buddy-groups/get/").concat(I),{headers:{Authorization:"Bearer ".concat(e)}});U((null===(i=a.data)||void 0===i?void 0:i.buddyGroupName)||r("group")),E((null===(l=a.data)||void 0===l?void 0:l.buddyGroupName)||r("group_chat"))}catch(e){U(r("group")),E(r("group_chat"))}return}console.error("loadChat error",e),Q([])}})()},[t,r,t5,ta,I,N]),(0,n.useEffect)(()=>{N&&!ta&&(async()=>{let e=t6("token");if(e)try{let a=await u.A.get("".concat(t,"/users/members/").concat(N),{headers:{Authorization:"Bearer ".concat(e)}});tH(a.data.isBlocked),tY(a.data.isBlockedBy)}catch(e){console.error("block flags error",e)}})()},[t,ta,N]);let ae=e=>({_id:e._id,senderId:"assistant"===e.role?"brody-ai":A,message:e.content,timestamp:e.timestamp,profileImage:"assistant"===e.role?"/assets/AIProfile.png":null,imageUrl:null}),at=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(ti){let{token:s}=await t8();if(!s||!B)return;let n="".concat(t,"/district-chat/").concat(encodeURIComponent(B),"/messages?limit=").concat(20);!e&&Z&&(n+="&cursor=".concat(encodeURIComponent(Z))),e&&(Q([]),$(null)),J(!0);try{let t=await u.A.get(n,{headers:{Authorization:"Bearer ".concat(s)}}),a=t.data.messages||[];$(t.data.nextCursor||null),K(!!t.data.nextCursor),e?Q(a):Q(e=>{let t=a.filter(t=>!e.some(e=>e._id===t._id));return[...e,...t]})}catch(t){var a;(null==t?void 0:null===(a=t.response)||void 0===a?void 0:a.status)===404&&e?(Q([]),$(null)):console.error("fetch regional msgs error",t)}finally{J(!1)}return}if(ta){let{token:a}=await t8();if(!a||!D)return;let s="".concat(t,"/ai-chat/session/").concat(D,"/messages?limit=").concat(20);!e&&Z&&(s+="&cursor=".concat(encodeURIComponent(Z))),e&&(Q([]),$(null)),J(!0);try{let t=await u.A.get(s,{headers:{Authorization:"Bearer ".concat(a)}}),n=(t.data.messages||[]).map(ae);$(t.data.nextCursor||null),K(!!t.data.nextCursor),e?Q(n.reverse()):Q(e=>[...e,...n.filter(t=>!e.some(e=>e._id===t._id))])}catch(e){console.error("fetch AI msgs error",e)}finally{J(!1)}return}if(!D&&!I)return;let{token:s}=await t8();if(!s)return;let n=I?"".concat(t,"/buddy-chat/").concat(I,"?limit=").concat(20):"".concat(t,"/chats/").concat(D,"/messages?limit=").concat(20);!e&&Z&&(n+="&cursor=".concat(encodeURIComponent(Z))),e&&(Q([]),$(null)),J(!0);try{let t=await u.A.get(n,{headers:{Authorization:"Bearer ".concat(s)}}),a=t.data.messages||[];$(t.data.nextCursor||null),K(!!t.data.nextCursor),e?Q(a):Q(e=>{let t=a.filter(t=>!e.some(e=>e._id===t._id));return[...e,...t]})}catch(e){console.error("fetch msgs error",e)}finally{J(!1)}},[t,ta,D,I,Z,t8]);(0,n.useEffect)(()=>{ta&&D&&A&&at(!0).then(()=>t$(!0)).catch(console.error)},[ta,D,A,at]),(0,n.useEffect)(()=>{!ta&&D&&at(!0).catch(console.error)},[ta,D,at]),(0,n.useEffect)(()=>{if(ta&&D&&tV&&tK&&0===W.length&&!tX.current){let e=ew[eK]||ew.en,t=e[Math.floor(Math.random()*e.length)];tX.current=!0,ao({text:t},{skipGrammarCheck:!0}).catch(console.error)}},[ta,D,tV,tK,W.length,eK]),(0,n.useEffect)(()=>{if(!D&&!I)return;let e=(0,h.Ay)(t,{transports:["websocket","polling"]});tz.current=e;let a=null!=I?I:ta?D?"ai:".concat(D):void 0:null!=D?D:void 0;return a&&e.emit("joinRoom",a),e.on("newMessage",e=>{Q(t=>e.senderId===A&&t.some(t=>t.senderId===A&&t.message===e.message)||t.some(t=>t._id===e._id)?t:[e,...t])}),e.on("newBuddyMessage",e=>{e._id=String(e._id),Q(t=>e.senderId===A&&t.some(t=>t.senderId===A&&t.message===e.message)||t.some(t=>t._id===e._id)?t:[e,...t])}),ta&&D&&(e.on("ai:status",e=>{eX(eN(r)(e.label))}),e.on("ai:done",e=>{eX(null);let t={_id:"ai-".concat(Date.now()),senderId:"brody-ai",message:e.assistantReply||"",timestamp:new Date().toISOString(),profileImage:"/assets/AIProfile.png"};Q(e=>[t,...e]),Array.isArray(e.choices)&&e.choices.length&&eq(e.choices),eP&&e.assistantReply&&am(e.assistantReply)}),e.on("ai:error",()=>{eX("⚠️ Error"),setTimeout(()=>eX(null),1200)})),e.on("connect_error",e=>{e instanceof Error?console.error("socket error",e.message,e):console.error("socket error",e)}),()=>{e.disconnect()}},[t,r,ta,D,I,eP,A]),(0,n.useEffect)(()=>{try{let e=JSON.parse(t6("grammar_history")||"[]"),t=JSON.parse(t6("expression_history")||"[]");eB(Array.isArray(e)?e.length:0),eM(Array.isArray(t)?t.length:0)}catch(e){eB(0),eM(0)}},[]),(0,n.useEffect)(()=>{"hidden"!==t6(tR)&&tM(!0)},[]);let aa=(0,n.useMemo)(()=>[{key:"chatRoomGuide.step1",tgt:ty},{key:"chatRoomGuide.step2",tgt:tf},{key:"chatRoomGuide.step3",tgt:tb},{key:"chatRoomGuide.step4",tgt:tj},{key:"chatRoomGuide.step5",tgt:tN},{key:"chatRoomGuide.step6",tgt:tS},{key:"chatRoomGuide.step7",tgt:tB}].filter(e=>{let{tgt:t}=e;return t&&0!==t.x}).map(e=>{let{key:t,tgt:a}=e;return{key:t,target:a}}),[ty,tf,tb,tj,tN,tS,tB]),as=(e,t)=>{let a=e.split(/\s+/);return t.map(e=>{if("number"==typeof e.index&&e.index>=0)return e;let t=e.error.split(/\s+/),s=a.findIndex((s,n)=>a.slice(n,n+t.length).join(" ")===e.error);return{...e,index:s}})},an=(e,t)=>{try{let a=JSON.parse(t6(e)||"[]"),s=Array.isArray(a)?[...a,...t]:t;t3(e,JSON.stringify(s)),"grammar_history"===e&&eB(e=>e+t.length),"expression_history"===e&&eM(e=>e+t.length)}catch(e){console.error("persistHistory error",e)}},ai=async(e,a,s)=>{if(e.trim()&&!eH){eS(e=>({...e,[a]:!0}));try{let n=t6("token");if(!n)return;let i=t6("language")||"en",r=await fetch("".concat(t,"/api/grammar-check"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({text:e,languageCode:s,uiLanguage:i,smartMode:e8})}),l=await r.json(),o=Array.isArray(l.grammarIssues)?l.grammarIssues.map(t=>({...t,index:"number"==typeof t.index?t.index:e.split(/\s+/).findIndex(e=>e===t.error)})):[],c=Array.isArray(l.expressionIssues)?l.expressionIssues.map(t=>({...t,index:"number"==typeof t.index?t.index:e.split(/\s+/).findIndex(e=>e===t.error)})):[];o=as(e,o),c=as(e,c);let d=[...o,...c];eb(e=>({...e,[a]:d}));let u=e.match(/[^\.!\?]+[\.!\?]+/g)||[e],h=new Date().toISOString(),m="true"===(t6("requestScores")||"false"),g=(t,n)=>{let r=[];for(let l=0;l<u.length;l+=2){let o=u.slice(l,l+2).join(" ").trim()||e,c=t.filter(e=>o.includes(e.error)),d=C(o,c).join(" ").trim();c.length>0&&r.push({id:"".concat(a,"-").concat("grammar_history"===n?"g":"e","-").concat(l/2),sentence:o,correctedSentence:d,issues:c,timestamp:h,savedAt:h,requestLanguage:s,uiLanguage:i,requestScores:m})}return r};an("grammar_history",g(o,"grammar_history")),an("expression_history",g(c,"expression_history"))}catch(e){console.error("grammar check error",e)}finally{eS(e=>({...e,[a]:!1}))}}},ar=(e,t)=>{let a=e.trim().split(/\s+/),s=t.trim().split(/\s+/),n=0;for(;n<a.length&&n<s.length&&a[n]===s[n];)n++;let i=a.length-1,r=s.length-1;for(;i>=n&&r>=n&&a[i]===s[r];)i--,r--;return{err:a.slice(n,i+1).join(" "),sug:s.slice(n,r+1).join(" ")}},al=async(e,t,a)=>{try{let{err:s,sug:n}=ar(e,t),i=new Date().toISOString(),r=t6("language")||"en",l={id:"mcq-".concat(Date.now()),sentence:e,correctedSentence:t,issues:[{error:s,suggestion:n,explanation:a,index:-1}],timestamp:i,savedAt:i,requestLanguage:eK,uiLanguage:r,requestScores:!1};an("grammar_history",[l])}catch(e){console.error("appendWrongMcq error",e)}},ao=(0,n.useCallback)(async function(e){var a,s,n,i,l;let{text:o,imageUri:c}=e,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(et(!1),ti){let{userId:e}=await t8(),s=await t5();if(!s||!B)return;let n=Date.now().toString(),i={_id:n,senderId:null!==(a=null!=e?e:A)&&void 0!==a?a:"unknown",message:o||"",timestamp:new Date().toISOString(),imageUrl:c||null,isUploading:!!c};Q(e=>[i,...e]);try{let a=new FormData;if(a.append("userId",e||""),a.append("timestamp",new Date().toISOString()),o&&a.append("content",o),c){let e=c.split("/").pop()||"district.jpg";a.append("image",new File([],e))}let{data:i,status:r}=await u.A.post("".concat(t,"/district-chat/").concat(encodeURIComponent(B)),a,{headers:{Authorization:"Bearer ".concat(s)}});if(r>=200&&r<300)i.isUploading=!1,Q(e=>e.map(e=>e._id===n?i:e));else throw Error("failed")}catch(e){console.error(e),Q(e=>e.filter(e=>e._id!==n))}return}let{userId:h}=await t8(),m=await t5();if(!m)return;if(e8&&e9>=30){e5(!1),alert("".concat(r("smart_limit_reached_title"),"\n").concat(r("smart_limit_reached_message")));return}if(ta){let e=Date.now().toString(),a={_id:e,senderId:null!==(s=null!=h?h:A)&&void 0!==s?s:"unknown",message:o||"",timestamp:new Date().toISOString(),imageUrl:null,isUploading:!0};Q(e=>[a,...e]),e6&&(null==o?void 0:o.trim())&&ai(o,e,eK);let n=t6("language")||"en";try{let{assistantReply:a="",choices:s=[]}=(await u.A.post("".concat(t,"/ai-chat/session/").concat(D,"/message"),{content:o,realtimeStatus:!0,difficulty:eR,topic:eG,voiceChatMode:eP,rolePlayScenario:ts?tr:eL?eU:null,enableMCQ:eH,languageCode:eK,uiLanguage:n,smartMode:e8,persona:th||void 0},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m)}})).data||{};Q(t=>t.map(t=>t._id===e?{...t,isUploading:!1}:t));let i={_id:"ai-".concat(Date.now()),senderId:"brody-ai",message:a,timestamp:new Date().toISOString(),profileImage:"/assets/AIProfile.png"};Q(e=>[i,...e]),d.extraIssue&&eb(t=>({...t,[e]:[d.extraIssue]})),Array.isArray(s)&&4===s.length&&eq(s),eP&&a&&am(a)}catch(t){console.error("AI send error",t),alert(r("message_send_error")),Q(t=>t.filter(t=>t._id!==e))}return}let g=Date.now().toString(),p={_id:g,senderId:null!==(n=null!=h?h:A)&&void 0!==n?n:"unknown",message:o||"",timestamp:new Date().toISOString(),imageUrl:c||null,isUploading:!0};Q(e=>[p,...e]),e6&&!d.skipGrammarCheck&&(null==o?void 0:o.trim())&&ai(o,g,eK);try{let e=new FormData;if(e.append("senderId",h||""),e.append("timestamp",new Date().toISOString()),o&&e.append("message",o),c){let t=c.split("/").pop()||"photo.jpg";e.append("file",new File([],t))}let a=I?"".concat(t,"/buddy-chat/").concat(I):"".concat(t,"/chats/").concat(D,"/message"),s=await u.A.post(a,e,{headers:{Authorization:"Bearer ".concat(m)}});if(200===s.status||201===s.status){let e=s.data.message,t=null!==(l=e._id)&&void 0!==l?l:e.id;e._id=t?String(t):g,e.isUploading=!1,Q(t=>t.map(t=>t._id===g?e:t)),d.extraIssue&&eb(t=>({...t,[e._id]:[d.extraIssue]})),e6&&(null===(i=e.message)||void 0===i?void 0:i.trim())&&ai(e.message,e._id,eK)}else throw Error("unexpected response")}catch(e){console.error("send error",e),Q(e=>e.filter(e=>e._id!==g)),alert(r("message_send_error"))}},[t,r,t5,t8,ta,D,I,eK,eR,eG,eP,eL,eU,tr,th,eH,e8,e9,e6]),ac={en:"en-US",es:"es-ES",fr:"fr-FR",zh:"zh-CN",ja:"ja-JP",ko:"ko-KR",ar:"ar-SA",de:"de-DE",hi:"hi-IN",it:"it-IT",pt:"pt-PT",ru:"ru-RU"},ad=()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return;tP.current&&au();let t=new e;t.lang=ac[eK]||"en-US",t.continuous=!0,t.interimResults=!0,t.onresult=e=>{let t="",a="";for(let s=e.resultIndex;s<e.results.length;s++){let n=e.results[s][0].transcript;e.results[s].isFinal?t+=n:a=n}a&&tU(a),t&&(tL.current=(tL.current+" "+t).trim(),e6&&(tE.current&&clearTimeout(tE.current),tE.current=setTimeout(()=>{ah(tL.current),tL.current="",tU("")},1500)))},t.onerror=()=>{au()},t.onend=()=>{eP&&ad()},tP.current=t,t.start()},au=()=>{try{var e;null===(e=tP.current)||void 0===e||e.stop()}catch(e){}tP.current=null,tE.current&&(clearTimeout(tE.current),tE.current=null),tU("")},ah=async e=>{e.trim()&&await ao({text:e},{skipGrammarCheck:!1})};(0,n.useEffect)(()=>(eP?ad():au(),()=>au()),[eP,eK]);let am=e=>{try{let t=new SpeechSynthesisUtterance(e);t.lang=ac[eK]||"en-US",window.speechSynthesis.cancel(),window.speechSynthesis.speak(t)}catch(e){console.warn("TTS unsupported",e)}},ag=(e,t,a)=>{let s=as(t,a);tO({sentence:t,issues:s}),tG(e)};(0,n.useEffect)(()=>{let e=async()=>{let e=t6("token"),a=t6("userId");if(e&&a)try{var s;let n=await u.A.get("".concat(t,"/friend/friends?userId=").concat(a),{headers:{Authorization:"Bearer ".concat(e)}});tQ((null===(s=n.data)||void 0===s?void 0:s.friends)||[])}catch(e){console.error("friends error",e)}};en&&e()},[t,en]);let ap=async e=>{if(!D)return alert("No chat ID");let a=t6("token");try{let s=await u.A.post("".concat(t,"/chats/").concat(D,"/invite"),{friendId:e},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}});200===s.status?(alert(r("friend_invited")),er(!1)):alert(r("friend_invite_failed"))}catch(e){console.error(e),alert(r("friend_invite_failed"))}},a_=async()=>{if(I)try{eg(!0);let e=t6("token");if(!e)return e_(!0);let a=await u.A.get("".concat(t,"/buddy-groups/get/").concat(I),{headers:{Authorization:"Bearer ".concat(e)}});ed(a.data)}catch(e){console.error("buddy detail err",e)}finally{eg(!1),eo(!0)}},ay=async()=>{if(!D)return alert("No chat ID found.");try{let e=t6("token");if(!e)return e_(!0);let a=await u.A.delete("".concat(t,"/chats/").concat(D,"/delete"),{headers:{Authorization:"Bearer ".concat(e)}});200===a.status?(alert(r("chat_deleted")),o.back()):alert(r("chat_delete_failed"))}catch(e){console.error(e),alert(r("chat_delete_failed"))}},av=async()=>{if(D)try{let{token:e}=await t8();if(!e)return;await u.A.delete("".concat(t,"/ai-chat/session/").concat(D),{headers:{Authorization:"Bearer ".concat(e)}}),alert(r("leave_custom_session_success")),o.back()}catch(e){console.error(e),alert(r("leave_custom_session_error"))}},af=e=>{let t=e.senderId===A,a=ti?"regional":ta?"ai":I?"buddy":"normal",n=null!=I?I:null!=D?D:void 0;return(0,s.jsx)(w.A,{content:e.message,userId:e.senderId,isMine:t,timestamp:e.timestamp,profileImage:e.profileImage||"",imageUrl:e.imageUrl,isImageUploading:!!e.imageUrl&&e.isUploading,isTextUploading:!e.imageUrl&&e.isUploading,_id:e._id,messageType:a,chatContextId:n,onDelete:e=>Q(t=>t.filter(t=>t._id!==e)),issues:ef[e._id||""]||[],onOpenQuiz:(e,t,a)=>{ag(e,t,b(t,a))},selectedLanguage:eK,learningCEFR:eR})};return(0,s.jsxs)("div",{ref:tI,className:c().wrapper,children:[(0,s.jsxs)("header",{className:c().header,children:[(0,s.jsx)("button",{className:c().iconBtn,onClick:()=>x(e=>!e),"aria-label":"Open chat list",title:"Chats",children:(0,s.jsx)("img",{src:"/assets/newChat.png",alt:"Chats",width:24,height:24})}),(0,s.jsxs)("button",{className:c().titleBtn,onClick:()=>ta?t9():I?a_():N?t9():void ev(!0),children:[(0,s.jsx)("span",{className:l()(c().title,{[c().titleGradient]:e8}),"aria-live":"polite",children:ti?"".concat(B," ").concat(r("chat_room")):(null==T?void 0:T.type)==="group"?"".concat(F," (").concat((null==T?void 0:null===(e=T.userIds)||void 0===e?void 0:e.length)||0,")"):to||P||(null==th?void 0:th.name)||""}),(0,s.jsx)(j.A,{size:14,"aria-hidden":"true",className:c().chevIcon})]}),I?(0,s.jsx)(em.A,{buddyGroupId:I,buddyPhoto:"",activityCountry:"",size:32}):(0,s.jsx)("button",{className:c().iconBtn,onClick:()=>es(!0),"aria-label":"Menu",children:(0,s.jsx)("img",{src:"/assets/full-post-menu-icon.png",alt:"menu",width:28,height:28})})]}),ta&&!eQ&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:l()(c().aiBar,{[c().aiBarExpanded]:eO}),ref:t_,children:eO?(0,s.jsxs)("div",{className:c().aiExpanded,children:[(0,s.jsxs)("div",{className:c().aiExpandedHead,children:[(0,s.jsx)("span",{className:c().aiExpandedTitle,children:r("ai_options")}),(0,s.jsx)("button",{className:c().collapseBtn,onClick:()=>ez(!1),children:"–"})]}),(0,s.jsxs)("div",{className:c().row,children:[(0,s.jsxs)("span",{className:c().label,children:[r("difficulty"),":"]}),(0,s.jsx)("div",{className:c().scrollRow,onWheel:t2,children:["A1","A2","B1","B2","C1","C2"].map(e=>(0,s.jsx)("button",{className:l()(c().pill,{[c().pillActive]:eR===e}),onClick:()=>eD(e),children:e},e))})]}),(0,s.jsxs)("div",{className:c().row,children:[(0,s.jsxs)("span",{className:c().label,children:[r("topic"),":"]}),(0,s.jsx)("div",{className:c().scrollRow,onWheel:t2,children:["none","law","medicine","science","art"].map(e=>(0,s.jsx)("button",{className:l()(c().pill,{[c().pillActive]:eG===e}),onClick:()=>eT(e),children:r("topic_".concat(e))},e))})]}),(0,s.jsxs)("div",{className:c().centerRow,children:[(0,s.jsx)("button",{className:c().switchBtn,onClick:()=>eE(e=>!e),children:eP?r("disable_voice_chat"):r("enable_voice_chat")}),eP&&(0,s.jsx)("div",{className:c().voicePulse})]}),(0,s.jsxs)("div",{className:c().centerCol,children:[(0,s.jsx)("button",{className:c().switchBtn,onClick:()=>eF(e=>!e),children:eL?r("disable_roleplay"):r("enable_roleplay")}),eL&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:c().scenarioDesc,children:r("scenario_".concat(eU,"_desc"))}),(0,s.jsx)("div",{className:c().scrollRow,onWheel:t2,children:ej.map(e=>(0,s.jsx)("button",{className:l()(c().pill,{[c().pillActive]:eU===e.id}),onClick:()=>eW(e.id),children:r("scenario_".concat(e.id))},e.id))})]})]})]}):(0,s.jsxs)("div",{className:c().aiBarCollapsed,children:[ts?(0,s.jsx)("button",{className:c().aiPlus,onClick:()=>tp(!0)}):(0,s.jsx)("button",{className:c().aiPlus,onClick:()=>ez(!0),children:"AI +"}),(0,s.jsx)("div",{className:c().scenarioRow,ref:tv,children:ts?tr&&(0,s.jsxs)("button",{className:c().customScenarioBtn,onClick:()=>tp(!0),children:[(0,s.jsx)("span",{className:c().customScenarioTitle,children:r("scenario")}),(0,s.jsx)("span",{className:c().customScenarioDesc,title:tr,children:tr})]}):(0,s.jsx)("div",{className:c().scenarioScroll,ref:t1,onWheel:t2,children:ej.map(e=>{let t=tn&&eU===e.id;return(0,s.jsx)("button",{className:l()(c().scenarioChip,{[c().scenarioChipSelected]:t,[c().scenarioChipDisabled]:!tn}),onClick:()=>{eU===e.id?tn?(eE(!1),eF(!1)):(eE(!0),eF(!0)):(tn||(eE(!0),eF(!0)),eW(e.id))},children:r("scenario_".concat(e.id))},e.id)})})})]})}),!eO&&!eQ&&(0,s.jsx)("div",{className:c().badges,ref:tx,children:(0,s.jsxs)("div",{className:c().badgeScroll,children:[(0,s.jsx)(H,{count:ek,icon:"edit-3",accent:"#F2542D"}),(0,s.jsx)(H,{count:eA,icon:"type",accent:"#D8315B"}),(0,s.jsxs)("button",{className:l()(c().langBtn,{[c().langBtnActive]:eV}),ref:tC,onClick:()=>e$(e=>!e),children:[(0,s.jsx)("img",{src:_.A[eK]||"/assets/flags/en.png",alt:eK,width:16,height:16}),(0,s.jsx)("span",{children:r("languages.".concat(eK))})]}),(0,s.jsxs)("button",{className:l()(c().smallPill,c().smallPillActive),onClick:()=>{es(!0)},children:[r("difficulty"),": ",eR]}),(0,s.jsx)("button",{className:l()(c().smallPill,{[c().smallPillActive]:e6}),onClick:()=>e3(e=>!e),children:r("toggle_auto_check")}),(0,s.jsx)("button",{className:l()(c().smallPill,{[c().smallPillActive]:eH}),ref:tw,onClick:()=>eJ(e=>!e),children:r("toggle_mcq")})]})})]}),ta&&!!eY&&eY!==r("ai-rt.banner.undefined")&&(0,s.jsx)("p",{className:c().modelStatus,children:eY}),(0,s.jsx)("div",{className:c().list,onScroll:e=>{e.currentTarget.scrollTop<80&&!q&&Y&&at(!1)},children:(0,s.jsxs)("div",{className:c().listInner,children:[W.map(e=>(0,s.jsx)("div",{className:c().item,children:af(e)},e._id)),ee&&(0,s.jsxs)("div",{className:c().empty,children:[(0,s.jsx)("img",{src:"/assets/plus-icon.png",alt:"",width:16,height:16}),(0,s.jsx)("span",{children:r("start_first_message")})]}),q&&(0,s.jsx)("div",{className:c().loading})]})}),!eQ&&(0,s.jsx)("div",{ref:tk,children:(0,s.jsx)(k,{value:tF,onChangeText:e=>tU(e),onSendMessage:e=>ao(e),isAIChat:ta,isVoiceChatMode:eP,onToggleVoiceChatMode:()=>eE(e=>!e)})}),ea&&t0&&(0,i.createPortal)((0,s.jsx)("div",{className:c().menuOverlay,onClick:()=>es(!1),"aria-modal":"true",role:"dialog",children:(0,s.jsxs)("div",{className:c().menu,onClick:e=>e.stopPropagation(),children:[!ta&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:c().menuBtn,onClick:ay,children:r("leave_chat")}),N&&(0,s.jsx)("button",{className:c().menuBtn,onClick:async()=>{es(!1);let e=t6("token");if(!e)return e_(!0);try{let a="".concat(t,"/users/").concat(tq?"unblock":"block","/").concat(N),s=await u.A.post(a,{},{headers:{Authorization:"Bearer ".concat(e)}});200===s.status&&(tH(e=>!e),alert(tq?r("unblock_successfully"):r("block_successfully")))}catch(e){alert(r("server_error"))}},children:tq?r("unblock_user"):r("block_user")}),(0,s.jsx)("button",{className:c().menuBtn,onClick:()=>{es(!1),er(!0)},children:r("invite")})]}),ta&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:c().menuBadges,children:[(0,s.jsx)(H,{count:ek,icon:"edit-3",accent:"#F2542D"}),(0,s.jsx)(H,{count:eA,icon:"type",accent:"#D8315B"})]}),(0,s.jsx)("button",{className:c().menuBtn,onClick:()=>eE(e=>!e),children:eP?r("voice_record_on"):r("voice_record_off")}),(0,s.jsx)("button",{className:c().menuBtn,onClick:()=>e3(e=>!e),children:e6?r("auto_check_on"):r("auto_check_off")}),(0,s.jsx)("div",{className:c().scrollRow,onWheel:t2,children:["A1","A2","B1","B2","C1","C2"].map(e=>(0,s.jsx)("button",{className:l()(c().pill,{[c().pillActive]:eR===e}),onClick:()=>eD(e),children:e},e))}),(0,s.jsxs)("button",{className:c().menuBtn,onClick:()=>e$(e=>!e),children:[r("check_language"),": ",r("languages.".concat(eK))]}),eV&&(0,s.jsxs)("div",{className:c().langGrid,children:[(e2?eC:e0).map(e=>(0,s.jsxs)("button",{className:l()(c().langCell,{[c().langCellActive]:eK===e}),onClick:()=>{eZ(e),e$(!1)},children:[(0,s.jsx)("img",{src:_.A[e]||"/assets/flags/en.png",alt:e,width:24,height:24}),(0,s.jsx)("span",{children:r("languages.".concat(e))})]},e)),(0,s.jsx)("button",{className:c().langCell,onClick:()=>e4(e=>!e),children:e2?"－":"＋"})]})]})]})}),t0),el&&t0&&(0,i.createPortal)((0,s.jsx)(R,{visible:el,onClose:()=>eo(!1),buddyGroupId:I||""}),t0),eH&&eQ&&t0&&(0,i.createPortal)((0,s.jsx)(L,{choices:eQ,onSelect:e=>{let t;let a=eQ.find(e=>e.isCorrect).text;e.isCorrect||(t={error:e.text,suggestion:a,explanation:e.explanation||"",index:-1},t=as(e.text,[t])[0]),t&&al(e.text,a,e.explanation||""),ao({text:e.text},{skipGrammarCheck:!0,extraIssue:t}),eq(null)},onClose:()=>eq(null),onDisable:()=>{eJ(!1),eq(null)}}),t0),tD&&tT&&t0&&(0,i.createPortal)((0,s.jsx)("div",{className:c().quizOverlay,onClick:()=>tG(null),role:"dialog","aria-modal":"true",children:(0,s.jsx)("div",{className:c().quizCard,onClick:e=>e.stopPropagation(),children:"move"===tD?(0,s.jsx)(ei,{sentence:tT.sentence,issues:tT.issues,started:!0,learnLanguage:eK,onSubmit:()=>setTimeout(()=>tG(null),3e3)}):(0,s.jsx)(eh,{sentence:tT.sentence,issues:tT.issues,started:!0,learnLanguage:eK,onSubmit:()=>setTimeout(()=>tG(null),3e3)})})}),t0),tg&&t0&&(0,i.createPortal)((0,s.jsx)(V,{visible:tg,imageUri:td||"",scenarioText:tr||"",persona:th||void 0,onClose:()=>tp(!1),onLeave:av,onShare:async()=>{if(!tr||!td)return alert(r("nothing_to_share"));let e=t6("token");if(!e)return e_(!0);try{let a=(await u.A.get("".concat(t,"/users/me"),{headers:{Authorization:"Bearer ".concat(e)}})).data,s=new FormData;s.append("userId",a.userId),s.append("author",a.nickname||a.userId),s.append("time",new Date().toISOString()),s.append("category","language_study"),s.append("title",to?"".concat(to," - ").concat(r("shared_scenario")):r("shared_scenario")),s.append("content",tr),s.append("isOffline","false"),s.append("recruitmentCount","1"),s.append("visitors","0"),s.append("likes","0"),s.append("comments","0"),s.append("language",eK),s.append("meetingTime",new Date().toISOString()),s.append("commentsOption","all"),s.append("sameCountryOnly","false"),s.append("image",new File([],"scenario.jpg",{type:"image/jpeg"}));let n=await u.A.post("".concat(t,"/posts/create"),s,{headers:{Authorization:"Bearer ".concat(e)}});n.status>=200&&n.status<300&&alert(r("post_saved_successfully"))}catch(e){console.error(e),alert((null==e?void 0:e.message)||r("unknown_error"))}},chatId:D||""}),t0),en&&t0&&(0,i.createPortal)((0,s.jsx)(O,{visible:en,onClose:()=>er(!1),friends:tW,chatUserIds:(null==T?void 0:T.userIds)||[],onInvite:ap,underDevelopment:a}),t0),tA&&aa.length>0&&t0&&(0,i.createPortal)((0,s.jsx)(X,{visible:tA&&aa.length>0,steps:aa,storageKey:tR,onClose:()=>tM(!1)}),t0),(0,s.jsx)(ex,{open:f,onClose:()=>x(!1),onSelectChat:e=>{x(!1);let t=new URLSearchParams;switch(e.type){case"ai":t.set("otherUserId","brody-ai");break;case"custom-ai":t.set("otherUserId",e.otherUserId),e.chatId&&t.set("chatId",e.chatId);break;case"personal":t.set("otherUserId",e.otherUserId),t.set("chatId",e.chatId);break;case"group":t.set("buddyGroupId",e.buddyGroupId);break;case"region":t.set("district",e.district)}"group"!==e.type&&t.delete("buddyGroupId"),"personal"!==e.type&&t.delete("chatId"),"ai"!==e.type&&"custom-ai"!==e.type&&"personal"!==e.type&&t.delete("otherUserId"),"region"!==e.type&&t.delete("district"),o.replace("/chatting-room?".concat(t.toString()))}})]})}function eS(){return(0,s.jsx)(n.Suspense,{fallback:null,children:(0,s.jsx)(eI,{})})}},50246:e=>{e.exports={container:"BuddyProfileWithFlag_container__A1ueJ",profileImage:"BuddyProfileWithFlag_profileImage__prUCO",flagWrapper:"BuddyProfileWithFlag_flagWrapper__UMv1Y",flagImage:"BuddyProfileWithFlag_flagImage__yXy_D"}},51012:e=>{e.exports={iconBtn:"MessageInputFormAI_iconBtn__tnBdg",iconPlaceholder:"MessageInputFormAI_iconPlaceholder__A2KWS",hiddenFile:"MessageInputFormAI_hiddenFile__Pyn_L",frame:"MessageInputFormAI_frame__QjYK9",input:"MessageInputFormAI_input__14hle",sending:"MessageInputFormAI_sending__FM4X3",pulse:"MessageInputFormAI_pulse__2ZsKk",previewOverlay:"MessageInputFormAI_previewOverlay__JRD91",previewCard:"MessageInputFormAI_previewCard__g84iy",previewClose:"MessageInputFormAI_previewClose__90ROs"}},51526:(e,t,a)=>{Promise.resolve().then(a.bind(a,48652))},66843:e=>{e.exports={backdrop:"ChattingListWeb_backdrop__EHGUp",backdropOpen:"ChattingListWeb_backdropOpen__zNXNy",panel:"ChattingListWeb_panel__xXM4B",panelOpen:"ChattingListWeb_panelOpen__papAg",header:"ChattingListWeb_header__hUsBN",iconBtn:"ChattingListWeb_iconBtn__pK8ke",headerTitle:"ChattingListWeb_headerTitle__7s7Zu",tabs:"ChattingListWeb_tabs__tThzz",tabBtn:"ChattingListWeb_tabBtn__COVU6",tabBtnActive:"ChattingListWeb_tabBtnActive__FsW9R",slider:"ChattingListWeb_slider__tO9X6",content:"ChattingListWeb_content__0CT40",list:"ChattingListWeb_list__3MSyM",item:"ChattingListWeb_item__QtxWN",avatar:"ChattingListWeb_avatar__NST2Z",itemMain:"ChattingListWeb_itemMain__n5IVc",nickname:"ChattingListWeb_nickname__33prh",message:"ChattingListWeb_message__fWzrT",time:"ChattingListWeb_time__oNmbP",empty:"ChattingListWeb_empty__3D7ra",emptyText:"ChattingListWeb_emptyText__i5aI5",ctaBtn:"ChattingListWeb_ctaBtn__Jql3a",ctaPrimary:"ChattingListWeb_ctaPrimary__9yt_K",spinner:"ChattingListWeb_spinner__HdcYb",s:"ChattingListWeb_s__J_BjA",regionSection:"ChattingListWeb_regionSection__Xuhxm",regionHero:"ChattingListWeb_regionHero__GoYG7",regionOverlay:"ChattingListWeb_regionOverlay__iMRHv",regionContent:"ChattingListWeb_regionContent__g0LUo",regionTitle:"ChattingListWeb_regionTitle__yb_8f",regionDesc:"ChattingListWeb_regionDesc__rd__V"}},88440:e=>{e.exports={container:"GramIsleBadge_container__J7odn",pulse:"GramIsleBadge_pulse__yDXtr","pulse-bounce":"GramIsleBadge_pulse-bounce__c8Ha5",count:"GramIsleBadge_count__fRZsZ"}},98232:e=>{e.exports={wrapper:"ChattingRoom_wrapper__Xv7a_",scenarioRow:"ChattingRoom_scenarioRow__enXIC",scenarioScroll:"ChattingRoom_scenarioScroll__gEPLt",scrollRow:"ChattingRoom_scrollRow__tR_tv",header:"ChattingRoom_header__1rFRa",iconBtn:"ChattingRoom_iconBtn__BQmAv",titleBtn:"ChattingRoom_titleBtn__Xvw9e",title:"ChattingRoom_title__BkCNN",titleGradient:"ChattingRoom_titleGradient__MBNeh",chevIcon:"ChattingRoom_chevIcon__0Ynza",modelStatus:"ChattingRoom_modelStatus__zvdRq",aiBar:"ChattingRoom_aiBar__AkwI7",aiBarExpanded:"ChattingRoom_aiBarExpanded__guQyZ",aiBarCollapsed:"ChattingRoom_aiBarCollapsed__sDcJA",aiPlus:"ChattingRoom_aiPlus__umVPY",scenarioChip:"ChattingRoom_scenarioChip__zlGLu",scenarioChipSelected:"ChattingRoom_scenarioChipSelected__9a_1c",scenarioChipDisabled:"ChattingRoom_scenarioChipDisabled__kQnL8",customScenarioBtn:"ChattingRoom_customScenarioBtn___5syy",customScenarioTitle:"ChattingRoom_customScenarioTitle__UAh1R",customScenarioDesc:"ChattingRoom_customScenarioDesc__yP9UE",aiExpanded:"ChattingRoom_aiExpanded___J_kS",aiExpandedHead:"ChattingRoom_aiExpandedHead__ZqDol",aiExpandedTitle:"ChattingRoom_aiExpandedTitle__uuba6",collapseBtn:"ChattingRoom_collapseBtn__sz7h3",row:"ChattingRoom_row__XHr_y",label:"ChattingRoom_label__B33dq",pill:"ChattingRoom_pill__e1w1_",pillActive:"ChattingRoom_pillActive__vciRh",centerRow:"ChattingRoom_centerRow__fJ9Yk",centerCol:"ChattingRoom_centerCol__E_1Gi",switchBtn:"ChattingRoom_switchBtn__4dOiO",voicePulse:"ChattingRoom_voicePulse__Tq1_i",pulse:"ChattingRoom_pulse__1pPOh",badges:"ChattingRoom_badges__lkCLp",badgeScroll:"ChattingRoom_badgeScroll__7JbnH",list:"ChattingRoom_list__l9_dC",listInner:"ChattingRoom_listInner__xbqFC",item:"ChattingRoom_item__6um4C",empty:"ChattingRoom_empty__qAaDt",loading:"ChattingRoom_loading__lysoW",menuOverlay:"ChattingRoom_menuOverlay__6uO6j",menu:"ChattingRoom_menu__nA7sp",menuBtn:"ChattingRoom_menuBtn__CTNU2",menuBadges:"ChattingRoom_menuBadges__Ib0Z3",langGrid:"ChattingRoom_langGrid__zALoz",langCell:"ChattingRoom_langCell__iREg8",langCellActive:"ChattingRoom_langCellActive__QjAE6",langBtn:"ChattingRoom_langBtn__2Cp6y",langBtnActive:"ChattingRoom_langBtnActive__zgvis",smallPill:"ChattingRoom_smallPill__5GDq7",smallPillActive:"ChattingRoom_smallPillActive__dmHhp",quizOverlay:"ChattingRoom_quizOverlay__5FRRM",quizCard:"ChattingRoom_quizCard__HiiMM"}}},e=>{var t=t=>e(e.s=t);e.O(0,[6407,3473,1126,4935,9066,844,8568,3464,1218,8152,2320,8723,9728,493,8441,1684,7358],()=>t(51526)),_N_E=e.O()}]);