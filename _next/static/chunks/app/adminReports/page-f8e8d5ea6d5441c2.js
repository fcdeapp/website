(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7789],{24490:(e,t,s)=>{Promise.resolve().then(s.bind(s,26651))},26651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(95155),i=s(12115),n=s(23464),r=s(61065),l=s(87403),o=s.n(l);let c=["ap-northeast-2","ap-southeast-2","ca-central-1","eu-west-2"];function d(){let{SERVER_URL:e}=(0,r.U)(),[t,s]=(0,i.useState)(!1),[l,d]=(0,i.useState)("error"),[h,u]=(0,i.useState)("all"),[p,m]=(0,i.useState)(!1),[x,g]=(0,i.useState)([]),[j,_]=(0,i.useState)([]),[f,v]=(0,i.useState)([]),[C,N]=(0,i.useState)([]),[A,b]=(0,i.useState)(1),[R,E]=(0,i.useState)(!1),[S,y]=(0,i.useState)(!1),[w,k]=(0,i.useState)(null),[B,I]=(0,i.useState)(null),[T,O]=(0,i.useState)(""),[F,L]=(0,i.useState)("");(0,i.useEffect)(()=>{b(1),s(!0),(async()=>{try{if(["error","report","inquiry"].includes(l)){let t=await n.A.get("".concat(e,"/api/admin/reports"),{withCredentials:!0});g(t.data.regions||[])}else if("notifications"===l){let t=await n.A.get("".concat(e,"/api/admin/nl/adminNotifications"),{withCredentials:!0});_(t.data||[])}else if("disabledUsers"===l){let t=await n.A.get("".concat(e,"/api/admin/users/disabled"),{withCredentials:!0});v(t.data.regions||[])}}catch(e){console.error("Fetch error",e)}finally{s(!1)}})()},[l,e]),(0,i.useEffect)(()=>{n.A.get("".concat(e,"/api/admin/reports/counts"),{withCredentials:!0}).then(e=>N(e.data.counts)).catch(e=>console.error(e))},[e]);let P=(()=>{if("notifications"===l)return["all"];if("disabledUsers"===l)return["all",...f.map(e=>e.region)];let e=x.map(e=>e.region);return["all",...e.length?e:c]})(),U=[];["error","report","inquiry"].includes(l)?x.forEach(e=>{("all"===h||e.region===h)&&("error"===l&&U.push(...e.errorLogs||[]),"report"===l&&U.push(...(e.reports||[]).filter(e=>"report"===e.type)),"inquiry"===l&&U.push(...(e.reports||[]).filter(e=>"inquiry"===e.type)))}):"notifications"===l?U="all"===h?j:j.filter(e=>e.sendTo===h):f.forEach(e=>{("all"===h||e.region===h)&&U.push(...e.disabledUsers||[])});let D="error"===l&&p?Object.values(U.reduce((e,t)=>(e[t.message]||(e[t.message]={message:t.message,count:0,example:t}),e[t.message].count++,e),{})):null,q=Math.ceil((D||U).length/8),M=(D||U).slice((A-1)*8,8*A),K=e=>{k(e),O(""),L(""),E(!0)},Z=async()=>{if(T&&F&&w)try{await n.A.post("".concat(e,"/api/admin/nl/postNotifications"),{title:T,message:F,sendTo:w.userId||null,type:"Individual",region:h},{withCredentials:!0}),alert("Notification sent"),E(!1)}catch(e){console.error(e),alert("Failed to send")}},Q=e=>{e?(I(e),O(e.title),L(e.message)):(I(null),O(""),L("")),y(!0)},V=async()=>{try{let t=B?"".concat(e,"/api/admin/nl/updateNotification"):"".concat(e,"/api/admin/nl/postNotifications");await n.A.post(t,{...B?{id:B._id}:{},title:T,message:F,sendTo:"all"===h?null:h,type:(null==B?void 0:B.type)||"Broadcast"},{withCredentials:!0}),alert("Saved"),y(!1)}catch(e){console.error(e),alert("Failed")}},G=async t=>{if(confirm("Delete this notification?"))try{await n.A.delete("".concat(e,"/api/admin/nl/deleteNotification/").concat(t),{withCredentials:!0}),_(e=>e.filter(e=>e._id!==t))}catch(e){console.error(e),alert("Failed to delete")}};return(0,a.jsxs)("div",{className:o().container,children:[(0,a.jsx)("h1",{className:o().header,children:"Admin Reports"}),(0,a.jsxs)("table",{className:o().countTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Region"}),(0,a.jsx)("th",{children:"Error Logs"}),(0,a.jsx)("th",{children:"Reports"}),(0,a.jsx)("th",{children:"Inquiries"}),(0,a.jsx)("th",{children:"Notifications"}),(0,a.jsx)("th",{children:"Disabled Users"})]})}),(0,a.jsx)("tbody",{children:C.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.region}),(0,a.jsx)("td",{children:e.errorLogs}),(0,a.jsx)("td",{children:e.reports}),(0,a.jsx)("td",{children:e.inquiries}),(0,a.jsx)("td",{children:e.notifications}),(0,a.jsx)("td",{children:e.disabledUsers})]},e.region))})]}),(0,a.jsxs)("div",{className:o().filterRow,children:[(0,a.jsxs)("select",{value:l,onChange:e=>d(e.target.value),children:[(0,a.jsx)("option",{value:"error",children:"Error Logs"}),(0,a.jsx)("option",{value:"report",children:"Reports"}),(0,a.jsx)("option",{value:"inquiry",children:"Inquiries"}),(0,a.jsx)("option",{value:"notifications",children:"Notifications"}),(0,a.jsx)("option",{value:"disabledUsers",children:"Disabled Users"})]}),(0,a.jsxs)("select",{value:h,onChange:e=>u(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Regions"}),P.filter(e=>"all"!==e).map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),"error"===l&&(0,a.jsx)("button",{className:o().toggleBtn,onClick:()=>m(e=>!e),children:p?"Individual View":"Group by Message"}),"notifications"===l&&(0,a.jsx)("button",{className:o().createBtn,onClick:()=>Q(),children:"+ Create Notification"})]}),t?(0,a.jsx)("div",{className:o().loader,children:"Loadingâ€¦"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("ul",{className:o().list,children:M.map((e,t)=>(0,a.jsx)("li",{className:o().listItem,children:"error"===l&&p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("strong",{children:e.message}),(0,a.jsxs)("span",{children:["(",e.count," occurrences)"]})]}):"error"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:e.message}),(0,a.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}):"report"===l||"inquiry"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:e.message}),(0,a.jsx)("small",{children:new Date(e.createdAt).toLocaleString()}),(0,a.jsx)("button",{className:o().respondBtn,onClick:()=>K(e),children:"Respond"})]}):"notifications"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:e.title}),(0,a.jsx)("p",{children:e.message}),(0,a.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:o().crudBtns,children:[(0,a.jsx)("button",{onClick:()=>Q(e),children:"Edit"}),(0,a.jsx)("button",{onClick:()=>G(e._id),children:"Delete"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:e.nickname}),(0,a.jsx)("small",{children:e.email})]})},t))}),q>1&&(0,a.jsxs)("div",{className:o().pagination,children:[(0,a.jsx)("button",{disabled:1===A,onClick:()=>b(e=>e-1),children:"Prev"}),(0,a.jsxs)("span",{children:[A," / ",q]}),(0,a.jsx)("button",{disabled:A===q,onClick:()=>b(e=>e+1),children:"Next"})]})]}),R&&(0,a.jsx)("div",{className:o().modalOverlay,onClick:()=>E(!1),children:(0,a.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("h3",{children:"Send Response"}),(0,a.jsx)("input",{placeholder:"Title",value:T,onChange:e=>O(e.target.value)}),(0,a.jsx)("textarea",{placeholder:"Message",value:F,onChange:e=>L(e.target.value)}),(0,a.jsxs)("div",{className:o().modalBtns,children:[(0,a.jsx)("button",{onClick:Z,children:"Send"}),(0,a.jsx)("button",{onClick:()=>E(!1),children:"Cancel"})]})]})}),S&&(0,a.jsx)("div",{className:o().modalOverlay,onClick:()=>y(!1),children:(0,a.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("h3",{children:[B?"Edit":"Create"," Notification"]}),(0,a.jsx)("input",{placeholder:"Title",value:T,onChange:e=>O(e.target.value)}),(0,a.jsx)("textarea",{placeholder:"Message",value:F,onChange:e=>L(e.target.value)}),(0,a.jsxs)("div",{className:o().modalBtns,children:[(0,a.jsx)("button",{onClick:V,children:B?"Save":"Create"}),(0,a.jsx)("button",{onClick:()=>y(!1),children:"Cancel"})]})]})})]})}},61065:(e,t,s)=>{"use strict";s.d(t,{s:()=>o,U:()=>c});var a=s(95155),i=s(12115);let n=JSON.parse('{"hl":"1.0.0","SC":"YOUR_INTERSTITIAL_PLACEMENT_ID","O8":"YOUR_BANNER_PLACEMENT_ID"}'),r={SERVER_URL:(()=>{let e="KR";if("undefined"!=typeof navigator&&navigator.language){let t=navigator.language.split("-");t.length>1&&(e=t[1])}let t="";switch(e.toUpperCase()){case"CA":t="ca.";break;case"AU":t="au.";break;case"GB":t="uk.";break;default:t=""}return console.log("domainPrefix: ",t),console.log("region: ",e),"https://beta.fcde.app"})(),APP_VERSION:n.hl,FACEBOOK_INTERSTITIAL_PLACEMENT_ID:n.SC,FACEBOOK_BANNER_PLACEMENT_ID:n.O8},l=(0,i.createContext)(null),o=e=>{let{children:t}=e;return(0,a.jsx)(l.Provider,{value:r,children:t})},c=()=>{let e=(0,i.useContext)(l);if(!e)throw Error("useConfig must be used within a ConfigProvider");return e}},87403:e=>{e.exports={container:"AdminReports_container__xLINJ",header:"AdminReports_header__70zCH",filterRow:"AdminReports_filterRow__T4FoD",toggleBtn:"AdminReports_toggleBtn__P31Dd",createBtn:"AdminReports_createBtn__g1im4",loader:"AdminReports_loader__QFxFf",list:"AdminReports_list__Zd_ee",listItem:"AdminReports_listItem__KtZNQ",respondBtn:"AdminReports_respondBtn__Qe87b",crudBtns:"AdminReports_crudBtns__K9hZr",pagination:"AdminReports_pagination__p579Z",modalOverlay:"AdminReports_modalOverlay___FCgq",modal:"AdminReports_modal___rmk9",modalBtns:"AdminReports_modalBtns__vf9oa",countTable:"AdminReports_countTable__eueE3"}}},e=>{var t=t=>e(e.s=t);e.O(0,[4984,3464,8441,1684,7358],()=>t(24490)),_N_E=e.O()}]);