(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7789],{24490:(e,t,a)=>{Promise.resolve().then(a.bind(a,26651))},26651:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(95155),n=a(12115),i=a(23464),l=a(61065),r=a(87403),o=a.n(r);let c=["ap-northeast-2","ap-southeast-2","ca-central-1","eu-west-2"];function d(){let{SERVER_URL:e}=(0,l.U)(),[t,a]=(0,n.useState)(!1),[r,d]=(0,n.useState)("error"),[u,h]=(0,n.useState)("all"),[p,m]=(0,n.useState)(!1),[g,x]=(0,n.useState)([]),[_,j]=(0,n.useState)([]),[v,f]=(0,n.useState)([]),[C,N]=(0,n.useState)(1),[A,R]=(0,n.useState)(!1),[b,S]=(0,n.useState)(!1),[E,y]=(0,n.useState)(null),[k,w]=(0,n.useState)(null),[B,I]=(0,n.useState)(""),[O,F]=(0,n.useState)("");(0,n.useEffect)(()=>{N(1),a(!0),(async()=>{try{if(["error","report","inquiry"].includes(r)){let t=await i.A.get("".concat(e,"/api/admin/reports"),{withCredentials:!0});x(t.data.regions||[])}else if("notifications"===r){let t=await i.A.get("".concat(e,"/api/admin/nl/adminNotifications"),{withCredentials:!0});j(t.data||[])}else if("disabledUsers"===r){let t=await i.A.get("".concat(e,"/api/admin/users/disabled"),{withCredentials:!0});f(t.data.regions||[])}}catch(e){console.error("Fetch error",e)}finally{a(!1)}})()},[r,e]);let T=(()=>{if("notifications"===r)return["all"];if("disabledUsers"===r)return["all",...v.map(e=>e.region)];let e=g.map(e=>e.region);return["all",...e.length?e:c]})(),L=[];["error","report","inquiry"].includes(r)?g.forEach(e=>{("all"===u||e.region===u)&&("error"===r&&L.push(...e.errorLogs||[]),"report"===r&&L.push(...(e.reports||[]).filter(e=>"report"===e.type)),"inquiry"===r&&L.push(...(e.reports||[]).filter(e=>"inquiry"===e.type)))}):"notifications"===r?L="all"===u?_:_.filter(e=>e.sendTo===u):v.forEach(e=>{("all"===u||e.region===u)&&L.push(...e.disabledUsers||[])});let P="error"===r&&p?Object.values(L.reduce((e,t)=>(e[t.message]||(e[t.message]={message:t.message,count:0,example:t}),e[t.message].count++,e),{})):null,D=Math.ceil((P||L).length/8),U=(P||L).slice((C-1)*8,8*C),q=e=>{y(e),I(""),F(""),R(!0)},M=async()=>{if(B&&O&&E)try{await i.A.post("".concat(e,"/api/admin/nl/postNotifications"),{title:B,message:O,sendTo:E.userId||null,type:"Individual",region:u},{withCredentials:!0}),alert("Notification sent"),R(!1)}catch(e){console.error(e),alert("Failed to send")}},K=e=>{e?(w(e),I(e.title),F(e.message)):(w(null),I(""),F("")),S(!0)},Z=async()=>{try{let t=k?"".concat(e,"/api/admin/nl/updateNotification"):"".concat(e,"/api/admin/nl/postNotifications");await i.A.post(t,{...k?{id:k._id}:{},title:B,message:O,sendTo:"all"===u?null:u,type:(null==k?void 0:k.type)||"Broadcast"},{withCredentials:!0}),alert("Saved"),S(!1)}catch(e){console.error(e),alert("Failed")}},Q=async t=>{if(confirm("Delete this notification?"))try{await i.A.delete("".concat(e,"/api/admin/nl/deleteNotification/").concat(t),{withCredentials:!0}),j(e=>e.filter(e=>e._id!==t))}catch(e){console.error(e),alert("Failed to delete")}};return(0,s.jsxs)("div",{className:o().container,children:[(0,s.jsx)("h1",{className:o().header,children:"Admin Reports"}),(0,s.jsxs)("div",{className:o().filterRow,children:[(0,s.jsxs)("select",{value:r,onChange:e=>d(e.target.value),children:[(0,s.jsx)("option",{value:"error",children:"Error Logs"}),(0,s.jsx)("option",{value:"report",children:"Reports"}),(0,s.jsx)("option",{value:"inquiry",children:"Inquiries"}),(0,s.jsx)("option",{value:"notifications",children:"Notifications"}),(0,s.jsx)("option",{value:"disabledUsers",children:"Disabled Users"})]}),(0,s.jsxs)("select",{value:u,onChange:e=>h(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"All Regions"}),T.filter(e=>"all"!==e).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),"error"===r&&(0,s.jsx)("button",{className:o().toggleBtn,onClick:()=>m(e=>!e),children:p?"Individual View":"Group by Message"}),"notifications"===r&&(0,s.jsx)("button",{className:o().createBtn,onClick:()=>K(),children:"+ Create Notification"})]}),t?(0,s.jsx)("div",{className:o().loader,children:"Loadingâ€¦"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("ul",{className:o().list,children:U.map((e,t)=>(0,s.jsx)("li",{className:o().listItem,children:"error"===r&&p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("strong",{children:e.message}),(0,s.jsxs)("span",{children:["(",e.count," occurrences)"]})]}):"error"===r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:e.message}),(0,s.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}):"report"===r||"inquiry"===r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:e.message}),(0,s.jsx)("small",{children:new Date(e.createdAt).toLocaleString()}),(0,s.jsx)("button",{className:o().respondBtn,onClick:()=>q(e),children:"Respond"})]}):"notifications"===r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:e.title}),(0,s.jsx)("p",{children:e.message}),(0,s.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}),(0,s.jsxs)("div",{className:o().crudBtns,children:[(0,s.jsx)("button",{onClick:()=>K(e),children:"Edit"}),(0,s.jsx)("button",{onClick:()=>Q(e._id),children:"Delete"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:e.nickname}),(0,s.jsx)("small",{children:e.email})]})},t))}),D>1&&(0,s.jsxs)("div",{className:o().pagination,children:[(0,s.jsx)("button",{disabled:1===C,onClick:()=>N(e=>e-1),children:"Prev"}),(0,s.jsxs)("span",{children:[C," / ",D]}),(0,s.jsx)("button",{disabled:C===D,onClick:()=>N(e=>e+1),children:"Next"})]})]}),A&&(0,s.jsx)("div",{className:o().modalOverlay,onClick:()=>R(!1),children:(0,s.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h3",{children:"Send Response"}),(0,s.jsx)("input",{placeholder:"Title",value:B,onChange:e=>I(e.target.value)}),(0,s.jsx)("textarea",{placeholder:"Message",value:O,onChange:e=>F(e.target.value)}),(0,s.jsxs)("div",{className:o().modalBtns,children:[(0,s.jsx)("button",{onClick:M,children:"Send"}),(0,s.jsx)("button",{onClick:()=>R(!1),children:"Cancel"})]})]})}),b&&(0,s.jsx)("div",{className:o().modalOverlay,onClick:()=>S(!1),children:(0,s.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("h3",{children:[k?"Edit":"Create"," Notification"]}),(0,s.jsx)("input",{placeholder:"Title",value:B,onChange:e=>I(e.target.value)}),(0,s.jsx)("textarea",{placeholder:"Message",value:O,onChange:e=>F(e.target.value)}),(0,s.jsxs)("div",{className:o().modalBtns,children:[(0,s.jsx)("button",{onClick:Z,children:k?"Save":"Create"}),(0,s.jsx)("button",{onClick:()=>S(!1),children:"Cancel"})]})]})})]})}},61065:(e,t,a)=>{"use strict";a.d(t,{s:()=>o,U:()=>c});var s=a(95155),n=a(12115);let i=JSON.parse('{"hl":"1.0.0","SC":"YOUR_INTERSTITIAL_PLACEMENT_ID","O8":"YOUR_BANNER_PLACEMENT_ID"}'),l={SERVER_URL:(()=>{let e="KR";if("undefined"!=typeof navigator&&navigator.language){let t=navigator.language.split("-");t.length>1&&(e=t[1])}let t="";switch(e.toUpperCase()){case"CA":t="ca.";break;case"AU":t="au.";break;case"GB":t="uk.";break;default:t=""}return console.log("domainPrefix: ",t),console.log("region: ",e),"https://beta.fcde.app"})(),APP_VERSION:i.hl,FACEBOOK_INTERSTITIAL_PLACEMENT_ID:i.SC,FACEBOOK_BANNER_PLACEMENT_ID:i.O8},r=(0,n.createContext)(null),o=e=>{let{children:t}=e;return(0,s.jsx)(r.Provider,{value:l,children:t})},c=()=>{let e=(0,n.useContext)(r);if(!e)throw Error("useConfig must be used within a ConfigProvider");return e}},87403:e=>{e.exports={container:"AdminReports_container__xLINJ",header:"AdminReports_header__70zCH",filterRow:"AdminReports_filterRow__T4FoD",toggleBtn:"AdminReports_toggleBtn__P31Dd",createBtn:"AdminReports_createBtn__g1im4",loader:"AdminReports_loader__QFxFf",list:"AdminReports_list__Zd_ee",listItem:"AdminReports_listItem__KtZNQ",respondBtn:"AdminReports_respondBtn__Qe87b",crudBtns:"AdminReports_crudBtns__K9hZr",pagination:"AdminReports_pagination__p579Z",modalOverlay:"AdminReports_modalOverlay___FCgq",modal:"AdminReports_modal___rmk9",modalBtns:"AdminReports_modalBtns__vf9oa"}}},e=>{var t=t=>e(e.s=t);e.O(0,[4984,3464,8441,1684,7358],()=>t(24490)),_N_E=e.O()}]);