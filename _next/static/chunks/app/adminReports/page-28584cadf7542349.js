(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7789],{24490:(e,t,s)=>{Promise.resolve().then(s.bind(s,26651))},26651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s(95155),i=s(12115),a=s(23464),r=s(89760),l=s(87403),o=s.n(l);let c=["ap-northeast-2","ap-southeast-2","ca-central-1","eu-west-2"];function d(){let{SERVER_URL:e}=(0,r.U)(),[t,s]=(0,i.useState)(!1),[l,d]=(0,i.useState)("error"),[h,u]=(0,i.useState)("all"),[_,p]=(0,i.useState)(!1),[m,x]=(0,i.useState)([]),[E,j]=(0,i.useState)([]),[g,N]=(0,i.useState)([]),[A,C]=(0,i.useState)([]),[f,v]=(0,i.useState)(1),[R,T]=(0,i.useState)(!1),[I,S]=(0,i.useState)(!1),[b,B]=(0,i.useState)(null),[D,O]=(0,i.useState)(null),[w,L]=(0,i.useState)(""),[y,P]=(0,i.useState)("");(0,i.useEffect)(()=>{v(1),s(!0),(async()=>{try{if(["error","report","inquiry"].includes(l)){let t=await a.A.get("".concat(e,"/api/admin/reports"),{withCredentials:!0});x(t.data.regions||[])}else if("notifications"===l){let t=await a.A.get("".concat(e,"/api/admin/nl/adminOnlyNotifications?region=").concat(h),{withCredentials:!0});j(t.data||[])}else if("disabledUsers"===l){let t=await a.A.get("".concat(e,"/api/admin/users/disabled"),{withCredentials:!0});N(t.data.regions||[])}}catch(e){console.error("Fetch error",e)}finally{s(!1)}})()},[l,h,e]),(0,i.useEffect)(()=>{a.A.get("".concat(e,"/api/admin/reports/counts"),{withCredentials:!0}).then(e=>C(e.data.counts)).catch(e=>console.error(e))},[e]);let F=(()=>{if("notifications"===l)return["all"];if("disabledUsers"===l)return["all",...g.map(e=>e.region)];let e=m.map(e=>e.region);return["all",...e.length?e:c]})(),U=[];["error","report","inquiry"].includes(l)?m.forEach(e=>{("all"===h||e.region===h)&&("error"===l&&U.push(...e.errorLogs||[]),"report"===l&&U.push(...(e.reports||[]).filter(e=>"report"===e.type)),"inquiry"===l&&U.push(...(e.reports||[]).filter(e=>"inquiry"===e.type)))}):"notifications"===l?U="all"===h?E:E.filter(e=>e.sendTo===h):g.forEach(e=>{("all"===h||e.region===h)&&U.push(...e.disabledUsers||[])});let k="error"===l&&_?Object.values(U.reduce((e,t)=>(e[t.message]||(e[t.message]={message:t.message,count:0,example:t}),e[t.message].count++,e),{})):null,M=Math.ceil((k||U).length/8),V=(k||U).slice((f-1)*8,8*f),q=e=>{B(e),L(""),P(""),T(!0)},K=async()=>{if(w&&y&&b)try{await a.A.post("".concat(e,"/api/admin/nl/postNotifications"),{title:w,message:y,sendTo:b.userId||null,type:"Individual",region:h},{withCredentials:!0}),alert("Notification sent"),T(!1)}catch(e){console.error(e),alert("Failed to send")}},X=e=>{e?(O(e),L(e.title),P(e.message)):(O(null),L(""),P("")),S(!0)},Z=async()=>{try{let t=D?"".concat(e,"/api/admin/nl/editNotifications/").concat(D._id):"".concat(e,"/api/admin/nl/postNotifications");await a.A.post(t,{...D?{id:D._id}:{},title:w,message:y,sendTo:"all"===h?null:h,type:"All",region:h,isAdminNotification:!0},{withCredentials:!0}),alert("Saved"),S(!1)}catch(e){console.error(e),alert("Failed")}},Q=async t=>{if(confirm("Delete this notification?"))try{await a.A.delete("".concat(e,"/api/admin/nl/deleteNotifications/").concat(t),{data:{region:h},withCredentials:!0}),j(e=>e.filter(e=>e._id!==t))}catch(e){console.error(e),alert("Failed to delete")}};return(0,n.jsxs)("div",{className:o().container,children:[(0,n.jsx)("h1",{className:o().header,children:"Admin Reports"}),(0,n.jsxs)("table",{className:o().countTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Region"}),(0,n.jsx)("th",{children:"Error Logs"}),(0,n.jsx)("th",{children:"Reports"}),(0,n.jsx)("th",{children:"Inquiries"}),(0,n.jsx)("th",{children:"Notifications"}),(0,n.jsx)("th",{children:"Disabled Users"})]})}),(0,n.jsx)("tbody",{children:A.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.region}),(0,n.jsx)("td",{children:e.errorLogs}),(0,n.jsx)("td",{children:e.reports}),(0,n.jsx)("td",{children:e.inquiries}),(0,n.jsx)("td",{children:e.notifications}),(0,n.jsx)("td",{children:e.disabledUsers})]},e.region))})]}),(0,n.jsxs)("div",{className:o().filterRow,children:[(0,n.jsxs)("select",{value:l,onChange:e=>d(e.target.value),children:[(0,n.jsx)("option",{value:"error",children:"Error Logs"}),(0,n.jsx)("option",{value:"report",children:"Reports"}),(0,n.jsx)("option",{value:"inquiry",children:"Inquiries"}),(0,n.jsx)("option",{value:"notifications",children:"Notifications"}),(0,n.jsx)("option",{value:"disabledUsers",children:"Disabled Users"})]}),(0,n.jsxs)("select",{value:h,onChange:e=>u(e.target.value),children:[(0,n.jsx)("option",{value:"all",children:"All Regions"}),F.filter(e=>"all"!==e).map(e=>(0,n.jsx)("option",{value:e,children:e},e))]}),"error"===l&&(0,n.jsx)("button",{className:o().toggleBtn,onClick:()=>p(e=>!e),children:_?"Individual View":"Group by Message"}),"notifications"===l&&(0,n.jsx)("button",{className:o().createBtn,onClick:()=>X(),children:"+ Create Notification"})]}),t?(0,n.jsx)("div",{className:o().loader,children:"Loadingâ€¦"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("ul",{className:o().list,children:V.map((e,t)=>(0,n.jsx)("li",{className:o().listItem,children:"error"===l&&_?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("strong",{children:e.message}),(0,n.jsxs)("span",{children:["(",e.count," occurrences)"]})]}):"error"===l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:e.message}),(0,n.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}):"report"===l||"inquiry"===l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:e.message}),(0,n.jsx)("small",{children:new Date(e.createdAt).toLocaleString()}),(0,n.jsx)("button",{className:o().respondBtn,onClick:()=>q(e),children:"Respond"})]}):"notifications"===l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:e.title}),(0,n.jsx)("p",{children:e.message}),(0,n.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}),(0,n.jsxs)("div",{className:o().crudBtns,children:[(0,n.jsx)("button",{onClick:()=>X(e),children:"Edit"}),(0,n.jsx)("button",{onClick:()=>Q(e._id),children:"Delete"})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:e.nickname}),(0,n.jsx)("small",{children:e.email})]})},t))}),M>1&&(0,n.jsxs)("div",{className:o().pagination,children:[(0,n.jsx)("button",{disabled:1===f,onClick:()=>v(e=>e-1),children:"Prev"}),(0,n.jsxs)("span",{children:[f," / ",M]}),(0,n.jsx)("button",{disabled:f===M,onClick:()=>v(e=>e+1),children:"Next"})]})]}),R&&(0,n.jsx)("div",{className:o().modalOverlay,onClick:()=>T(!1),children:(0,n.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h3",{children:"Send Response"}),(0,n.jsx)("input",{placeholder:"Title",value:w,onChange:e=>L(e.target.value)}),(0,n.jsx)("textarea",{placeholder:"Message",value:y,onChange:e=>P(e.target.value)}),(0,n.jsxs)("div",{className:o().modalBtns,children:[(0,n.jsx)("button",{onClick:K,children:"Send"}),(0,n.jsx)("button",{onClick:()=>T(!1),children:"Cancel"})]})]})}),I&&(0,n.jsx)("div",{className:o().modalOverlay,onClick:()=>S(!1),children:(0,n.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("h3",{children:[D?"Edit":"Create"," Notification"]}),(0,n.jsx)("input",{placeholder:"Title",value:w,onChange:e=>L(e.target.value)}),(0,n.jsx)("textarea",{placeholder:"Message",value:y,onChange:e=>P(e.target.value)}),(0,n.jsxs)("div",{className:o().modalBtns,children:[(0,n.jsx)("button",{onClick:Z,children:D?"Save":"Create"}),(0,n.jsx)("button",{onClick:()=>S(!1),children:"Cancel"})]})]})})]})}},87403:e=>{e.exports={container:"AdminReports_container__xLINJ",header:"AdminReports_header__70zCH",filterRow:"AdminReports_filterRow__T4FoD",toggleBtn:"AdminReports_toggleBtn__P31Dd",createBtn:"AdminReports_createBtn__g1im4",loader:"AdminReports_loader__QFxFf",list:"AdminReports_list__Zd_ee",listItem:"AdminReports_listItem__KtZNQ",respondBtn:"AdminReports_respondBtn__Qe87b",crudBtns:"AdminReports_crudBtns__K9hZr",pagination:"AdminReports_pagination__p579Z",modalOverlay:"AdminReports_modalOverlay___FCgq",modal:"AdminReports_modal___rmk9",modalBtns:"AdminReports_modalBtns__vf9oa",countTable:"AdminReports_countTable__eueE3"}},89760:(e,t,s)=>{"use strict";s.d(t,{s:()=>d,U:()=>h});var n=s(95155),i=s(12115),a=s(49509);function r(){return"https://fcde.app"}async function l(){return r()}let o={SERVER_URL:r()||"https://www.fcde.app",APP_VERSION:a.env.NEXT_PUBLIC_APP_VERSION||"",FACEBOOK_INTERSTITIAL_PLACEMENT_ID:a.env.NEXT_PUBLIC_FACEBOOK_INTERSTITIAL_PLACEMENT_ID||"",FACEBOOK_BANNER_PLACEMENT_ID:a.env.NEXT_PUBLIC_FACEBOOK_BANNER_PLACEMENT_ID||"",FEATURE_UNDER_DEV:"true"===(a.env.NEXT_PUBLIC_FEATURE_UNDER_DEV||"true").toLowerCase(),TEST_AD_MODE:"true"===(a.env.NEXT_PUBLIC_TEST_AD_MODE||"false").toLowerCase()},c=(0,i.createContext)(null),d=e=>{let{children:t}=e,[s,a]=(0,i.useState)(r());(0,i.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await l();e&&a(t)}catch(e){}})(),()=>{e=!1}},[]);let d={SERVER_URL:s,APP_VERSION:o.APP_VERSION,FACEBOOK_INTERSTITIAL_PLACEMENT_ID:o.FACEBOOK_INTERSTITIAL_PLACEMENT_ID,FACEBOOK_BANNER_PLACEMENT_ID:o.FACEBOOK_BANNER_PLACEMENT_ID,FEATURE_UNDER_DEV:o.FEATURE_UNDER_DEV,TEST_AD_MODE:o.TEST_AD_MODE};return(0,n.jsx)(c.Provider,{value:d,children:t})},h=()=>{let e=(0,i.useContext)(c);if(!e)throw Error("useConfig must be used within a ConfigProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4984,3464,8441,1684,7358],()=>t(24490)),_N_E=e.O()}]);