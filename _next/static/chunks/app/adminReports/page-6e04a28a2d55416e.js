(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7789],{24490:(e,t,n)=>{Promise.resolve().then(n.bind(n,26651))},26651:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var a=n(95155),s=n(12115),r=n(23464),i=n(89760),l=n(87403),o=n.n(l);let c=["ap-northeast-2","ap-southeast-2","ca-central-1","eu-west-2"];function d(){let{SERVER_URL:e}=(0,i.U)(),[t,n]=(0,s.useState)(!1),[l,d]=(0,s.useState)("error"),[h,u]=(0,s.useState)("all"),[p,_]=(0,s.useState)(!1),[m,E]=(0,s.useState)([]),[g,x]=(0,s.useState)([]),[j,f]=(0,s.useState)([]),[A,N]=(0,s.useState)([]),[C,v]=(0,s.useState)(1),[R,T]=(0,s.useState)(!1),[I,S]=(0,s.useState)(!1),[D,B]=(0,s.useState)(null),[L,O]=(0,s.useState)(null),[b,y]=(0,s.useState)(""),[U,w]=(0,s.useState)("");(0,s.useEffect)(()=>{v(1),n(!0),(async()=>{try{if(["error","report","inquiry"].includes(l)){let t=await r.A.get("".concat(e,"/api/admin/reports"),{withCredentials:!0});E(t.data.regions||[])}else if("notifications"===l){let t=await r.A.get("".concat(e,"/api/admin/nl/adminOnlyNotifications?region=").concat(h),{withCredentials:!0});x(t.data||[])}else if("disabledUsers"===l){let t=await r.A.get("".concat(e,"/api/admin/users/disabled"),{withCredentials:!0});f(t.data.regions||[])}}catch(e){console.error("Fetch error",e)}finally{n(!1)}})()},[l,h,e]),(0,s.useEffect)(()=>{r.A.get("".concat(e,"/api/admin/reports/counts"),{withCredentials:!0}).then(e=>N(e.data.counts)).catch(e=>console.error(e))},[e]);let P=(()=>{if("notifications"===l)return["all"];if("disabledUsers"===l)return["all",...j.map(e=>e.region)];let e=m.map(e=>e.region);return["all",...e.length?e:c]})(),F=[];["error","report","inquiry"].includes(l)?m.forEach(e=>{("all"===h||e.region===h)&&("error"===l&&F.push(...e.errorLogs||[]),"report"===l&&F.push(...(e.reports||[]).filter(e=>"report"===e.type)),"inquiry"===l&&F.push(...(e.reports||[]).filter(e=>"inquiry"===e.type)))}):"notifications"===l?F="all"===h?g:g.filter(e=>e.sendTo===h):j.forEach(e=>{("all"===h||e.region===h)&&F.push(...e.disabledUsers||[])});let k="error"===l&&p?Object.values(F.reduce((e,t)=>(e[t.message]||(e[t.message]={message:t.message,count:0,example:t}),e[t.message].count++,e),{})):null,M=Math.ceil((k||F).length/8),K=(k||F).slice((C-1)*8,8*C),V=e=>{B(e),y(""),w(""),T(!0)},q=async()=>{if(b&&U&&D)try{await r.A.post("".concat(e,"/api/admin/nl/postNotifications"),{title:b,message:U,sendTo:D.userId||null,type:"Individual",region:h},{withCredentials:!0}),alert("Notification sent"),T(!1)}catch(e){console.error(e),alert("Failed to send")}},X=e=>{e?(O(e),y(e.title),w(e.message)):(O(null),y(""),w("")),S(!0)},Z=async()=>{try{let t=L?"".concat(e,"/api/admin/nl/editNotifications/").concat(L._id):"".concat(e,"/api/admin/nl/postNotifications");await r.A.post(t,{...L?{id:L._id}:{},title:b,message:U,sendTo:"all"===h?null:h,type:"All",region:h,isAdminNotification:!0},{withCredentials:!0}),alert("Saved"),S(!1)}catch(e){console.error(e),alert("Failed")}},G=async t=>{if(confirm("Delete this notification?"))try{await r.A.delete("".concat(e,"/api/admin/nl/deleteNotifications/").concat(t),{data:{region:h},withCredentials:!0}),x(e=>e.filter(e=>e._id!==t))}catch(e){console.error(e),alert("Failed to delete")}};return(0,a.jsxs)("div",{className:o().container,children:[(0,a.jsx)("h1",{className:o().header,children:"Admin Reports"}),(0,a.jsxs)("table",{className:o().countTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Region"}),(0,a.jsx)("th",{children:"Error Logs"}),(0,a.jsx)("th",{children:"Reports"}),(0,a.jsx)("th",{children:"Inquiries"}),(0,a.jsx)("th",{children:"Notifications"}),(0,a.jsx)("th",{children:"Disabled Users"})]})}),(0,a.jsx)("tbody",{children:A.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.region}),(0,a.jsx)("td",{children:e.errorLogs}),(0,a.jsx)("td",{children:e.reports}),(0,a.jsx)("td",{children:e.inquiries}),(0,a.jsx)("td",{children:e.notifications}),(0,a.jsx)("td",{children:e.disabledUsers})]},e.region))})]}),(0,a.jsxs)("div",{className:o().filterRow,children:[(0,a.jsxs)("select",{value:l,onChange:e=>d(e.target.value),children:[(0,a.jsx)("option",{value:"error",children:"Error Logs"}),(0,a.jsx)("option",{value:"report",children:"Reports"}),(0,a.jsx)("option",{value:"inquiry",children:"Inquiries"}),(0,a.jsx)("option",{value:"notifications",children:"Notifications"}),(0,a.jsx)("option",{value:"disabledUsers",children:"Disabled Users"})]}),(0,a.jsxs)("select",{value:h,onChange:e=>u(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"All Regions"}),P.filter(e=>"all"!==e).map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),"error"===l&&(0,a.jsx)("button",{className:o().toggleBtn,onClick:()=>_(e=>!e),children:p?"Individual View":"Group by Message"}),"notifications"===l&&(0,a.jsx)("button",{className:o().createBtn,onClick:()=>X(),children:"+ Create Notification"})]}),t?(0,a.jsx)("div",{className:o().loader,children:"Loadingâ€¦"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("ul",{className:o().list,children:K.map((e,t)=>(0,a.jsx)("li",{className:o().listItem,children:"error"===l&&p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("strong",{children:e.message}),(0,a.jsxs)("span",{children:["(",e.count," occurrences)"]})]}):"error"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:e.message}),(0,a.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}):"report"===l||"inquiry"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:e.message}),(0,a.jsx)("small",{children:new Date(e.createdAt).toLocaleString()}),(0,a.jsx)("button",{className:o().respondBtn,onClick:()=>V(e),children:"Respond"})]}):"notifications"===l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:e.title}),(0,a.jsx)("p",{children:e.message}),(0,a.jsx)("small",{children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:o().crudBtns,children:[(0,a.jsx)("button",{onClick:()=>X(e),children:"Edit"}),(0,a.jsx)("button",{onClick:()=>G(e._id),children:"Delete"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:e.nickname}),(0,a.jsx)("small",{children:e.email})]})},t))}),M>1&&(0,a.jsxs)("div",{className:o().pagination,children:[(0,a.jsx)("button",{disabled:1===C,onClick:()=>v(e=>e-1),children:"Prev"}),(0,a.jsxs)("span",{children:[C," / ",M]}),(0,a.jsx)("button",{disabled:C===M,onClick:()=>v(e=>e+1),children:"Next"})]})]}),R&&(0,a.jsx)("div",{className:o().modalOverlay,onClick:()=>T(!1),children:(0,a.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("h3",{children:"Send Response"}),(0,a.jsx)("input",{placeholder:"Title",value:b,onChange:e=>y(e.target.value)}),(0,a.jsx)("textarea",{placeholder:"Message",value:U,onChange:e=>w(e.target.value)}),(0,a.jsxs)("div",{className:o().modalBtns,children:[(0,a.jsx)("button",{onClick:q,children:"Send"}),(0,a.jsx)("button",{onClick:()=>T(!1),children:"Cancel"})]})]})}),I&&(0,a.jsx)("div",{className:o().modalOverlay,onClick:()=>S(!1),children:(0,a.jsxs)("div",{className:o().modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("h3",{children:[L?"Edit":"Create"," Notification"]}),(0,a.jsx)("input",{placeholder:"Title",value:b,onChange:e=>y(e.target.value)}),(0,a.jsx)("textarea",{placeholder:"Message",value:U,onChange:e=>w(e.target.value)}),(0,a.jsxs)("div",{className:o().modalBtns,children:[(0,a.jsx)("button",{onClick:Z,children:L?"Save":"Create"}),(0,a.jsx)("button",{onClick:()=>S(!1),children:"Cancel"})]})]})})]})}},87403:e=>{e.exports={container:"AdminReports_container__xLINJ",header:"AdminReports_header__70zCH",filterRow:"AdminReports_filterRow__T4FoD",toggleBtn:"AdminReports_toggleBtn__P31Dd",createBtn:"AdminReports_createBtn__g1im4",loader:"AdminReports_loader__QFxFf",list:"AdminReports_list__Zd_ee",listItem:"AdminReports_listItem__KtZNQ",respondBtn:"AdminReports_respondBtn__Qe87b",crudBtns:"AdminReports_crudBtns__K9hZr",pagination:"AdminReports_pagination__p579Z",modalOverlay:"AdminReports_modalOverlay___FCgq",modal:"AdminReports_modal___rmk9",modalBtns:"AdminReports_modalBtns__vf9oa",countTable:"AdminReports_countTable__eueE3"}},89760:(e,t,n)=>{"use strict";n.d(t,{s:()=>u,U:()=>p});var a=n(95155),s=n(12115),r=n(49509);function i(e){switch(e.trim().toUpperCase()){case"BETA":return"https://beta.fcde.app";case"DEVELOPMENT":return"https://dev.fcde.app";case"CA":case"CANADA":return"https://ca.fcde.app";case"AU":case"AUSTRALIA":return"https://au.fcde.app";case"GB":case"UK":return"https://uk.fcde.app";case"KR":case"KOREA":return"https://kr.fcde.app";default:return"https://fcde.app"}}function l(){return"https://fcde.app"}async function o(e){try{return(await fetch("".concat(e,"/health"),{method:"GET"})).ok}catch(e){return!1}}async function c(){let e=null;try{let t=localStorage.getItem("selectedServer");t&&(e=t)}catch(e){}for(let t of(!e&&r.env.NEXT_PUBLIC_FORCED_DEFAULT_SERVER&&(e=r.env.NEXT_PUBLIC_FORCED_DEFAULT_SERVER),e||(e=function(){try{let e=localStorage.getItem("region");if(e)return e}catch(e){}if("undefined"!=typeof navigator&&navigator.language){let e=navigator.language.split("-");if(e.length>1)return e[1]}return"KR"}()),[e,"Beta","Development"])){let e=i(t);if(await o(e))return e}return i(e)}let d={SERVER_URL:l(),APP_VERSION:r.env.NEXT_PUBLIC_APP_VERSION||"",FACEBOOK_INTERSTITIAL_PLACEMENT_ID:r.env.NEXT_PUBLIC_FACEBOOK_INTERSTITIAL_PLACEMENT_ID||"",FACEBOOK_BANNER_PLACEMENT_ID:r.env.NEXT_PUBLIC_FACEBOOK_BANNER_PLACEMENT_ID||"",FEATURE_UNDER_DEV:"true"===(r.env.NEXT_PUBLIC_FEATURE_UNDER_DEV||"true").toLowerCase(),TEST_AD_MODE:"true"===(r.env.NEXT_PUBLIC_TEST_AD_MODE||"false").toLowerCase()},h=(0,s.createContext)(null),u=e=>{let{children:t}=e,[n,r]=(0,s.useState)(l());(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await c();e&&r(t)}catch(e){}})(),()=>{e=!1}},[]);let i={SERVER_URL:n,APP_VERSION:d.APP_VERSION,FACEBOOK_INTERSTITIAL_PLACEMENT_ID:d.FACEBOOK_INTERSTITIAL_PLACEMENT_ID,FACEBOOK_BANNER_PLACEMENT_ID:d.FACEBOOK_BANNER_PLACEMENT_ID,FEATURE_UNDER_DEV:d.FEATURE_UNDER_DEV,TEST_AD_MODE:d.TEST_AD_MODE};return(0,a.jsx)(h.Provider,{value:i,children:t})},p=()=>{let e=(0,s.useContext)(h);if(!e)throw Error("useConfig must be used within a ConfigProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4984,3464,8441,1684,7358],()=>t(24490)),_N_E=e.O()}]);