(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8453],{36332:(e,t,i)=>{Promise.resolve().then(i.bind(i,97699))},97699:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>x});var s=i(95155),n=i(12115),a=i(78126),c=i.n(a),l=i(35695),r=i(23464),o=i(61065),d=i(26597),y=i(91218),h=i(21557),u=i(64895),m=i(92037),v=i(50802),p=i(98230),j=i.n(p);let x=()=>{let{SERVER_URL:e}=(0,o.U)(),{t}=(0,y.Bd)(),i=(0,l.useRouter)(),[a,p]=(0,n.useState)(null),[x,_]=(0,n.useState)([]),[A,g]=(0,n.useState)("json"),[N,C]=(0,n.useState)(!1),[f,b]=(0,n.useState)(!1),w=async()=>{try{var i,s,n,a,c,l,o;let d=(await r.A.get("".concat(e,"/my-activity/all"),{withCredentials:!0})).data;p(d);let y=[];(null===(i=d.pastMeetings)||void 0===i?void 0:i.length)||y.push(t("myActivity.pastMeetings")),(null===(s=d.reportedPosts)||void 0===s?void 0:s.length)||y.push(t("myActivity.reportedPosts")),(null===(n=d.buddyGroups)||void 0===n?void 0:n.length)||y.push(t("myActivity.buddyGroups")),(null===(a=d.friends)||void 0===a?void 0:a.length)||y.push(t("myActivity.friends")),(null===(c=d.review)||void 0===c?void 0:c.length)||y.push(t("myActivity.reviews")),(null===(l=d.userPosts)||void 0===l?void 0:l.length)||y.push(t("myActivity.hostedPosts")),(null===(o=d.userBuddyPosts)||void 0===o?void 0:o.length)||y.push(t("myActivity.hostedBuddyPosts")),_(y)}catch(e){console.error(e),alert(t("fetch_user_data_error"))}};(0,n.useEffect)(()=>{w()},[]);let B=e=>{let t=Object.keys(e).join(","),i=Object.values(e).map(e=>Array.isArray(e)?'"'.concat(JSON.stringify(e),'"'):String(e)).join(",");return"".concat(t,"\n").concat(i)},M=e=>{let t=e=>Object.entries(e).map(e=>{let[i,s]=e;return"<".concat(i,">").concat("object"==typeof s&&null!==s?t(s):s,"</").concat(i,">")}).join("");return'<?xml version="1.0" encoding="UTF-8"?><root>'.concat(t(e),"</root>")},k=e=>{let i=new d.uE;i.setFontSize(14),i.text(t("myActivity.pdfTitle"),10,10),i.setFontSize(10),Object.entries(e).forEach((e,t)=>{let[s,n]=e;return i.text("".concat(s,": ").concat(JSON.stringify(n)),10,20+10*t)}),i.save("user_data.pdf")},P=(i,s)=>{confirm(t("deleteConfirmationMessage"))&&r.A.delete("".concat(e,"/my-activity/delete"),{data:{type:i,index:s},withCredentials:!0}).then(()=>{alert(t("itemDeletedSuccessfully")),w()}).catch(()=>alert(t("failedToDeleteItem")))},S=(i,s)=>{let n=a.reportInquiries[i];r.A.put("".concat(e,"/my-activity/report/edit"),{reportId:n._id,reason:s},{withCredentials:!0}).then(()=>{alert(t("reportUpdatedSuccessfully")),w()}).catch(()=>alert(t("failedToUpdateReport")))},D=async()=>{try{return await r.A.get("".concat(e,"/auth/check"),{withCredentials:!0}),!0}catch(e){return b(!0),!1}},I=async()=>{await D()&&i.push("/qna")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c(),{children:(0,s.jsx)("title",{children:t("myActivity.title")})}),(0,s.jsxs)("div",{className:j().container,children:[(0,s.jsxs)("header",{className:j().header,children:[(0,s.jsx)("button",{onClick:()=>i.back(),className:j().backBtn}),(0,s.jsx)("h1",{className:j().title,children:t("myActivity.title")})]}),(0,s.jsxs)("div",{className:j().compliance,children:[(0,s.jsx)("p",{children:t("myActivity.complianceText")}),(0,s.jsx)("p",{children:t("myActivity.dataTransferInstruction")}),(0,s.jsxs)("p",{children:[t("myActivity.dataRegion"),": ",(null==a?void 0:a.region)||t("myActivity.unknownRegion")]}),(0,s.jsx)("button",{className:j().downloadBtn,onClick:()=>C(!0),children:t("myActivity.downloadDataButton")})]}),(0,s.jsx)("main",{children:a?(0,s.jsxs)(s.Fragment,{children:[a.pastMeetings.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.pastMeetings")}),a.pastMeetings.map((e,i)=>(0,s.jsxs)("div",{className:j().itemCard,children:[(0,s.jsx)(h.A,{...e,isBuddyPost:!1}),(0,s.jsx)("div",{className:j().actions,children:(0,s.jsx)("button",{onClick:()=>P("meeting",i),className:j().deleteBtn,children:t("delete")})})]},i))]}),a.reportedPosts.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.reportedPosts")}),a.reportedPosts.map((e,i)=>(0,s.jsxs)("div",{className:j().itemCard,children:[(0,s.jsx)(h.A,{...e,isBuddyPost:!1}),(0,s.jsx)("div",{className:j().actions,children:(0,s.jsx)("button",{onClick:()=>P("report",i),className:j().deleteBtn,children:t("delete")})})]},i))]}),a.buddyGroups.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.buddyGroups")}),a.buddyGroups.map((e,t)=>(0,s.jsx)(u.A,{...e},t))]}),a.friends.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.friends")}),(0,s.jsx)("p",{className:j().subtitle,children:t("myActivity.friendsHint")}),a.friends.map(e=>(0,s.jsx)(m.A,{friend:e,userId:a.userId,isFriend:!0,hasSentRequest:!1,hasReceivedRequest:!1},e.userId))]}),a.review.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.reviews")}),a.review.map((e,i)=>(0,s.jsxs)("div",{className:j().itemCard,children:[(0,s.jsx)("p",{children:(0,s.jsx)("strong",{children:t("myActivity.rating",{rating:e.rating})})}),(0,s.jsx)("p",{children:e.content}),(0,s.jsx)("div",{className:j().actions,children:(0,s.jsx)("button",{onClick:()=>P("review",i),className:j().deleteBtn,children:t("delete")})})]},i))]}),a.reportInquiries.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.reportsInquiries")}),a.reportInquiries.map((e,i)=>(0,s.jsxs)("div",{className:j().itemCard,children:[(0,s.jsxs)("div",{className:j().row,children:[(0,s.jsx)("span",{children:"report"===e.type?"[REPORT]":"[INQUIRY]"}),(0,s.jsx)("button",{onClick:()=>P("report",i),className:j().deleteBtn,children:t("delete")})]}),e.postId&&(0,s.jsxs)("p",{children:["Post: ",e.postId.title]}),(0,s.jsx)("textarea",{className:j().textarea,value:e.reason,onChange:e=>{let t=[...a.reportInquiries];t[i].reason=e.target.value,p({...a,reportInquiries:t})},onBlur:()=>S(i,e.reason)}),(0,s.jsxs)("p",{children:[t("myActivity.date"),": ",new Date(e.reportedAt).toLocaleString()]}),e.updatedAt&&(0,s.jsxs)("p",{children:[t("myActivity.lastUpdated"),": ",new Date(e.updatedAt).toLocaleString()]})]},e._id||i))]}),a.userPosts.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.hostedPosts")}),a.userPosts.map(e=>(0,s.jsx)(h.A,{...e,isBuddyPost:!1},e._id))]}),a.userBuddyPosts.length>0&&(0,s.jsxs)("section",{className:j().sectionContainer,children:[(0,s.jsx)("h2",{children:t("myActivity.hostedBuddyPosts")}),a.userBuddyPosts.map(e=>(0,s.jsx)(h.A,{...e,isBuddyPost:!0},e._id))]}),x.length>0&&(0,s.jsxs)("section",{className:j().noData,children:[(0,s.jsx)("h3",{children:t("myActivity.noDataHeader")}),x.map((e,i)=>(0,s.jsx)("p",{children:t("myActivity.noDataFor",{section:e})},i))]})]}):(0,s.jsx)("div",{className:j().loading,children:t("loading")})}),(0,s.jsx)("button",{className:j().qnaBtn,onClick:I,children:t("qna.helpNeeded")}),N&&(0,s.jsx)("div",{className:j().modalOverlay,children:(0,s.jsxs)("div",{className:j().modalContent,children:[(0,s.jsx)("h4",{children:t("myActivity.chooseDownloadFormat")}),(0,s.jsxs)("select",{value:A,onChange:e=>g(e.target.value),className:j().picker,children:[(0,s.jsx)("option",{value:"json",children:"JSON"}),(0,s.jsx)("option",{value:"csv",children:"CSV"}),(0,s.jsx)("option",{value:"xml",children:"XML"}),(0,s.jsx)("option",{value:"pdf",children:"PDF"})]}),(0,s.jsxs)("div",{className:j().modalActions,children:[(0,s.jsx)("button",{onClick:()=>{let e;if(!a){alert(t("noDataToDownload"));return}if("json"===A)e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"});else if("csv"===A)e=new Blob([B(a)],{type:"text/csv"});else{if("xml"!==A)return C(!1),k(a);e=new Blob([M(a)],{type:"application/xml"})}let i=URL.createObjectURL(e),s=document.createElement("a");s.href=i,s.download="user_data.".concat(A),s.click(),URL.revokeObjectURL(i),C(!1),alert(t("dataDownloaded",{format:A.toUpperCase()}))},children:t("download")}),(0,s.jsx)("button",{onClick:()=>C(!1),children:t("cancel")})]})]})}),f&&(0,s.jsx)(v.A,{visible:!0,onLogin:()=>{i.push("/signin")},onBrowse:()=>b(!1)})]})]})}},98230:e=>{e.exports={container:"MyActivity_container__HfFKX",header:"MyActivity_header__MFEnD",backBtn:"MyActivity_backBtn__Tila0",title:"MyActivity_title__D4u4c",compliance:"MyActivity_compliance__Mnj0r",downloadBtn:"MyActivity_downloadBtn__RBVqf",loading:"MyActivity_loading__kiaii",sectionContainer:"MyActivity_sectionContainer__4E00w",itemCard:"MyActivity_itemCard__yoHAn",actions:"MyActivity_actions__5Ac6p",deleteBtn:"MyActivity_deleteBtn__N6W7T",subtitle:"MyActivity_subtitle__WEXIa",row:"MyActivity_row__zJFOa",textarea:"MyActivity_textarea__fvJQj",noData:"MyActivity_noData__rPcVk",qnaBtn:"MyActivity_qnaBtn__TGJX3",modalOverlay:"MyActivity_modalOverlay__d2Fch",modalContent:"MyActivity_modalContent__LbTeh",picker:"MyActivity_picker__QtoV_",modalActions:"MyActivity_modalActions__yJhgM"}}},e=>{var t=t=>e(e.s=t);e.O(0,[6229,3930,3464,1218,2988,8082,165,9275,8441,1684,7358],()=>t(36332)),_N_E=e.O()}]);