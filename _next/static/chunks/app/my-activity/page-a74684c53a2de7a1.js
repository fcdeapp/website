(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8453],{36332:(e,t,i)=>{Promise.resolve().then(i.bind(i,97699))},97699:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>j});var s=i(95155),n=i(12115),a=i(78126),c=i.n(a),l=i(35695),r=i(23464),o=i(26597),d=i(91218),y=i(21557),h=i(64895),u=i(92037),m=i(50802),v=i(98230),p=i.n(v);let j=()=>{let{t:e}=(0,d.Bd)(),t=(0,l.useRouter)(),[i,a]=(0,n.useState)(null),[v,j]=(0,n.useState)([]),[x,_]=(0,n.useState)("json"),[A,g]=(0,n.useState)(!1),[N,C]=(0,n.useState)(!1),f=async()=>{try{var t,i,s,n,c,l,o;let d=(await r.A.get("/my-activity/all",{withCredentials:!0})).data;a(d);let y=[];(null===(t=d.pastMeetings)||void 0===t?void 0:t.length)||y.push(e("myActivity.pastMeetings")),(null===(i=d.reportedPosts)||void 0===i?void 0:i.length)||y.push(e("myActivity.reportedPosts")),(null===(s=d.buddyGroups)||void 0===s?void 0:s.length)||y.push(e("myActivity.buddyGroups")),(null===(n=d.friends)||void 0===n?void 0:n.length)||y.push(e("myActivity.friends")),(null===(c=d.review)||void 0===c?void 0:c.length)||y.push(e("myActivity.reviews")),(null===(l=d.userPosts)||void 0===l?void 0:l.length)||y.push(e("myActivity.hostedPosts")),(null===(o=d.userBuddyPosts)||void 0===o?void 0:o.length)||y.push(e("myActivity.hostedBuddyPosts")),j(y)}catch(t){console.error(t),alert(e("fetch_user_data_error"))}};(0,n.useEffect)(()=>{f()},[]);let b=e=>{let t=Object.keys(e).join(","),i=Object.values(e).map(e=>Array.isArray(e)?'"'.concat(JSON.stringify(e),'"'):String(e)).join(",");return"".concat(t,"\n").concat(i)},w=e=>{let t=e=>Object.entries(e).map(e=>{let[i,s]=e;return"<".concat(i,">").concat("object"==typeof s&&null!==s?t(s):s,"</").concat(i,">")}).join("");return'<?xml version="1.0" encoding="UTF-8"?><root>'.concat(t(e),"</root>")},B=t=>{let i=new o.uE;i.setFontSize(14),i.text(e("myActivity.pdfTitle"),10,10),i.setFontSize(10),Object.entries(t).forEach((e,t)=>{let[s,n]=e;return i.text("".concat(s,": ").concat(JSON.stringify(n)),10,20+10*t)}),i.save("user_data.pdf")},M=(t,i)=>{confirm(e("deleteConfirmationMessage"))&&r.A.delete("/my-activity/delete",{data:{type:t,index:i},withCredentials:!0}).then(()=>{alert(e("itemDeletedSuccessfully")),f()}).catch(()=>alert(e("failedToDeleteItem")))},k=(t,s)=>{let n=i.reportInquiries[t];r.A.put("/my-activity/report/edit",{reportId:n._id,reason:s},{withCredentials:!0}).then(()=>{alert(e("reportUpdatedSuccessfully")),f()}).catch(()=>alert(e("failedToUpdateReport")))},P=async()=>{try{return await r.A.get("/auth/check",{withCredentials:!0}),!0}catch(e){return C(!0),!1}},S=async()=>{await P()&&t.push("/qna")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c(),{children:(0,s.jsx)("title",{children:e("myActivity.title")})}),(0,s.jsxs)("div",{className:p().container,children:[(0,s.jsxs)("header",{className:p().header,children:[(0,s.jsx)("button",{onClick:()=>t.back(),className:p().backBtn}),(0,s.jsx)("h1",{className:p().title,children:e("myActivity.title")})]}),(0,s.jsxs)("div",{className:p().compliance,children:[(0,s.jsx)("p",{children:e("myActivity.complianceText")}),(0,s.jsx)("p",{children:e("myActivity.dataTransferInstruction")}),(0,s.jsxs)("p",{children:[e("myActivity.dataRegion"),": ",(null==i?void 0:i.region)||e("myActivity.unknownRegion")]}),(0,s.jsx)("button",{className:p().downloadBtn,onClick:()=>g(!0),children:e("myActivity.downloadDataButton")})]}),(0,s.jsx)("main",{children:i?(0,s.jsxs)(s.Fragment,{children:[i.pastMeetings.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.pastMeetings")}),i.pastMeetings.map((t,i)=>(0,s.jsxs)("div",{className:p().itemCard,children:[(0,s.jsx)(y.A,{...t,isBuddyPost:!1}),(0,s.jsx)("div",{className:p().actions,children:(0,s.jsx)("button",{onClick:()=>M("meeting",i),className:p().deleteBtn,children:e("delete")})})]},i))]}),i.reportedPosts.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.reportedPosts")}),i.reportedPosts.map((t,i)=>(0,s.jsxs)("div",{className:p().itemCard,children:[(0,s.jsx)(y.A,{...t,isBuddyPost:!1}),(0,s.jsx)("div",{className:p().actions,children:(0,s.jsx)("button",{onClick:()=>M("report",i),className:p().deleteBtn,children:e("delete")})})]},i))]}),i.buddyGroups.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.buddyGroups")}),i.buddyGroups.map((e,t)=>(0,s.jsx)(h.A,{...e},t))]}),i.friends.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.friends")}),(0,s.jsx)("p",{className:p().subtitle,children:e("myActivity.friendsHint")}),i.friends.map(e=>(0,s.jsx)(u.A,{friend:e,userId:i.userId,isFriend:!0,hasSentRequest:!1,hasReceivedRequest:!1},e.userId))]}),i.review.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.reviews")}),i.review.map((t,i)=>(0,s.jsxs)("div",{className:p().itemCard,children:[(0,s.jsx)("p",{children:(0,s.jsx)("strong",{children:e("myActivity.rating",{rating:t.rating})})}),(0,s.jsx)("p",{children:t.content}),(0,s.jsx)("div",{className:p().actions,children:(0,s.jsx)("button",{onClick:()=>M("review",i),className:p().deleteBtn,children:e("delete")})})]},i))]}),i.reportInquiries.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.reportsInquiries")}),i.reportInquiries.map((t,n)=>(0,s.jsxs)("div",{className:p().itemCard,children:[(0,s.jsxs)("div",{className:p().row,children:[(0,s.jsx)("span",{children:"report"===t.type?"[REPORT]":"[INQUIRY]"}),(0,s.jsx)("button",{onClick:()=>M("report",n),className:p().deleteBtn,children:e("delete")})]}),t.postId&&(0,s.jsxs)("p",{children:["Post: ",t.postId.title]}),(0,s.jsx)("textarea",{className:p().textarea,value:t.reason,onChange:e=>{let t=[...i.reportInquiries];t[n].reason=e.target.value,a({...i,reportInquiries:t})},onBlur:()=>k(n,t.reason)}),(0,s.jsxs)("p",{children:[e("myActivity.date"),": ",new Date(t.reportedAt).toLocaleString()]}),t.updatedAt&&(0,s.jsxs)("p",{children:[e("myActivity.lastUpdated"),": ",new Date(t.updatedAt).toLocaleString()]})]},t._id||n))]}),i.userPosts.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.hostedPosts")}),i.userPosts.map(e=>(0,s.jsx)(y.A,{...e,isBuddyPost:!1},e._id))]}),i.userBuddyPosts.length>0&&(0,s.jsxs)("section",{className:p().sectionContainer,children:[(0,s.jsx)("h2",{children:e("myActivity.hostedBuddyPosts")}),i.userBuddyPosts.map(e=>(0,s.jsx)(y.A,{...e,isBuddyPost:!0},e._id))]}),v.length>0&&(0,s.jsxs)("section",{className:p().noData,children:[(0,s.jsx)("h3",{children:e("myActivity.noDataHeader")}),v.map((t,i)=>(0,s.jsx)("p",{children:e("myActivity.noDataFor",{section:t})},i))]})]}):(0,s.jsx)("div",{className:p().loading,children:e("loading")})}),(0,s.jsx)("button",{className:p().qnaBtn,onClick:S,children:e("qna.helpNeeded")}),A&&(0,s.jsx)("div",{className:p().modalOverlay,children:(0,s.jsxs)("div",{className:p().modalContent,children:[(0,s.jsx)("h4",{children:e("myActivity.chooseDownloadFormat")}),(0,s.jsxs)("select",{value:x,onChange:e=>_(e.target.value),className:p().picker,children:[(0,s.jsx)("option",{value:"json",children:"JSON"}),(0,s.jsx)("option",{value:"csv",children:"CSV"}),(0,s.jsx)("option",{value:"xml",children:"XML"}),(0,s.jsx)("option",{value:"pdf",children:"PDF"})]}),(0,s.jsxs)("div",{className:p().modalActions,children:[(0,s.jsx)("button",{onClick:()=>{let t;if(!i){alert(e("noDataToDownload"));return}if("json"===x)t=new Blob([JSON.stringify(i,null,2)],{type:"application/json"});else if("csv"===x)t=new Blob([b(i)],{type:"text/csv"});else{if("xml"!==x)return g(!1),B(i);t=new Blob([w(i)],{type:"application/xml"})}let s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download="user_data.".concat(x),n.click(),URL.revokeObjectURL(s),g(!1),alert(e("dataDownloaded",{format:x.toUpperCase()}))},children:e("download")}),(0,s.jsx)("button",{onClick:()=>g(!1),children:e("cancel")})]})]})}),N&&(0,s.jsx)(m.A,{visible:!0,onLogin:()=>{t.push("/signin")},onBrowse:()=>C(!1)})]})]})}},98230:e=>{e.exports={container:"MyActivity_container__HfFKX",header:"MyActivity_header__MFEnD",backBtn:"MyActivity_backBtn__Tila0",title:"MyActivity_title__D4u4c",compliance:"MyActivity_compliance__Mnj0r",downloadBtn:"MyActivity_downloadBtn__RBVqf",loading:"MyActivity_loading__kiaii",sectionContainer:"MyActivity_sectionContainer__4E00w",itemCard:"MyActivity_itemCard__yoHAn",actions:"MyActivity_actions__5Ac6p",deleteBtn:"MyActivity_deleteBtn__N6W7T",subtitle:"MyActivity_subtitle__WEXIa",row:"MyActivity_row__zJFOa",textarea:"MyActivity_textarea__fvJQj",noData:"MyActivity_noData__rPcVk",qnaBtn:"MyActivity_qnaBtn__TGJX3",modalOverlay:"MyActivity_modalOverlay__d2Fch",modalContent:"MyActivity_modalContent__LbTeh",picker:"MyActivity_picker__QtoV_",modalActions:"MyActivity_modalActions__yJhgM"}}},e=>{var t=t=>e(e.s=t);e.O(0,[6743,3930,3464,1218,2988,8082,165,9275,8441,1684,7358],()=>t(36332)),_N_E=e.O()}]);